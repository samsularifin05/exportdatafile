"use strict";Object.defineProperty(exports, "__esModule", {value: true}); function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; } function _nullishCoalesce(lhs, rhsFn) { if (lhs != null) { return lhs; } else { return rhsFn(); } } function _optionalChain(ops) { let lastAccessLHS = undefined; let value = ops[0]; let i = 1; while (i < ops.length) { const op = ops[i]; const fn = ops[i + 1]; i += 2; if ((op === 'optionalAccess' || op === 'optionalCall') && value == null) { return undefined; } if (op === 'access' || op === 'optionalAccess') { lastAccessLHS = value; value = fn(value); } else if (op === 'call' || op === 'optionalCall') { value = fn((...args) => value.call(lastAccessLHS, ...args)); lastAccessLHS = undefined; } } return value; }var V=["EXCEL","PDF","TXT","ALL"];function F(s,f=!1){let u=new Date(s),o=new Date(u.getTime()+7*60*60*1e3),n=o.getUTCFullYear(),p=String(o.getUTCMonth()+1).padStart(2,"0"),g=String(o.getUTCDate()).padStart(2,"0"),m=String(o.getUTCHours()).padStart(2,"0"),l=String(o.getUTCMinutes()).padStart(2,"0"),w=String(o.getUTCSeconds()).padStart(2,"0");return f?`${g}-${p}-${n} ${m}:${l}:${w}`:`${g}-${p}-${n}`}function J(s){return s.every(f=>V.includes(f))}function D(s){let f=0;return s.forEach(u=>{u.child&&u.child.length>0?f+=D(u.child):f+=1}),f}var A=s=>{let f=[];return s.forEach(u=>{u.child&&u.child.length>0?f.push(...A(u.child)):f.push(u)}),f},M=s=>s.split("_").map(o=>o.charAt(0).toUpperCase()+o.slice(1)).join(" ");async function H(s,f,u,o){for(let n=0;n<o.length;n++){let p=o[n];if(_optionalChain([p, 'optionalAccess', _2 => _2.isImage])&&_optionalChain([p, 'optionalAccess', _3 => _3.imageSrc])&&typeof p.imageSrc=="string"&&p.imageSrc.startsWith("data:image"))try{let{buffer:g,extension:m}=W(p.imageSrc),l=s.addImage({buffer:g,extension:m});f.addImage(l,{tl:{col:n,row:u.number-1},ext:{width:70,height:60},editAs:"oneCell"}),(!u.height||u.height<60)&&(u.height=35)}catch(g){console.error("\u274C Error adding image to row:",g),u.getCell(n+1).value="[Image]"}}}function W(s){let f=s.match(/^data:image\/(\w+);base64,(.*)$/);if(!f)throw new Error("Invalid base64 image format");let u=f[1]==="jpg"?"jpeg":f[1],o=f[2],n=atob(o),p=n.length,g=new Uint8Array(p);for(let m=0;m<p;m++)g[m]=n.charCodeAt(m);return{buffer:g,extension:u}}var _exceljs = require('exceljs'); var _exceljs2 = _interopRequireDefault(_exceljs);var q=async({columns:s,data:f,grouping:u,date:o,excelSetting:n,title:p,footerSetting:g})=>{let m=new _exceljs2.default.Workbook;s=s.filter(a=>!_optionalChain([a, 'access', _4 => _4.options, 'optionalAccess', _5 => _5.disabledColumn]));let l=m.addWorksheet(p||_optionalChain([n, 'optionalAccess', _6 => _6.titleExcel])),w=D(s),x=l.addRow([]);x.getCell(1).value=p||_optionalChain([n, 'optionalAccess', _7 => _7.titleExcel]),x.getCell(1).alignment={horizontal:"center"};let P=l.getColumn(w).letter;if(l.mergeCells(`A${x.number}:${P}${x.number}`),x.eachCell(a=>{a.font={color:{argb:"000000"},bold:!0,size:12}}),o){let a=l.addRow([]);a.getCell(1).value=`${o.caption?o.caption:"Tanggal "} : ${_optionalChain([o, 'optionalAccess', _8 => _8.start_date])} ${_optionalChain([o, 'optionalAccess', _9 => _9.end_date])?`s/d ${_optionalChain([o, 'optionalAccess', _10 => _10.end_date])}`:""}`,a.getCell(1).alignment={horizontal:"center"},l.mergeCells(`A${a.number}:${P}${a.number}`),a.eachCell(i=>{i.font={color:{argb:"00000"},bold:!0,size:12}})}let v=l.addRow([]);v.getCell(1).value=_optionalChain([n, 'optionalAccess', _11 => _11.additionalTextHeader])||"",v.getCell(1).alignment={horizontal:"center"},l.mergeCells(`A${v.number}:${P}${v.number}`),v.eachCell(a=>{a.font={color:{argb:"000000"},bold:!0,size:12}}),_optionalChain([n, 'optionalAccess', _12 => _12.customHeader])&&n.customHeader(l,w);let N=_optionalChain([n, 'optionalAccess', _13 => _13.startY])&&n.startY>0?n.startY:1;if(N>1)for(let a=1;a<N;a++)l.addRow([]);let z=s.some(a=>a.child&&a.child.length>0),T=l.addRow([]),h=z?l.addRow([]):null;s.forEach(a=>{if(a.child&&a.child.length>0){let i=T.actualCellCount+1,b=a.child.length;T.getCell(i).value=a.label,b>1&&l.mergeCells(T.number,i,T.number,i+b-1);for(let t=i;t<i+b;t++){let e=T.getCell(t);e.fill={type:"pattern",pattern:"solid",fgColor:{argb:_optionalChain([n, 'optionalAccess', _14 => _14.bgColor])||"E8E5E5"}},e.font={color:{argb:_optionalChain([n, 'optionalAccess', _15 => _15.txtColor])||"000000"},bold:!0},e.alignment={horizontal:"center",vertical:"middle"}}a.child.forEach((t,e)=>{if(h){let c=h.getCell(i+e);c.value=t.label,c.fill={type:"pattern",pattern:"solid",fgColor:{argb:_optionalChain([n, 'optionalAccess', _16 => _16.bgColor])||"E8E5E5"}},c.font={color:{argb:_optionalChain([n, 'optionalAccess', _17 => _17.txtColor])||"000000"},bold:!0};let C=_optionalChain([t, 'access', _18 => _18.options, 'optionalAccess', _19 => _19.halign])||(["RP","GR","NUMBER"].includes(_optionalChain([t, 'optionalAccess', _20 => _20.options, 'optionalAccess', _21 => _21.format])||"")?"right":"left"),d=_optionalChain([t, 'access', _22 => _22.options, 'optionalAccess', _23 => _23.valign])||"middle";c.alignment={horizontal:C,vertical:d}}})}else{let i=T.actualCellCount+1;T.getCell(i).value=a.label,T.getCell(i).fill={type:"pattern",pattern:"solid",fgColor:{argb:_optionalChain([n, 'optionalAccess', _24 => _24.bgColor])||"E8E5E5"}},T.getCell(i).font={color:{argb:_optionalChain([n, 'optionalAccess', _25 => _25.txtColor])||"000000"},bold:!0},T.getCell(i).alignment={horizontal:_optionalChain([a, 'access', _26 => _26.options, 'optionalAccess', _27 => _27.halign])||"center",vertical:_optionalChain([a, 'access', _28 => _28.options, 'optionalAccess', _29 => _29.valign])||"middle"},z&&h&&l.mergeCells(T.number,i,h.number,i)}});let G={};f.forEach(async a=>{if(_optionalChain([a, 'access', _30 => _30.detail, 'optionalAccess', _31 => _31.length])>0){if(u.length>0){let t=D(s),e=u.map(C=>a[C]!==void 0||a[C]!==null?`${M(C)} : ${a[C]}`:"").filter(Boolean).join("  |  "),c=l.addRow([e]);l.mergeCells(`A${c.number}:${String.fromCharCode(64+t)}${c.number}`),c.getCell(1).alignment={horizontal:"left"},c.getCell(1).font={bold:!0}}let i={};a.detail.forEach(async t=>{let c=A(s).map(d=>{if(_optionalChain([d, 'optionalAccess', _32 => _32.options, 'optionalAccess', _33 => _33.format])==="IMAGE"&&t[d.key])return{value:"",alignment:{horizontal:"center",vertical:"middle"},isImage:!0,imageSrc:t[d.key]};let I=_optionalChain([d, 'optionalAccess', _34 => _34.options, 'optionalAccess', _35 => _35.format])==="DATETIME"?F(t[d.key],!0):_optionalChain([d, 'optionalAccess', _36 => _36.options, 'optionalAccess', _37 => _37.format])==="DATE"?F(t[d.key]):t[d.key],k={horizontal:_optionalChain([d, 'optionalAccess', _38 => _38.options, 'optionalAccess', _39 => _39.halign])?_optionalChain([d, 'optionalAccess', _40 => _40.options, 'optionalAccess', _41 => _41.halign]):_optionalChain([d, 'optionalAccess', _42 => _42.options, 'optionalAccess', _43 => _43.format])==="RP"||_optionalChain([d, 'optionalAccess', _44 => _44.options, 'optionalAccess', _45 => _45.format])==="GR"||_optionalChain([d, 'optionalAccess', _46 => _46.options, 'optionalAccess', _47 => _47.format])==="NUMBER"?"right":"left"},$=d.key;return G[$]=(G[$]||0)+Number(I),i[$]=(i[$]||0)+Number(I),{value:I,alignment:k,numFmt:_optionalChain([d, 'optionalAccess', _48 => _48.options, 'optionalAccess', _49 => _49.format])==="RP"?"#,##0":_optionalChain([d, 'optionalAccess', _50 => _50.options, 'optionalAccess', _51 => _51.format])==="GR"?"#,##0.000":void 0}}),C=l.addRow(c.map(d=>d.value));c.forEach((d,I)=>{let k=C.getCell(I+1),$=["center","right","left","fill","justify","centerContinuous","distributed"],j=["top","middle","bottom","distributed","justify"],B,_;d.alignment&&typeof d.alignment.horizontal=="string"&&$.includes(d.alignment.horizontal)&&(B=d.alignment.horizontal),d.alignment&&"vertical"in d.alignment&&typeof d.alignment.vertical=="string"&&j.includes(d.alignment.vertical)&&(_=d.alignment.vertical),k.alignment={...B?{horizontal:B}:{},..._?{vertical:_}:{}},d.numFmt&&typeof d.value=="number"&&!isNaN(d.value)&&(k.value=Number(d.value),k.numFmt=d.numFmt)}),await H(m,l,C,c)});let b=A(s);if(!_optionalChain([g, 'optionalAccess', _52 => _52.subTotal, 'optionalAccess', _53 => _53.disableSubtotal])){let t=l.addRow(s.map(()=>null));b.forEach((e,c)=>{if(_optionalChain([e, 'optionalAccess', _54 => _54.options, 'optionalAccess', _55 => _55.format])==="RP"||_optionalChain([e, 'optionalAccess', _56 => _56.options, 'optionalAccess', _57 => _57.format])==="GR"||_optionalChain([e, 'optionalAccess', _58 => _58.options, 'optionalAccess', _59 => _59.format])==="NUMBER"){let d=f.length+4-1,I=`SUM(${String.fromCharCode(65+c)}4:${String.fromCharCode(65+c)}${d})`,k=t.getCell(c+1),$=_optionalChain([g, 'optionalAccess', _60 => _60.subTotal, 'optionalAccess', _61 => _61.enableCount])&&u.length>0?" : "+a.detail.length:"",j=_optionalChain([g, 'optionalAccess', _62 => _62.subTotal, 'optionalAccess', _63 => _63.captionItem])?_optionalChain([g, 'optionalAccess', _64 => _64.subTotal, 'optionalAccess', _65 => _65.captionItem]):"";t.getCell(1).value=`${_optionalChain([g, 'optionalAccess', _66 => _66.subTotal, 'optionalAccess', _67 => _67.caption])||"SUB TOTAL"} ${$} ${j}`,t.getCell(1).alignment={horizontal:"center"},k.numFmt=_optionalChain([e, 'optionalAccess', _68 => _68.options, 'optionalAccess', _69 => _69.format])==="GR"?"#,##0.000":"#,##0",k.value={formula:I},t.getCell(c+1).value=_optionalChain([e, 'optionalAccess', _70 => _70.options, 'access', _71 => _71.disabledFooter])?"":i[e.key]}else t.getCell(c+1).value=""}),_optionalChain([n, 'optionalAccess', _72 => _72.grandTotalSetting, 'optionalAccess', _73 => _73.colSpan])&&l.mergeCells(`A${t.number}:${String.fromCharCode(64+Number(_optionalChain([n, 'optionalAccess', _74 => _74.grandTotalSetting, 'optionalAccess', _75 => _75.colSpan])))}${t.number}`),t.eachCell(e=>{e.fill={type:"pattern",pattern:"solid",fgColor:{argb:_optionalChain([n, 'optionalAccess', _76 => _76.bgColor])||"#E8E5E5"},bgColor:{argb:_optionalChain([n, 'optionalAccess', _77 => _77.bgColor])||"#E8E5E5"}},e.font={color:{argb:_optionalChain([n, 'optionalAccess', _78 => _78.txtColor])},bold:!0}})}}else{let b=A(s).map(e=>{if(_optionalChain([e, 'optionalAccess', _79 => _79.options, 'optionalAccess', _80 => _80.format])==="IMAGE"&&a[e.key])return{value:"",alignment:{horizontal:"center",vertical:"middle"},isImage:!0,imageSrc:a[e.key]};let c=_optionalChain([e, 'optionalAccess', _81 => _81.options, 'optionalAccess', _82 => _82.format])==="DATETIME"?F(a[e.key]):_optionalChain([e, 'optionalAccess', _83 => _83.options, 'optionalAccess', _84 => _84.format])==="DATE"?F(a[e.key]):a[e.key],C={horizontal:_optionalChain([e, 'optionalAccess', _85 => _85.options, 'optionalAccess', _86 => _86.halign])?_optionalChain([e, 'optionalAccess', _87 => _87.options, 'optionalAccess', _88 => _88.halign]):_optionalChain([e, 'optionalAccess', _89 => _89.options, 'optionalAccess', _90 => _90.format])==="RP"||_optionalChain([e, 'optionalAccess', _91 => _91.options, 'optionalAccess', _92 => _92.format])==="GR"||_optionalChain([e, 'optionalAccess', _93 => _93.options, 'optionalAccess', _94 => _94.format])==="NUMBER"?"right":"left"},d=e.key;return G[d]=(G[d]||0)+Number(c),{value:c,alignment:C,numFmt:_optionalChain([e, 'optionalAccess', _95 => _95.options, 'optionalAccess', _96 => _96.format])==="RP"?"#,##0":_optionalChain([e, 'optionalAccess', _97 => _97.options, 'optionalAccess', _98 => _98.format])==="GR"?"#,##0.000":void 0}}),t=l.addRow(b.map(e=>e.value));b.forEach((e,c)=>{let C=t.getCell(c+1),d=["center","right","left","fill","justify","centerContinuous","distributed"],I=["top","middle","bottom","distributed","justify"],k,$;e.alignment&&typeof e.alignment.horizontal=="string"&&d.includes(e.alignment.horizontal)&&(k=e.alignment.horizontal),e.alignment&&"vertical"in e.alignment&&typeof e.alignment.vertical=="string"&&I.includes(e.alignment.vertical)&&($=e.alignment.vertical),C.alignment={...k?{horizontal:k}:{},...$?{vertical:$}:{}},e.numFmt&&typeof e.value=="number"&&!isNaN(e.value)&&(C.value=Number(e.value),C.numFmt=e.numFmt)}),await H(m,l,t,b)}});let R=l.addRow(s.map(()=>null)),U=A(s);_optionalChain([g, 'optionalAccess', _99 => _99.grandTotal, 'optionalAccess', _100 => _100.disableGrandTotal])||(U.forEach((a,i)=>{if(_optionalChain([a, 'optionalAccess', _101 => _101.options, 'optionalAccess', _102 => _102.format])==="RP"||_optionalChain([a, 'optionalAccess', _103 => _103.options, 'optionalAccess', _104 => _104.format])==="GR"||_optionalChain([a, 'optionalAccess', _105 => _105.options, 'optionalAccess', _106 => _106.format])==="NUMBER"){let t=f.length+4-1,e=`SUM(${String.fromCharCode(65+i)}4:${String.fromCharCode(65+i)}${t})`,c=R.getCell(i+1),C=_optionalChain([g, 'optionalAccess', _107 => _107.grandTotal, 'optionalAccess', _108 => _108.enableCount])?u.length>0?" : "+f.map(k=>k.detail.length).reduce((k,$)=>k+$,0):" : "+f.length:"",d=_optionalChain([g, 'optionalAccess', _109 => _109.grandTotal, 'optionalAccess', _110 => _110.captionItem])?_optionalChain([g, 'optionalAccess', _111 => _111.grandTotal, 'optionalAccess', _112 => _112.captionItem]):"",I=`${_optionalChain([g, 'optionalAccess', _113 => _113.grandTotal, 'optionalAccess', _114 => _114.caption])||"GRAND TOTAL"} ${C} ${d}`;R.getCell(1).value=I,R.getCell(1).alignment={horizontal:"center"},c.numFmt=_optionalChain([a, 'optionalAccess', _115 => _115.options, 'optionalAccess', _116 => _116.format])==="GR"?"#,##0.000":"#,##0",c.value={formula:e},R.getCell(i+1).value=_optionalChain([a, 'optionalAccess', _117 => _117.options, 'access', _118 => _118.disabledFooter])?"":G[a.key]}else R.getCell(i+1).value=""}),_optionalChain([n, 'optionalAccess', _119 => _119.grandTotalSetting, 'optionalAccess', _120 => _120.colSpan])&&l.mergeCells(`A${R.number}:${String.fromCharCode(64+Number(_optionalChain([n, 'optionalAccess', _121 => _121.grandTotalSetting, 'optionalAccess', _122 => _122.colSpan])))}${R.number}`),R.eachCell(a=>{a.fill={type:"pattern",pattern:"solid",fgColor:{argb:_optionalChain([n, 'optionalAccess', _123 => _123.bgColor])||"#E8E5E5"},bgColor:{argb:_optionalChain([n, 'optionalAccess', _124 => _124.bgColor])||"#E8E5E5"}},a.font={color:{argb:_optionalChain([n, 'optionalAccess', _125 => _125.txtColor])},bold:!0}})),_optionalChain([n, 'optionalAccess', _126 => _126.customFooter])&&n.customFooter(l,w);let r=await m.xlsx.writeBuffer(),y=new Blob([r],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),E=document.createElement("a");E.href=URL.createObjectURL(y),E.download=`${_optionalChain([n, 'optionalAccess', _127 => _127.titleExcel])||p}.xlsx`,document.body.appendChild(E),E.click(),document.body.removeChild(E)},S=q;var _jspdf = require('jspdf'); var _jspdf2 = _interopRequireDefault(_jspdf);var _jspdfautotable = require('jspdf-autotable'); var _jspdfautotable2 = _interopRequireDefault(_jspdfautotable);var Z=({columns:s,data:f,grouping:u,pdfSetting:o,date:n,title:p,footerSetting:g})=>{let m=new (0, _jspdf2.default)(_optionalChain([o, 'optionalAccess', _128 => _128.orientation]),_optionalChain([o, 'optionalAccess', _129 => _129.unit]),[_optionalChain([o, 'optionalAccess', _130 => _130.width])||297,_optionalChain([o, 'optionalAccess', _131 => _131.height])||210]),l=[],w=n?30:20;s=s.filter(r=>!_optionalChain([r, 'access', _132 => _132.options, 'optionalAccess', _133 => _133.disabledColumn])),m.setFontSize(10);let x=m.internal.pageSize.getWidth(),P=m.splitTextToSize(_optionalChain([o, 'optionalAccess', _134 => _134.textHeaderLeft])||"",110);m.text(P,15,18),m.text(`${p||_optionalChain([o, 'optionalAccess', _135 => _135.titlePdf])}`,x-15,18,{align:"right"}),n&&m.text(`${n.caption?n.caption:"TANGGAL "} : ${_optionalChain([n, 'optionalAccess', _136 => _136.start_date])} ${_optionalChain([n, 'optionalAccess', _137 => _137.end_date])?`s/d ${_optionalChain([n, 'optionalAccess', _138 => _138.end_date])}`:""}`,x-15,22,{align:"right"}),typeof _optionalChain([o, 'optionalAccess', _139 => _139.customHeader])=="function"&&o.customHeader(m,w,_jspdfautotable2.default),m.setProperties({title:p||_optionalChain([o, 'optionalAccess', _140 => _140.titlePdf])}),_optionalChain([o, 'optionalAccess', _141 => _141.startY])&&(w=o.startY);let v=[],N=[],z=s.some(r=>r.child&&r.child.length>0);s.forEach(r=>{let y={textColor:`#${_optionalChain([o, 'optionalAccess', _142 => _142.txtColor])||"000"}`,fillColor:`#${_optionalChain([o, 'optionalAccess', _143 => _143.bgColor])||"E8E5E5"}`,fontStyle:"bold",..._optionalChain([r, 'optionalAccess', _144 => _144.options, 'optionalAccess', _145 => _145.valign])?{valign:r.options.valign}:{},halign:_nullishCoalesce(_optionalChain([r, 'optionalAccess', _146 => _146.options, 'optionalAccess', _147 => _147.halign]), () => ((["RP","GR","NUMBER"].includes(_optionalChain([r, 'optionalAccess', _148 => _148.options, 'optionalAccess', _149 => _149.format])||"")?"right":"left")))};z?r.child&&r.child.length>0?(v.push({content:r.label,colSpan:r.child.length,styles:y}),r.child.forEach(E=>{N.push({content:E.label,key:E.key,options:E.options,styles:{...y,halign:_nullishCoalesce(_optionalChain([E, 'optionalAccess', _150 => _150.options, 'optionalAccess', _151 => _151.halign]), () => ((["RP","GR","NUMBER"].includes(_optionalChain([E, 'optionalAccess', _152 => _152.options, 'optionalAccess', _153 => _153.format])||"")?"right":"left")))}})})):v.push({content:r.label,rowSpan:2,key:r.key,options:r.options,styles:y}):v.push({content:r.label,key:r.key,options:r.options,styles:y})}),l.push(v),z&&N.length>0&&l.push(N);let T={};f.forEach(r=>{if(_optionalChain([r, 'access', _154 => _154.detail, 'optionalAccess', _155 => _155.length])>0){if(u.length>0){let a=D(s),b=[{content:u.map(t=>r[t]!==void 0||r[t]!==null?`${M(t)} : ${r[t]}`:"").filter(Boolean).join("  |  "),colSpan:a,styles:{fontStyle:"bold",halign:"left"}}];l.push(b)}let y={},E=A(s);if(r.detail.forEach(a=>{let i=E.map(b=>{let t=a[b.key],e=b.key;T[e]=(T[e]||0)+Number(t||0),y[e]=(y[e]||0)+Number(t||0);let c=_optionalChain([b, 'access', _156 => _156.options, 'optionalAccess', _157 => _157.format])==="IMAGE";return{content:(()=>{switch(_optionalChain([b, 'optionalAccess', _158 => _158.options, 'optionalAccess', _159 => _159.format])){case"RP":return t!==void 0?Number(t||0).toLocaleString("kr-ko"):"";case"GR":return t!==void 0?Number(t||0).toFixed(3):"";case"NUMBER":return t!==void 0?Number(t||0):"";case"IMAGE":return"";case"DATETIME":return t!==void 0?F(t||new Date,!0):"";case"DATE":return t!==void 0?F(t||new Date):"";default:return t!==void 0?t.toString():""}})(),foto:c?t:null,styles:{halign:_optionalChain([b, 'optionalAccess', _160 => _160.options, 'optionalAccess', _161 => _161.halign])?_optionalChain([b, 'optionalAccess', _162 => _162.options, 'optionalAccess', _163 => _163.halign]):_optionalChain([b, 'optionalAccess', _164 => _164.options, 'optionalAccess', _165 => _165.format])==="RP"||_optionalChain([b, 'optionalAccess', _166 => _166.options, 'optionalAccess', _167 => _167.format])==="GR"||_optionalChain([b, 'optionalAccess', _168 => _168.options, 'optionalAccess', _169 => _169.format])==="NUMBER"||typeof t=="number"?"right":"left"}}});l.push(i)}),!_optionalChain([g, 'optionalAccess', _170 => _170.subTotal, 'optionalAccess', _171 => _171.disableSubtotal])){let a=[];E.forEach(e=>{let c=y[e.key];_optionalChain([e, 'optionalAccess', _172 => _172.options, 'optionalAccess', _173 => _173.format])==="RP"||_optionalChain([e, 'optionalAccess', _174 => _174.options, 'optionalAccess', _175 => _175.format])==="GR"||_optionalChain([e, 'optionalAccess', _176 => _176.options, 'optionalAccess', _177 => _177.format])==="NUMBER"?a.push({content:_optionalChain([e, 'optionalAccess', _178 => _178.options, 'optionalAccess', _179 => _179.disabledFooter])?"":(()=>{switch(_optionalChain([e, 'optionalAccess', _180 => _180.options, 'optionalAccess', _181 => _181.format])){case"RP":return c.toLocaleString("kr-ko");case"GR":return c.toFixed(3);case"NUMBER":return c;default:return c.toString()}})(),styles:{halign:_optionalChain([e, 'optionalAccess', _182 => _182.options, 'optionalAccess', _183 => _183.halign])||"right",textColor:`#${_optionalChain([o, 'optionalAccess', _184 => _184.txtColor])||"000"}`,fillColor:`#${_optionalChain([o, 'optionalAccess', _185 => _185.bgColor])||"E8E5E5"}`,fontStyle:"bold"}}):a.push({content:"",styles:{textColor:`#${_optionalChain([o, 'optionalAccess', _186 => _186.txtColor])||"000"}`,fillColor:`#${_optionalChain([o, 'optionalAccess', _187 => _187.bgColor])||"E8E5E5"}`,fontStyle:"bold"}})});let i=_optionalChain([o, 'optionalAccess', _188 => _188.grandTotalSetting, 'optionalAccess', _189 => _189.colSpan])?Number(_optionalChain([o, 'optionalAccess', _190 => _190.grandTotalSetting, 'optionalAccess', _191 => _191.colSpan])||0)+1:0,b=_optionalChain([g, 'optionalAccess', _192 => _192.subTotal, 'optionalAccess', _193 => _193.enableCount])&&u.length>0?" : "+r.detail.length:"",t=_optionalChain([g, 'optionalAccess', _194 => _194.subTotal, 'optionalAccess', _195 => _195.captionItem])?_optionalChain([g, 'optionalAccess', _196 => _196.subTotal, 'optionalAccess', _197 => _197.captionItem]):"";a[0]={content:`${_optionalChain([g, 'optionalAccess', _198 => _198.subTotal, 'optionalAccess', _199 => _199.caption])||"SUB TOTAL"}${b} ${t}`,colSpan:i,styles:{textColor:`#${_optionalChain([o, 'optionalAccess', _200 => _200.txtColor])||"000"}`,fillColor:`#${_optionalChain([o, 'optionalAccess', _201 => _201.bgColor])||"E8E5E5"}`,fontStyle:"bold",halign:"center"}},_optionalChain([o, 'optionalAccess', _202 => _202.grandTotalSetting, 'optionalAccess', _203 => _203.colSpan])&&a.splice(1,_optionalChain([o, 'optionalAccess', _204 => _204.grandTotalSetting, 'optionalAccess', _205 => _205.colSpan])),l.push(a)}}else{let y=(i,b)=>{let t=b[i.key],e=i.key;_optionalChain([i, 'access', _206 => _206.options, 'optionalAccess', _207 => _207.disabledFooter])||(T[e]=(T[e]||0)+Number(t||0));let c=(()=>{switch(_optionalChain([i, 'optionalAccess', _208 => _208.options, 'optionalAccess', _209 => _209.format])){case"RP":return t!==void 0?Number(t||0).toLocaleString("kr-ko"):"";case"GR":return t!==void 0?Number(t||0).toFixed(3):"";case"NUMBER":return t!==void 0?Number(t||0):"";case"IMAGE":return"";case"DATETIME":return t!==void 0?F(t||new Date,!0):"";case"DATE":return t!==void 0?F(t||new Date):"";default:return t!==void 0?_optionalChain([t, 'optionalAccess', _210 => _210.toString, 'call', _211 => _211()]):""}})(),C=_optionalChain([i, 'optionalAccess', _212 => _212.options, 'optionalAccess', _213 => _213.halign])?_optionalChain([i, 'optionalAccess', _214 => _214.options, 'optionalAccess', _215 => _215.halign]):_optionalChain([i, 'optionalAccess', _216 => _216.options, 'optionalAccess', _217 => _217.format])==="RP"||_optionalChain([i, 'optionalAccess', _218 => _218.options, 'optionalAccess', _219 => _219.format])==="GR"||_optionalChain([i, 'optionalAccess', _220 => _220.options, 'optionalAccess', _221 => _221.format])==="NUMBER"||typeof t=="number"?"right":"left",d=_optionalChain([i, 'access', _222 => _222.options, 'optionalAccess', _223 => _223.format])==="IMAGE";return{options:_optionalChain([i, 'optionalAccess', _224 => _224.options]),content:c,foto:d?t:null,styles:{halign:C}}},a=A(s).map(i=>y(i,r));l.push(a)}});let h=A(s);if(!_optionalChain([g, 'optionalAccess', _225 => _225.grandTotal, 'optionalAccess', _226 => _226.disableGrandTotal])){let r=[];h.forEach(t=>{let e=T[t.key],c=["RP","GR","NUMBER"].includes(_optionalChain([t, 'optionalAccess', _227 => _227.options, 'optionalAccess', _228 => _228.format])||""),C=_optionalChain([t, 'optionalAccess', _229 => _229.options, 'optionalAccess', _230 => _230.disabledFooter])?"":(()=>{if(!c)return"";switch(_optionalChain([t, 'access', _231 => _231.options, 'optionalAccess', _232 => _232.format])){case"RP":return Number(e||0).toLocaleString("kr-KO");case"GR":return Number(e||0).toFixed(3);case"NUMBER":return Number(e||0);default:return(e||0).toString()}})();r.push({options:_optionalChain([t, 'optionalAccess', _233 => _233.options]),content:C,styles:{halign:_optionalChain([t, 'optionalAccess', _234 => _234.options, 'optionalAccess', _235 => _235.halign])?t.options.halign:c?"right":"left",textColor:`#${_optionalChain([o, 'optionalAccess', _236 => _236.txtColor])||"000"}`,fillColor:`#${_optionalChain([o, 'optionalAccess', _237 => _237.bgColor])||"E8E5E5"}`,fontStyle:"bold"}})});let y=Number(_optionalChain([o, 'optionalAccess', _238 => _238.grandTotalSetting, 'optionalAccess', _239 => _239.colSpan])||0),E=Math.min(y+1,h.length),a=_optionalChain([g, 'optionalAccess', _240 => _240.grandTotal, 'optionalAccess', _241 => _241.enableCount])?u.length>0?f.reduce((t,e)=>t+e.detail.length,0):f.length:0,i=_optionalChain([g, 'optionalAccess', _242 => _242.grandTotal, 'optionalAccess', _243 => _243.captionItem])||"",b=`${_optionalChain([g, 'optionalAccess', _244 => _244.grandTotal, 'optionalAccess', _245 => _245.caption])||"GRAND TOTAL"}`+(a?` : ${a}`:"")+(i?` ${i}`:"");for(r[0]={content:b,colSpan:E,styles:{textColor:`#${_optionalChain([o, 'optionalAccess', _246 => _246.txtColor])||"000"}`,fillColor:`#${_optionalChain([o, 'optionalAccess', _247 => _247.bgColor])||"E8E5E5"}`,fontStyle:"bold",halign:"center"}},r.splice(1,E-1);r.length<h.length;)r.push({content:"",styles:{textColor:`#${_optionalChain([o, 'optionalAccess', _248 => _248.txtColor])||"000"}`,fillColor:`#${_optionalChain([o, 'optionalAccess', _249 => _249.bgColor])||"E8E5E5"}`,fontStyle:"bold"}});l.push(r)}if(typeof _optionalChain([o, 'optionalAccess', _250 => _250.addRow])=="function"&&_optionalChain([o, 'optionalAccess', _251 => _251.addRow, 'call', _252 => _252(l)]),!_optionalChain([o, 'optionalAccess', _253 => _253.disablePrintDate])){let r=D(s);l.push([{content:`Print Date : ${F(`${new Date}`)}`,colSpan:r,styles:{textColor:`#${_optionalChain([o, 'optionalAccess', _254 => _254.txtColor])||"000"}`,fillColor:`#${_optionalChain([o, 'optionalAccess', _255 => _255.bgColor])||"E8E5E5"}`,fontStyle:"italic"}}])}_jspdfautotable2.default.call(void 0, m,{head:[],body:l,startY:w,theme:_optionalChain([o, 'optionalAccess', _256 => _256.theme])||"plain",rowPageBreak:"avoid",margin:{top:10},bodyStyles:{fontSize:_optionalChain([o, 'optionalAccess', _257 => _257.fontSIze])||8},headStyles:{fontSize:_optionalChain([o, 'optionalAccess', _258 => _258.fontSIze])||8,textColor:`#${_optionalChain([o, 'optionalAccess', _259 => _259.txtColor])||"000"}`,fillColor:`#${_optionalChain([o, 'optionalAccess', _260 => _260.bgColor])||"E8E5E5"}`},tableLineColor:[255,255,255],didParseCell:function(r){let y=r.column.index;_optionalChain([h, 'access', _261 => _261[y], 'optionalAccess', _262 => _262.options, 'optionalAccess', _263 => _263.format])==="IMAGE"&&r.cell.raw&&r.cell.raw.foto&&(r.row.height=20,r.cell.styles.valign="middle",r.cell.styles.halign="center")},didDrawCell:function(r){let{cell:y}=r,a=(y.raw||{}).foto,i=r.column.index;if(_optionalChain([h, 'access', _264 => _264[i], 'optionalAccess', _265 => _265.options, 'optionalAccess', _266 => _266.format])==="IMAGE"&&a){let e=y.x+(y.width-15)/2,c=y.y+(y.height-15)/2;try{m.addImage(a,"JPG",e,c,15,15)}catch(C){console.warn("\u274C Gagal render gambar:",C)}}}}),l=[],w=m.lastAutoTable.finalY;let G=m.internal.getNumberOfPages(),R=m.internal.pageSize.width,U=m.internal.pageSize.height;m.setFontSize(10);for(let r=1;r<G+1;r++){let y=R/2,E=U-10;m.setPage(r),m.text(`${r} of ${G}`,y,E,{align:"center"})}if(typeof _optionalChain([o, 'optionalAccess', _267 => _267.customFooter])=="function"&&o.customFooter(m,w,_jspdfautotable2.default),_optionalChain([o, 'optionalAccess', _268 => _268.openNewTab])){let r=m.output("bloburl");window.open(r)}else m.save(`${_optionalChain([o, 'optionalAccess', _269 => _269.titlePdf])||p}.pdf`)},Y=Z;var tt=s=>{let f=[],u=s.copy?2:1;for(let o=0;o<u;o++){let n=s.data.map(p=>{let g=s.template;for(;/\n!!LOOP\((.+)\)(\{\n(.*\n)+\})\n/gm.exec(g);)g=g.replace(/\n!!LOOP\((.+)\)(\{\n(.*\n)+\})\n/,(m,l,w)=>{let x=w.replace(/^\{/,"").replace(/\}$/,"");return(Array.isArray(p[l])?p[l]:[p[l]]).reduce((N,z)=>N+x.replace(/\{([a-z0-9_]+)\}/gm,T=>{let h=T.replace(/(\{|\})/g,"");if(h.match(/nama_barang/)){let G=h.match(/nama_barang/),R=h==="nama_barang2"?[20,40]:h==="nama_barang3"?[40,60]:[0,20];return _optionalChain([z, 'access', _270 => _270[G], 'optionalAccess', _271 => _271.slice, 'call', _272 => _272(...R), 'access', _273 => _273.trim, 'call', _274 => _274()])||""}if(h.match(/deskripsi_jual/)){let G=h.match(/deskripsi_jual/),R=h==="deskripsi_jual2"?[20,40]:h==="deskripsi_jual3"?[40,60]:[0,20];return _optionalChain([z, 'access', _275 => _275[G], 'optionalAccess', _276 => _276.slice, 'call', _277 => _277(...R), 'access', _278 => _278.trim, 'call', _279 => _279()])||""}if(h.match(/deskripsi/)){let G=h.match(/deskripsi/),R=h==="deskripsi2"?[20,40]:h==="deskripsi3"?[40,60]:[0,20];return _optionalChain([z, 'access', _280 => _280[G], 'optionalAccess', _281 => _281.slice, 'call', _282 => _282(...R), 'access', _283 => _283.trim, 'call', _284 => _284()])||""}return z[h]||""}),"").replace(/\n(\s)+\n/gm,`
`)});return g.replace(/\{([a-z0-9_]+)\}/gm,m=>{let l=m.replace(/(\{|\})/g,"");return l.match(/auto_cut/)?`
VA`:p[l]||""}).replace(/\n(\s)+\n/gm,`
`).replace(/~new_line~/gm,`
`).replace(/!!LOOP\(detail\)/g,"").replace(/[}{]/g,"")});for(let p in n)n[p]+=`

`;f.push(...n)}return f},et=async(s,f)=>{let u=tt(s),o=new Blob([_optionalChain([u, 'optionalAccess', _285 => _285.join, 'call', _286 => _286(`
`)])||""],{type:"text/plain"}),n=document.createElement("a");n.href=URL.createObjectURL(o),n.download=f,document.body.appendChild(n),n.click(),document.body.removeChild(n)},X=et;var kt=({columns:s,data:f,grouping:u,date:o,type:n,txtSetting:p,pdfSetting:g,excelSetting:m,title:l,footerSetting:w})=>{let x={data:[_optionalChain([p, 'optionalAccess', _287 => _287.dataTxt])],template:_optionalChain([p, 'optionalAccess', _288 => _288.templateTxt]),copy:_optionalChain([p, 'optionalAccess', _289 => _289.copy])};if(f.length===0)throw new Error("Data is required");if(n.length===0)throw new Error("Type is required");if(!J(n))throw new Error('Type Export must use ["EXCEL", "PDF", "TXT", "ALL"]');n.forEach(P=>{P==="PDF"?Y({pdfSetting:g,date:o,data:f,type:n,columns:s,grouping:u,title:l,footerSetting:w}):P==="TXT"?X(x,_optionalChain([p, 'optionalAccess', _290 => _290.titleTxt])||""):P==="EXCEL"?S({date:o,data:f,type:n,columns:s,grouping:u,excelSetting:m,title:l,footerSetting:w}):(S({date:o,data:f,type:n,columns:s,grouping:u,excelSetting:m,title:l}),Y({pdfSetting:g,date:o,data:f,type:n,columns:s,grouping:u,title:l}),X(x,_optionalChain([p, 'optionalAccess', _291 => _291.titleTxt])||""))})};exports.ExportData = kt;
//# sourceMappingURL=index.js.map