"use strict";Object.defineProperty(exports, "__esModule", {value: true}); function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; } function _nullishCoalesce(lhs, rhsFn) { if (lhs != null) { return lhs; } else { return rhsFn(); } } function _optionalChain(ops) { let lastAccessLHS = undefined; let value = ops[0]; let i = 1; while (i < ops.length) { const op = ops[i]; const fn = ops[i + 1]; i += 2; if ((op === 'optionalAccess' || op === 'optionalCall') && value == null) { return undefined; } if (op === 'access' || op === 'optionalAccess') { lastAccessLHS = value; value = fn(value); } else if (op === 'call' || op === 'optionalCall') { value = fn((...args) => value.call(lastAccessLHS, ...args)); lastAccessLHS = undefined; } } return value; }var K=["EXCEL","PDF","TXT","ALL"];function z(s,f=!1){let m=new Date(s),e=new Date(m.getTime()+420*60*1e3),n=e.getUTCFullYear(),b=String(e.getUTCMonth()+1).padStart(2,"0"),u=String(e.getUTCDate()).padStart(2,"0"),w=String(e.getUTCHours()).padStart(2,"0"),d=String(e.getUTCMinutes()).padStart(2,"0"),g=String(e.getUTCSeconds()).padStart(2,"0");return f?`${u}-${b}-${n} ${w}:${d}:${g}`:`${u}-${b}-${n}`}function q(s){return s.every(f=>K.includes(f))}function U(s){let f=0;return s.forEach(m=>{m.child&&m.child.length>0?f+=U(m.child):f+=1}),f}var P=s=>{let f=[];return s.forEach(m=>{m.child&&m.child.length>0?f.push(...P(m.child)):f.push(m)}),f},_=s=>s.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ");async function V(s,f,m,e){for(let n=0;n<e.length;n++){let b=e[n];if(_optionalChain([b, 'optionalAccess', _2 => _2.isImage])&&_optionalChain([b, 'optionalAccess', _3 => _3.imageSrc])&&typeof b.imageSrc=="string"&&b.imageSrc.startsWith("data:image"))try{let{buffer:u,extension:w}=Q(b.imageSrc),d=s.addImage({buffer:u,extension:w});f.addImage(d,{tl:{col:n,row:m.number-1},ext:{width:70,height:60},editAs:"oneCell"}),(!m.height||m.height<60)&&(m.height=35)}catch(u){console.error("\u274C Error adding image to row:",u),m.getCell(n+1).value="[Image]"}}}function Q(s){let f=s.match(/^data:image\/(\w+);base64,(.*)$/);if(!f)throw new Error("Invalid base64 image format");let m=f[1]==="jpg"?"jpeg":f[1],e=f[2],n=atob(e),b=n.length,u=new Uint8Array(b);for(let w=0;w<b;w++)u[w]=n.charCodeAt(w);return{buffer:u,extension:m}}var E=s=>{if(!s)return s;let f=s.replace(/^#/,"");return f.length===8?f.substring(2):f};var _exceljs = require('exceljs'); var _exceljs2 = _interopRequireDefault(_exceljs);var tt=async({columns:s,data:f,grouping:m,date:e,excelSetting:n,title:b,footerSetting:u,groupingSetting:w})=>{let d=new _exceljs2.default.Workbook;s=s.filter(r=>!_optionalChain([r, 'access', _4 => _4.options, 'optionalAccess', _5 => _5.disabledColumn]));let g=d.addWorksheet(b||_optionalChain([n, 'optionalAccess', _6 => _6.titleExcel])),x=U(s),F=g.addRow([]);F.getCell(1).value=b||_optionalChain([n, 'optionalAccess', _7 => _7.titleExcel]),F.getCell(1).alignment={horizontal:"center"};let A=g.getColumn(x).letter;if(g.mergeCells(`A${F.number}:${A}${F.number}`),F.eachCell(r=>{r.font={color:{argb:"000000"},bold:!0,size:12}}),e){let r=g.addRow([]);r.getCell(1).value=`${e.caption?e.caption:"Tanggal "} : ${_optionalChain([e, 'optionalAccess', _8 => _8.start_date])} ${_optionalChain([e, 'optionalAccess', _9 => _9.end_date])?`s/d ${_optionalChain([e, 'optionalAccess', _10 => _10.end_date])}`:""}`,r.getCell(1).alignment={horizontal:"center"},g.mergeCells(`A${r.number}:${A}${r.number}`),r.eachCell(i=>{i.font={color:{argb:"00000"},bold:!0,size:12}})}let v=g.addRow([]);v.getCell(1).value=_optionalChain([n, 'optionalAccess', _11 => _11.additionalTextHeader])||"",v.getCell(1).alignment={horizontal:"center"},g.mergeCells(`A${v.number}:${A}${v.number}`),v.eachCell(r=>{r.font={color:{argb:"000000"},bold:!0,size:12}}),_optionalChain([n, 'optionalAccess', _12 => _12.customHeader])&&n.customHeader(g,x);let I=_optionalChain([n, 'optionalAccess', _13 => _13.startY])&&n.startY>0?n.startY:1;if(I>1)for(let r=1;r<I;r++)g.addRow([]);let D=s.some(r=>r.child&&r.child.length>0),h=g.addRow([]),G=D?g.addRow([]):null;s.forEach(r=>{if(r.child&&r.child.length>0){let i=h.actualCellCount+1,c=r.child.length;h.getCell(i).value=r.label,c>1&&g.mergeCells(h.number,i,h.number,i+c-1);for(let o=i;o<i+c;o++){let t=h.getCell(o);t.fill={type:"pattern",pattern:"solid",fgColor:{argb:_optionalChain([n, 'optionalAccess', _14 => _14.bgColor])||"E8E5E5"}},t.font={color:{argb:_optionalChain([n, 'optionalAccess', _15 => _15.txtColor])||"000000"},bold:!0},t.alignment={horizontal:"center",vertical:"middle"}}r.child.forEach((o,t)=>{if(G){let p=G.getCell(i+t);p.value=o.label,p.fill={type:"pattern",pattern:"solid",fgColor:{argb:_optionalChain([n, 'optionalAccess', _16 => _16.bgColor])||"E8E5E5"}},p.font={color:{argb:_optionalChain([n, 'optionalAccess', _17 => _17.txtColor])||"000000"},bold:!0};let C=_optionalChain([o, 'access', _18 => _18.options, 'optionalAccess', _19 => _19.halign])||(["RP","GR","NUMBER"].includes(_optionalChain([o, 'optionalAccess', _20 => _20.options, 'optionalAccess', _21 => _21.format])||"")?"right":"left"),l=_optionalChain([o, 'access', _22 => _22.options, 'optionalAccess', _23 => _23.valign])||"middle";p.alignment={horizontal:C,vertical:l}}})}else{let i=h.actualCellCount+1;h.getCell(i).value=r.label,h.getCell(i).fill={type:"pattern",pattern:"solid",fgColor:{argb:_optionalChain([n, 'optionalAccess', _24 => _24.bgColor])||"E8E5E5"}},h.getCell(i).font={color:{argb:_optionalChain([n, 'optionalAccess', _25 => _25.txtColor])||"000000"},bold:!0},h.getCell(i).alignment={horizontal:_optionalChain([r, 'access', _26 => _26.options, 'optionalAccess', _27 => _27.halign])||"center",vertical:_optionalChain([r, 'access', _28 => _28.options, 'optionalAccess', _29 => _29.valign])||"middle"},D&&G&&g.mergeCells(h.number,i,G.number,i)}}),P(s).forEach((r,i)=>{let c=i+1,o=g.getColumn(c);if(_optionalChain([r, 'access', _30 => _30.options, 'optionalAccess', _31 => _31.width]))o.width=r.options.width;else{let t=_optionalChain([r, 'access', _32 => _32.options, 'optionalAccess', _33 => _33.format])==="IMAGE"?15:20;o.width=t}});let M={};f.forEach(async r=>{if(_optionalChain([r, 'access', _34 => _34.detail, 'optionalAccess', _35 => _35.length])>0){if(m.length>0){let o=U(s),t=m.map(l=>r[l]!==void 0||r[l]!==null?`${_(l)} : ${r[l]}`:"").filter(Boolean).join("  |  "),p=typeof w=="function"?w(r):w||{},C=g.addRow([t]);g.mergeCells(`A${C.number}:${String.fromCharCode(64+o)}${C.number}`),C.getCell(1).alignment={horizontal:_optionalChain([p, 'optionalAccess', _36 => _36.halign])||"left"},_optionalChain([p, 'optionalAccess', _37 => _37.txtColor])&&(C.getCell(1).font={bold:!0,color:{argb:_optionalChain([p, 'optionalAccess', _38 => _38.txtColor])||"000000"}}),_optionalChain([p, 'optionalAccess', _39 => _39.bgColor])&&(C.getCell(1).fill={type:"pattern",pattern:"solid",fgColor:{argb:_optionalChain([p, 'optionalAccess', _40 => _40.bgColor])}})}let i={};r.detail.forEach(async o=>{let p=P(s).map(l=>{if(_optionalChain([l, 'optionalAccess', _41 => _41.options, 'optionalAccess', _42 => _42.format])==="IMAGE"&&o[l.key])return{value:"",alignment:{horizontal:"center",vertical:"middle"},isImage:!0,imageSrc:o[l.key]};let R=_optionalChain([l, 'optionalAccess', _43 => _43.options, 'optionalAccess', _44 => _44.format])==="DATETIME"?z(o[l.key],!0):_optionalChain([l, 'optionalAccess', _45 => _45.options, 'optionalAccess', _46 => _46.format])==="DATE"?z(o[l.key]):o[l.key];l.formatter&&(R=l.formatter(R,o));let k={horizontal:_optionalChain([l, 'optionalAccess', _47 => _47.options, 'optionalAccess', _48 => _48.halign])?_optionalChain([l, 'optionalAccess', _49 => _49.options, 'optionalAccess', _50 => _50.halign]):_optionalChain([l, 'optionalAccess', _51 => _51.options, 'optionalAccess', _52 => _52.format])==="RP"||_optionalChain([l, 'optionalAccess', _53 => _53.options, 'optionalAccess', _54 => _54.format])==="GR"||_optionalChain([l, 'optionalAccess', _55 => _55.options, 'optionalAccess', _56 => _56.format])==="NUMBER"?"right":"left"},$=l.key,j=o[l.key];return M[$]=(M[$]||0)+Number(j),i[$]=(i[$]||0)+Number(j),{value:R,alignment:k,..._optionalChain([l, 'optionalAccess', _57 => _57.options, 'optionalAccess', _58 => _58.bgColor])&&{fgColor:{argb:l.options.bgColor}},..._optionalChain([l, 'optionalAccess', _59 => _59.options, 'optionalAccess', _60 => _60.txtColor])&&{color:{argb:l.options.txtColor}},numFmt:_optionalChain([l, 'optionalAccess', _61 => _61.options, 'optionalAccess', _62 => _62.format])==="RP"?"#,##0":_optionalChain([l, 'optionalAccess', _63 => _63.options, 'optionalAccess', _64 => _64.format])==="GR"?"#,##0.000":void 0}}),C=g.addRow(p.map(l=>l.value));p.forEach((l,R)=>{let k=C.getCell(R+1),$=["center","right","left","fill","justify","centerContinuous","distributed"],j=["top","middle","bottom","distributed","justify"],S,O;l.alignment&&typeof l.alignment.horizontal=="string"&&$.includes(l.alignment.horizontal)&&(S=l.alignment.horizontal),l.alignment&&"vertical"in l.alignment&&typeof l.alignment.vertical=="string"&&j.includes(l.alignment.vertical)&&(O=l.alignment.vertical),k.alignment={...S?{horizontal:S}:{},...O?{vertical:O}:{}},!l.isImage&&"numFmt"in l&&l.numFmt&&typeof l.value=="number"&&!isNaN(l.value)&&(k.value=Number(l.value),k.numFmt=l.numFmt)}),await V(d,g,C,p)});let c=P(s);if(!_optionalChain([u, 'optionalAccess', _65 => _65.subTotal, 'optionalAccess', _66 => _66.disableSubtotal])){let o=g.addRow(s.map(()=>null));c.forEach((t,p)=>{if(_optionalChain([t, 'optionalAccess', _67 => _67.options, 'optionalAccess', _68 => _68.format])==="RP"||_optionalChain([t, 'optionalAccess', _69 => _69.options, 'optionalAccess', _70 => _70.format])==="GR"||_optionalChain([t, 'optionalAccess', _71 => _71.options, 'optionalAccess', _72 => _72.format])==="NUMBER"){let l=f.length+4-1,R=`SUM(${String.fromCharCode(65+p)}4:${String.fromCharCode(65+p)}${l})`,k=o.getCell(p+1),$=_optionalChain([u, 'optionalAccess', _73 => _73.subTotal, 'optionalAccess', _74 => _74.enableCount])&&m.length>0?" : "+r.detail.length:"",j=_optionalChain([u, 'optionalAccess', _75 => _75.subTotal, 'optionalAccess', _76 => _76.captionItem])?_optionalChain([u, 'optionalAccess', _77 => _77.subTotal, 'optionalAccess', _78 => _78.captionItem]):"";o.getCell(1).value=`${_optionalChain([u, 'optionalAccess', _79 => _79.subTotal, 'optionalAccess', _80 => _80.caption])||"SUB TOTAL"} ${$} ${j}`,o.getCell(1).alignment={horizontal:"center"},k.numFmt=_optionalChain([t, 'optionalAccess', _81 => _81.options, 'optionalAccess', _82 => _82.format])==="GR"?"#,##0.000":"#,##0",k.value={formula:R},o.getCell(p+1).value=_optionalChain([t, 'optionalAccess', _83 => _83.options, 'access', _84 => _84.disabledFooter])?"":i[t.key]}else o.getCell(p+1).value=""}),_optionalChain([n, 'optionalAccess', _85 => _85.grandTotalSetting, 'optionalAccess', _86 => _86.colSpan])&&g.mergeCells(`A${o.number}:${String.fromCharCode(64+Number(_optionalChain([n, 'optionalAccess', _87 => _87.grandTotalSetting, 'optionalAccess', _88 => _88.colSpan])))}${o.number}`),o.eachCell(t=>{t.fill={type:"pattern",pattern:"solid",fgColor:{argb:_optionalChain([n, 'optionalAccess', _89 => _89.bgColor])||"#E8E5E5"},bgColor:{argb:_optionalChain([n, 'optionalAccess', _90 => _90.bgColor])||"#E8E5E5"}},t.font={color:{argb:_optionalChain([n, 'optionalAccess', _91 => _91.txtColor])},bold:!0}})}}else{let c=P(s).map(t=>{if(_optionalChain([t, 'optionalAccess', _92 => _92.options, 'optionalAccess', _93 => _93.format])==="IMAGE"&&r[t.key])return{value:"",alignment:{horizontal:"center",vertical:"middle"},isImage:!0,imageSrc:r[t.key]};let p=_optionalChain([t, 'optionalAccess', _94 => _94.options, 'optionalAccess', _95 => _95.format])==="DATETIME"?z(r[t.key]):_optionalChain([t, 'optionalAccess', _96 => _96.options, 'optionalAccess', _97 => _97.format])==="DATE"?z(r[t.key]):r[t.key];t.formatter&&(p=t.formatter(p,r));let C={horizontal:_optionalChain([t, 'optionalAccess', _98 => _98.options, 'optionalAccess', _99 => _99.halign])?_optionalChain([t, 'optionalAccess', _100 => _100.options, 'optionalAccess', _101 => _101.halign]):_optionalChain([t, 'optionalAccess', _102 => _102.options, 'optionalAccess', _103 => _103.format])==="RP"||_optionalChain([t, 'optionalAccess', _104 => _104.options, 'optionalAccess', _105 => _105.format])==="GR"||_optionalChain([t, 'optionalAccess', _106 => _106.options, 'optionalAccess', _107 => _107.format])==="NUMBER"?"right":"left"},l=t.key,R=r[t.key];return M[l]=(M[l]||0)+Number(R),{value:p,alignment:C,..._optionalChain([t, 'optionalAccess', _108 => _108.options, 'optionalAccess', _109 => _109.bgColor])&&{fgColor:{argb:t.options.bgColor}},..._optionalChain([t, 'optionalAccess', _110 => _110.options, 'optionalAccess', _111 => _111.txtColor])&&{color:{argb:t.options.txtColor}},numFmt:_optionalChain([t, 'optionalAccess', _112 => _112.options, 'optionalAccess', _113 => _113.format])==="RP"?"#,##0":_optionalChain([t, 'optionalAccess', _114 => _114.options, 'optionalAccess', _115 => _115.format])==="GR"?"#,##0.000":void 0}}),o=g.addRow(c.map(t=>t.value));c.forEach((t,p)=>{let C=o.getCell(p+1),l=["center","right","left","fill","justify","centerContinuous","distributed"],R=["top","middle","bottom","distributed","justify"],k,$;t.alignment&&typeof t.alignment.horizontal=="string"&&l.includes(t.alignment.horizontal)&&(k=t.alignment.horizontal),t.alignment&&"vertical"in t.alignment&&typeof t.alignment.vertical=="string"&&R.includes(t.alignment.vertical)&&($=t.alignment.vertical),C.alignment={...k?{horizontal:k}:{},...$?{vertical:$}:{}},!t.isImage&&"numFmt"in t&&t.numFmt&&typeof t.value=="number"&&!isNaN(t.value)&&(C.value=Number(t.value),C.numFmt=t.numFmt),!t.isImage&&"fgColor"in t&&t.fgColor&&(C.fill={type:"pattern",pattern:"solid",fgColor:t.fgColor}),!t.isImage&&"color"in t&&t.color&&(C.font={color:t.color})}),await V(d,g,o,c)}});let L=g.addRow(s.map(()=>null)),H=P(s);_optionalChain([u, 'optionalAccess', _116 => _116.grandTotal, 'optionalAccess', _117 => _117.disableGrandTotal])||(H.forEach((r,i)=>{if(_optionalChain([r, 'optionalAccess', _118 => _118.options, 'optionalAccess', _119 => _119.format])==="RP"||_optionalChain([r, 'optionalAccess', _120 => _120.options, 'optionalAccess', _121 => _121.format])==="GR"||_optionalChain([r, 'optionalAccess', _122 => _122.options, 'optionalAccess', _123 => _123.format])==="NUMBER"){let o=f.length+4-1,t=`SUM(${String.fromCharCode(65+i)}4:${String.fromCharCode(65+i)}${o})`,p=L.getCell(i+1),C=_optionalChain([u, 'optionalAccess', _124 => _124.grandTotal, 'optionalAccess', _125 => _125.enableCount])?m.length>0?" : "+f.map(k=>k.detail.length).reduce((k,$)=>k+$,0):" : "+f.length:"",l=_optionalChain([u, 'optionalAccess', _126 => _126.grandTotal, 'optionalAccess', _127 => _127.captionItem])?_optionalChain([u, 'optionalAccess', _128 => _128.grandTotal, 'optionalAccess', _129 => _129.captionItem]):"",R=`${_optionalChain([u, 'optionalAccess', _130 => _130.grandTotal, 'optionalAccess', _131 => _131.caption])||"GRAND TOTAL"} ${C} ${l}`;L.getCell(1).value=R,L.getCell(1).alignment={horizontal:"center"},p.numFmt=_optionalChain([r, 'optionalAccess', _132 => _132.options, 'optionalAccess', _133 => _133.format])==="GR"?"#,##0.000":"#,##0",p.value={formula:t},L.getCell(i+1).value=_optionalChain([r, 'optionalAccess', _134 => _134.options, 'access', _135 => _135.disabledFooter])?"":M[r.key]}else L.getCell(i+1).value=""}),_optionalChain([n, 'optionalAccess', _136 => _136.grandTotalSetting, 'optionalAccess', _137 => _137.colSpan])&&g.mergeCells(`A${L.number}:${String.fromCharCode(64+Number(_optionalChain([n, 'optionalAccess', _138 => _138.grandTotalSetting, 'optionalAccess', _139 => _139.colSpan])))}${L.number}`),L.eachCell(r=>{r.fill={type:"pattern",pattern:"solid",fgColor:{argb:_optionalChain([n, 'optionalAccess', _140 => _140.bgColor])||"#E8E5E5"},bgColor:{argb:_optionalChain([n, 'optionalAccess', _141 => _141.bgColor])||"#E8E5E5"}},r.font={color:{argb:_optionalChain([n, 'optionalAccess', _142 => _142.txtColor])},bold:!0}})),_optionalChain([n, 'optionalAccess', _143 => _143.customFooter])&&n.customFooter(g,x);let a=await d.xlsx.writeBuffer(),y=new Blob([a],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),T=document.createElement("a");T.href=URL.createObjectURL(y),T.download=`${_optionalChain([n, 'optionalAccess', _144 => _144.titleExcel])||b}.xlsx`,document.body.appendChild(T),T.click(),document.body.removeChild(T)},Y=tt;var _jspdf = require('jspdf'); var _jspdf2 = _interopRequireDefault(_jspdf);var _jspdfautotable = require('jspdf-autotable'); var _jspdfautotable2 = _interopRequireDefault(_jspdfautotable);var et=({columns:s,data:f,grouping:m,pdfSetting:e,date:n,title:b,footerSetting:u,groupingSetting:w})=>{let d=new (0, _jspdf2.default)(_optionalChain([e, 'optionalAccess', _145 => _145.orientation]),_optionalChain([e, 'optionalAccess', _146 => _146.unit]),[_optionalChain([e, 'optionalAccess', _147 => _147.width])||297,_optionalChain([e, 'optionalAccess', _148 => _148.height])||210]),g=[],x=n?30:20;s=s.filter(a=>!_optionalChain([a, 'access', _149 => _149.options, 'optionalAccess', _150 => _150.disabledColumn])),d.setFontSize(10);let F=d.internal.pageSize.getWidth(),A=d.splitTextToSize(_optionalChain([e, 'optionalAccess', _151 => _151.textHeaderLeft])||"",110);d.text(A,15,18),d.text(`${b||_optionalChain([e, 'optionalAccess', _152 => _152.titlePdf])}`,F-15,18,{align:"right"}),n&&d.text(`${n.caption?n.caption:"TANGGAL "} : ${_optionalChain([n, 'optionalAccess', _153 => _153.start_date])} ${_optionalChain([n, 'optionalAccess', _154 => _154.end_date])?`s/d ${_optionalChain([n, 'optionalAccess', _155 => _155.end_date])}`:""}`,F-15,22,{align:"right"}),typeof _optionalChain([e, 'optionalAccess', _156 => _156.customHeader])=="function"&&e.customHeader(d,x,_jspdfautotable2.default),d.setProperties({title:b||_optionalChain([e, 'optionalAccess', _157 => _157.titlePdf])}),_optionalChain([e, 'optionalAccess', _158 => _158.startY])&&(x=e.startY);let v=[],I=[],D=s.some(a=>a.child&&a.child.length>0);s.forEach(a=>{let y={textColor:`#${E(_optionalChain([e, 'optionalAccess', _159 => _159.txtColor])||"000")}`,fillColor:`#${E(_optionalChain([e, 'optionalAccess', _160 => _160.bgColor])||"E8E5E5")}`,..._optionalChain([a, 'optionalAccess', _161 => _161.options, 'optionalAccess', _162 => _162.width])&&{cellWidth:_optionalChain([a, 'optionalAccess', _163 => _163.options, 'optionalAccess', _164 => _164.width])},fontStyle:"bold",..._optionalChain([a, 'optionalAccess', _165 => _165.options, 'optionalAccess', _166 => _166.valign])?{valign:a.options.valign}:{},halign:_nullishCoalesce(_optionalChain([a, 'optionalAccess', _167 => _167.options, 'optionalAccess', _168 => _168.halign]), () => ((["RP","GR","NUMBER"].includes(_optionalChain([a, 'optionalAccess', _169 => _169.options, 'optionalAccess', _170 => _170.format])||"")?"right":"left")))};D?a.child&&a.child.length>0?(v.push({content:a.label,colSpan:a.child.length,styles:y}),a.child.forEach(T=>{I.push({content:T.label,key:T.key,options:T.options,styles:{...y,halign:_nullishCoalesce(_optionalChain([T, 'optionalAccess', _171 => _171.options, 'optionalAccess', _172 => _172.halign]), () => ((["RP","GR","NUMBER"].includes(_optionalChain([T, 'optionalAccess', _173 => _173.options, 'optionalAccess', _174 => _174.format])||"")?"right":"left")))}})})):v.push({content:a.label,rowSpan:2,key:a.key,options:a.options,styles:y}):v.push({content:a.label,key:a.key,options:a.options,styles:y})}),_optionalChain([e, 'optionalAccess', _175 => _175.header, 'optionalAccess', _176 => _176.column])||(g.push(v),D&&I.length>0&&g.push(I));let h={};f.forEach(a=>{if(_optionalChain([a, 'access', _177 => _177.detail, 'optionalAccess', _178 => _178.length])>0){if(m.length>0){let r=U(s),i=m.map(t=>a[t]!==void 0||a[t]!==null?`${_(t)} : ${a[t]}`:"").filter(Boolean).join("  |  "),c=typeof w=="function"?w(a):w||{},o=[{content:i,colSpan:r,styles:{fontStyle:"bold",halign:_optionalChain([c, 'optionalAccess', _179 => _179.halign])||"left",textColor:`#${E(_optionalChain([c, 'optionalAccess', _180 => _180.txtColor])||"000")}`,fillColor:`#${E(_optionalChain([c, 'optionalAccess', _181 => _181.bgColor])||"FFF")}`}}];g.push(o)}let y={},T=P(s);if(a.detail.forEach(r=>{let i=T.map(c=>{let o=r[c.key],t=c.key;c.formatter&&(o=c.formatter(o,r));let p=r[c.key];h[t]=(h[t]||0)+Number(p||0),y[t]=(y[t]||0)+Number(p||0);let C=_optionalChain([c, 'access', _182 => _182.options, 'optionalAccess', _183 => _183.format])==="IMAGE";return{content:(()=>{switch(_optionalChain([c, 'optionalAccess', _184 => _184.options, 'optionalAccess', _185 => _185.format])){case"RP":return o!==void 0?Number(o||0).toLocaleString("kr-ko"):"";case"GR":return o!==void 0?Number(o||0).toFixed(3):"";case"NUMBER":return o!==void 0?Number(o||0):"";case"IMAGE":return"";case"DATETIME":return o!==void 0?z(o||new Date,!0):"";case"DATE":return o!==void 0?z(o||new Date):"";default:return o!==void 0?o.toString():""}})(),foto:C?o:null,styles:{textColor:_optionalChain([c, 'optionalAccess', _186 => _186.options, 'optionalAccess', _187 => _187.txtColor])?`#${E(_optionalChain([c, 'optionalAccess', _188 => _188.options, 'optionalAccess', _189 => _189.txtColor]))}`:"#000",fillColor:_optionalChain([c, 'optionalAccess', _190 => _190.options, 'optionalAccess', _191 => _191.bgColor])?`#${E(_optionalChain([c, 'optionalAccess', _192 => _192.options, 'optionalAccess', _193 => _193.bgColor]))}`:void 0,halign:_optionalChain([c, 'optionalAccess', _194 => _194.options, 'optionalAccess', _195 => _195.halign])?_optionalChain([c, 'optionalAccess', _196 => _196.options, 'optionalAccess', _197 => _197.halign]):_optionalChain([c, 'optionalAccess', _198 => _198.options, 'optionalAccess', _199 => _199.format])==="RP"||_optionalChain([c, 'optionalAccess', _200 => _200.options, 'optionalAccess', _201 => _201.format])==="GR"||_optionalChain([c, 'optionalAccess', _202 => _202.options, 'optionalAccess', _203 => _203.format])==="NUMBER"||typeof o=="number"?"right":"left"}}});g.push(i)}),!_optionalChain([u, 'optionalAccess', _204 => _204.subTotal, 'optionalAccess', _205 => _205.disableSubtotal])){let r=[];T.forEach(t=>{let p=y[t.key];_optionalChain([t, 'optionalAccess', _206 => _206.options, 'optionalAccess', _207 => _207.format])==="RP"||_optionalChain([t, 'optionalAccess', _208 => _208.options, 'optionalAccess', _209 => _209.format])==="GR"||_optionalChain([t, 'optionalAccess', _210 => _210.options, 'optionalAccess', _211 => _211.format])==="NUMBER"?r.push({content:_optionalChain([t, 'optionalAccess', _212 => _212.options, 'optionalAccess', _213 => _213.disabledFooter])?"":(()=>{switch(_optionalChain([t, 'optionalAccess', _214 => _214.options, 'optionalAccess', _215 => _215.format])){case"RP":return p.toLocaleString("kr-ko");case"GR":return p.toFixed(3);case"NUMBER":return p;default:return p.toString()}})(),styles:{halign:_optionalChain([t, 'optionalAccess', _216 => _216.options, 'optionalAccess', _217 => _217.halign])||"right",textColor:`#${E(_optionalChain([e, 'optionalAccess', _218 => _218.txtColor])||"000")}`,fillColor:`#${E(_optionalChain([e, 'optionalAccess', _219 => _219.bgColor])||"E8E5E5")}`,fontStyle:"bold"}}):r.push({content:"",styles:{textColor:`#${E(_optionalChain([e, 'optionalAccess', _220 => _220.txtColor])||"000")}`,fillColor:`#${E(_optionalChain([e, 'optionalAccess', _221 => _221.bgColor])||"E8E5E5")}`,fontStyle:"bold"}})});let i=_optionalChain([e, 'optionalAccess', _222 => _222.grandTotalSetting, 'optionalAccess', _223 => _223.colSpan])?Number(_optionalChain([e, 'optionalAccess', _224 => _224.grandTotalSetting, 'optionalAccess', _225 => _225.colSpan])||0)+1:0,c=_optionalChain([u, 'optionalAccess', _226 => _226.subTotal, 'optionalAccess', _227 => _227.enableCount])&&m.length>0?" : "+a.detail.length:"",o=_optionalChain([u, 'optionalAccess', _228 => _228.subTotal, 'optionalAccess', _229 => _229.captionItem])?_optionalChain([u, 'optionalAccess', _230 => _230.subTotal, 'optionalAccess', _231 => _231.captionItem]):"";r[0]={content:`${_optionalChain([u, 'optionalAccess', _232 => _232.subTotal, 'optionalAccess', _233 => _233.caption])||"SUB TOTAL"}${c} ${o}`,colSpan:i,styles:{textColor:`#${E(_optionalChain([e, 'optionalAccess', _234 => _234.txtColor])||"000")}`,fillColor:`#${E(_optionalChain([e, 'optionalAccess', _235 => _235.bgColor])||"E8E5E5")}`,fontStyle:"bold",halign:"center"}},_optionalChain([e, 'optionalAccess', _236 => _236.grandTotalSetting, 'optionalAccess', _237 => _237.colSpan])&&r.splice(1,_optionalChain([e, 'optionalAccess', _238 => _238.grandTotalSetting, 'optionalAccess', _239 => _239.colSpan])),g.push(r)}}else{let y=(i,c)=>{let o=c[i.key],t=i.key;if(i.formatter&&(o=i.formatter(o,c)),!_optionalChain([i, 'access', _240 => _240.options, 'optionalAccess', _241 => _241.disabledFooter])){let R=c[i.key];h[t]=(h[t]||0)+Number(R||0)}let p=(()=>{switch(_optionalChain([i, 'optionalAccess', _242 => _242.options, 'optionalAccess', _243 => _243.format])){case"RP":return o!==void 0?Number(o||0).toLocaleString("kr-ko"):"";case"GR":return o!==void 0?Number(o||0).toFixed(3):"";case"NUMBER":return o!==void 0?Number(o||0):"";case"IMAGE":return"";case"DATETIME":return o!==void 0?z(o||new Date,!0):"";case"DATE":return o!==void 0?z(o||new Date):"";default:return o!==void 0?_optionalChain([o, 'optionalAccess', _244 => _244.toString, 'call', _245 => _245()]):""}})(),C=_optionalChain([i, 'optionalAccess', _246 => _246.options, 'optionalAccess', _247 => _247.halign])?_optionalChain([i, 'optionalAccess', _248 => _248.options, 'optionalAccess', _249 => _249.halign]):_optionalChain([i, 'optionalAccess', _250 => _250.options, 'optionalAccess', _251 => _251.format])==="RP"||_optionalChain([i, 'optionalAccess', _252 => _252.options, 'optionalAccess', _253 => _253.format])==="GR"||_optionalChain([i, 'optionalAccess', _254 => _254.options, 'optionalAccess', _255 => _255.format])==="NUMBER"||typeof o=="number"?"right":"left",l=_optionalChain([i, 'access', _256 => _256.options, 'optionalAccess', _257 => _257.format])==="IMAGE";return{options:_optionalChain([i, 'optionalAccess', _258 => _258.options]),content:p,foto:l?o:null,styles:{halign:C,textColor:_optionalChain([i, 'optionalAccess', _259 => _259.options, 'optionalAccess', _260 => _260.txtColor])?`#${E(_optionalChain([i, 'optionalAccess', _261 => _261.options, 'optionalAccess', _262 => _262.txtColor]))}`:"#000",fillColor:_optionalChain([i, 'optionalAccess', _263 => _263.options, 'optionalAccess', _264 => _264.bgColor])?`#${E(_optionalChain([i, 'optionalAccess', _265 => _265.options, 'optionalAccess', _266 => _266.bgColor]))}`:void 0}}},r=P(s).map(i=>y(i,a));g.push(r)}});let G=P(s);if(!_optionalChain([u, 'optionalAccess', _267 => _267.grandTotal, 'optionalAccess', _268 => _268.disableGrandTotal])){let a=[];G.forEach(o=>{let t=h[o.key],p=["RP","GR","NUMBER"].includes(_optionalChain([o, 'optionalAccess', _269 => _269.options, 'optionalAccess', _270 => _270.format])||""),C=_optionalChain([o, 'optionalAccess', _271 => _271.options, 'optionalAccess', _272 => _272.disabledFooter])?"":(()=>{if(!p)return"";switch(_optionalChain([o, 'access', _273 => _273.options, 'optionalAccess', _274 => _274.format])){case"RP":return Number(t||0).toLocaleString("kr-KO");case"GR":return Number(t||0).toFixed(3);case"NUMBER":return Number(t||0);default:return(t||0).toString()}})();a.push({options:_optionalChain([o, 'optionalAccess', _275 => _275.options]),content:C,styles:{halign:_optionalChain([o, 'optionalAccess', _276 => _276.options, 'optionalAccess', _277 => _277.halign])?o.options.halign:p?"right":"left",textColor:`#${E(_optionalChain([e, 'optionalAccess', _278 => _278.txtColor])||"000")}`,fillColor:`#${E(_optionalChain([e, 'optionalAccess', _279 => _279.bgColor])||"E8E5E5")}`,fontStyle:"bold"}})});let y=Number(_optionalChain([e, 'optionalAccess', _280 => _280.grandTotalSetting, 'optionalAccess', _281 => _281.colSpan])||0),T=Math.min(y+1,G.length),r=_optionalChain([u, 'optionalAccess', _282 => _282.grandTotal, 'optionalAccess', _283 => _283.enableCount])?m.length>0?f.reduce((o,t)=>o+t.detail.length,0):f.length:0,i=_optionalChain([u, 'optionalAccess', _284 => _284.grandTotal, 'optionalAccess', _285 => _285.captionItem])||"",c=`${_optionalChain([u, 'optionalAccess', _286 => _286.grandTotal, 'optionalAccess', _287 => _287.caption])||"GRAND TOTAL"}`+(r?` : ${r}`:"")+(i?` ${i}`:"");for(a[0]={content:c,colSpan:T,styles:{textColor:`#${E(_optionalChain([e, 'optionalAccess', _288 => _288.txtColor])||"000")}`,fillColor:`#${E(_optionalChain([e, 'optionalAccess', _289 => _289.bgColor])||"E8E5E5")}`,fontStyle:"bold",halign:"center"}},a.splice(1,T-1);a.length<G.length;)a.push({content:"",styles:{textColor:`#${E(_optionalChain([e, 'optionalAccess', _290 => _290.txtColor])||"000")}`,fillColor:`#${E(_optionalChain([e, 'optionalAccess', _291 => _291.bgColor])||"E8E5E5")}`,fontStyle:"bold"}});g.push(a)}if(typeof _optionalChain([e, 'optionalAccess', _292 => _292.addRow])=="function"&&_optionalChain([e, 'optionalAccess', _293 => _293.addRow, 'call', _294 => _294(g)]),!_optionalChain([e, 'optionalAccess', _295 => _295.disablePrintDate])){let a=U(s);g.push([{content:`Print Date : ${z(`${new Date}`)}`,colSpan:a,styles:{textColor:`#${E(_optionalChain([e, 'optionalAccess', _296 => _296.txtColor])||"000")}`,fillColor:`#${E(_optionalChain([e, 'optionalAccess', _297 => _297.bgColor])||"E8E5E5")}`,fontStyle:"italic"}}])}let N=[];_optionalChain([e, 'optionalAccess', _298 => _298.header, 'optionalAccess', _299 => _299.column])&&(N.push(v),D&&I.length>0&&N.push(I)),_jspdfautotable2.default.call(void 0, d,{head:N,body:g,startY:x,theme:_optionalChain([e, 'optionalAccess', _300 => _300.theme])||"plain",rowPageBreak:"avoid",margin:{top:_optionalChain([e, 'optionalAccess', _301 => _301.header, 'optionalAccess', _302 => _302.information])?30:10},bodyStyles:{fontSize:_optionalChain([e, 'optionalAccess', _303 => _303.fontSIze])||8},headStyles:{fontSize:_optionalChain([e, 'optionalAccess', _304 => _304.fontSIze])||8,textColor:`#${E(_optionalChain([e, 'optionalAccess', _305 => _305.txtColor])||"000")}`,fillColor:`#${E(_optionalChain([e, 'optionalAccess', _306 => _306.bgColor])||"E8E5E5")}`},tableLineColor:[255,255,255],didParseCell:function(a){let y=a.column.index;_optionalChain([G, 'access', _307 => _307[y], 'optionalAccess', _308 => _308.options, 'optionalAccess', _309 => _309.format])==="IMAGE"&&a.cell.raw&&a.cell.raw.foto&&(a.row.height=20,a.cell.styles.valign="middle",a.cell.styles.halign="center")},didDrawPage:function(a){if(_optionalChain([e, 'optionalAccess', _310 => _310.header, 'optionalAccess', _311 => _311.information])&&a.pageNumber>1){d.setFontSize(10);let y=d.internal.pageSize.getWidth(),T=d.splitTextToSize(_optionalChain([e, 'optionalAccess', _312 => _312.textHeaderLeft])||"",110);d.text(T,15,18),d.text(`${b||_optionalChain([e, 'optionalAccess', _313 => _313.titlePdf])}`,y-15,18,{align:"right"}),n&&d.text(`${n.caption?n.caption:"TANGGAL "} : ${_optionalChain([n, 'optionalAccess', _314 => _314.start_date])} ${_optionalChain([n, 'optionalAccess', _315 => _315.end_date])?`s/d ${_optionalChain([n, 'optionalAccess', _316 => _316.end_date])}`:""}`,y-15,22,{align:"right"})}},didDrawCell:function(a){let{cell:y}=a,r=(y.raw||{}).foto,i=a.column.index;if(_optionalChain([G, 'access', _317 => _317[i], 'optionalAccess', _318 => _318.options, 'optionalAccess', _319 => _319.format])==="IMAGE"&&r){let t=y.x+(y.width-15)/2,p=y.y+(y.height-15)/2;try{d.addImage(r,"JPG",t,p,15,15)}catch(C){console.warn("\u274C Gagal render gambar:",C)}}}}),g=[],x=d.lastAutoTable.finalY;let M=d.internal.getNumberOfPages(),L=d.internal.pageSize.width,H=d.internal.pageSize.height;d.setFontSize(10);for(let a=1;a<M+1;a++){let y=L/2,T=H-10;d.setPage(a),d.text(`${a} of ${M}`,y,T,{align:"center"})}if(typeof _optionalChain([e, 'optionalAccess', _320 => _320.customFooter])=="function"&&e.customFooter(d,x,_jspdfautotable2.default),_optionalChain([e, 'optionalAccess', _321 => _321.openNewTab])){let a=d.output("bloburl");window.open(a)}else d.save(`${_optionalChain([e, 'optionalAccess', _322 => _322.titlePdf])||b}.pdf`)},J=et;var rt=s=>{let f=[],m=s.copy?2:1;for(let e=0;e<m;e++){let n=s.data.map(b=>{let u=s.template;for(;/\n!!LOOP\((.+)\)(\{\n(.*\n)+\})\n/gm.exec(u);)u=u.replace(/\n!!LOOP\((.+)\)(\{\n(.*\n)+\})\n/,(w,d,g)=>{let x=g.replace(/^\{/,"").replace(/\}$/,"");return(Array.isArray(b[d])?b[d]:[b[d]]).reduce((v,I)=>v+x.replace(/\{([a-z0-9_]+)\}/gm,D=>{let h=D.replace(/(\{|\})/g,"");if(h.match(/nama_barang/)){let G=h.match(/nama_barang/),N=h==="nama_barang2"?[20,40]:h==="nama_barang3"?[40,60]:[0,20];return _optionalChain([I, 'access', _323 => _323[G], 'optionalAccess', _324 => _324.slice, 'call', _325 => _325(...N), 'access', _326 => _326.trim, 'call', _327 => _327()])||""}if(h.match(/deskripsi_jual/)){let G=h.match(/deskripsi_jual/),N=h==="deskripsi_jual2"?[20,40]:h==="deskripsi_jual3"?[40,60]:[0,20];return _optionalChain([I, 'access', _328 => _328[G], 'optionalAccess', _329 => _329.slice, 'call', _330 => _330(...N), 'access', _331 => _331.trim, 'call', _332 => _332()])||""}if(h.match(/deskripsi/)){let G=h.match(/deskripsi/),N=h==="deskripsi2"?[20,40]:h==="deskripsi3"?[40,60]:[0,20];return _optionalChain([I, 'access', _333 => _333[G], 'optionalAccess', _334 => _334.slice, 'call', _335 => _335(...N), 'access', _336 => _336.trim, 'call', _337 => _337()])||""}return I[h]||""}),"").replace(/\n(\s)+\n/gm,`
`)});return u.replace(/\{([a-z0-9_]+)\}/gm,w=>{let d=w.replace(/(\{|\})/g,"");return d.match(/auto_cut/)?`
VA`:b[d]||""}).replace(/\n(\s)+\n/gm,`
`).replace(/~new_line~/gm,`
`).replace(/!!LOOP\(detail\)/g,"").replace(/[}{]/g,"")});for(let b in n)n[b]+=`

`;f.push(...n)}return f},nt=async(s,f)=>{let m=rt(s),e=new Blob([_optionalChain([m, 'optionalAccess', _338 => _338.join, 'call', _339 => _339(`
`)])||""],{type:"text/plain"}),n=document.createElement("a");n.href=URL.createObjectURL(e),n.download=f,document.body.appendChild(n),n.click(),document.body.removeChild(n)},X=nt;var $t=({columns:s,data:f,grouping:m,date:e,type:n,txtSetting:b,pdfSetting:u,excelSetting:w,title:d,footerSetting:g,groupingSetting:x})=>{let F={data:[_optionalChain([b, 'optionalAccess', _340 => _340.dataTxt])],template:_optionalChain([b, 'optionalAccess', _341 => _341.templateTxt]),copy:_optionalChain([b, 'optionalAccess', _342 => _342.copy])};if(f.length===0)throw new Error("Data is required");if(n.length===0)throw new Error("Type is required");if(!q(n))throw new Error('Type Export must use ["EXCEL", "PDF", "TXT", "ALL"]');n.forEach(A=>{A==="PDF"?J({pdfSetting:u,date:e,data:f,type:n,columns:s,grouping:m,title:d,footerSetting:g,groupingSetting:x}):A==="TXT"?X(F,_optionalChain([b, 'optionalAccess', _343 => _343.titleTxt])||""):A==="EXCEL"?Y({date:e,data:f,type:n,columns:s,grouping:m,excelSetting:w,title:d,footerSetting:g,groupingSetting:x}):(Y({date:e,data:f,type:n,columns:s,grouping:m,excelSetting:w,title:d,groupingSetting:x}),J({pdfSetting:u,date:e,data:f,type:n,columns:s,grouping:m,title:d,groupingSetting:x}),X(F,_optionalChain([b, 'optionalAccess', _344 => _344.titleTxt])||""))})};exports.ExportData = $t;
//# sourceMappingURL=index.js.map