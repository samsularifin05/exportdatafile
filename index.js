"use strict";Object.defineProperty(exports, "__esModule", {value: true}); function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; } function _nullishCoalesce(lhs, rhsFn) { if (lhs != null) { return lhs; } else { return rhsFn(); } } function _optionalChain(ops) { let lastAccessLHS = undefined; let value = ops[0]; let i = 1; while (i < ops.length) { const op = ops[i]; const fn = ops[i + 1]; i += 2; if ((op === 'optionalAccess' || op === 'optionalCall') && value == null) { return undefined; } if (op === 'access' || op === 'optionalAccess') { lastAccessLHS = value; value = fn(value); } else if (op === 'call' || op === 'optionalCall') { value = fn((...args) => value.call(lastAccessLHS, ...args)); lastAccessLHS = undefined; } } return value; }var J=["EXCEL","PDF","TXT","ALL"];function D(l){let i=new Date(l),m=i.getFullYear(),t=String(i.getMonth()+1).padStart(2,"0"),n=String(i.getDate()).padStart(2,"0"),h=String(i.getHours()).padStart(2,"0"),p=String(i.getMinutes()).padStart(2,"0"),g=String(i.getSeconds()).padStart(2,"0");return`${n}-${t}-${m} ${h}:${p}:${g}`}function W(l){return l.every(i=>J.includes(i))}function M(l){let i=0;return l.forEach(m=>{m.child&&m.child.length>0?i+=M(m.child):i+=1}),i}var N=l=>{let i=[];return l.forEach(m=>{m.child&&m.child.length>0?i.push(...N(m.child)):i.push(m)}),i},j=l=>l.split("_").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" ");async function O(l,i,m,t){for(let n=0;n<t.length;n++){let h=t[n];if(_optionalChain([h, 'optionalAccess', _2 => _2.isImage])&&_optionalChain([h, 'optionalAccess', _3 => _3.imageSrc])&&typeof h.imageSrc=="string"&&h.imageSrc.startsWith("data:image"))try{let{buffer:p,extension:g}=Q(h.imageSrc),r=l.addImage({buffer:p,extension:g});i.addImage(r,{tl:{col:n,row:m.number-1},ext:{width:70,height:60},editAs:"oneCell"}),(!m.height||m.height<60)&&(m.height=35)}catch(p){console.error("\u274C Error adding image to row:",p),m.getCell(n+1).value="[Image]"}}}function Q(l){let i=l.match(/^data:image\/(\w+);base64,(.*)$/);if(!i)throw new Error("Invalid base64 image format");let m=i[1]==="jpg"?"jpeg":i[1],t=i[2],n=atob(t),h=n.length,p=new Uint8Array(h);for(let g=0;g<h;g++)p[g]=n.charCodeAt(g);return{buffer:p,extension:m}}var _exceljs = require('exceljs'); var _exceljs2 = _interopRequireDefault(_exceljs);var tt=async({columns:l,data:i,grouping:m,date:t,excelSetting:n,title:h,footerSetting:p})=>{let g=new _exceljs2.default.Workbook;l=l.filter(e=>!_optionalChain([e, 'access', _4 => _4.options, 'optionalAccess', _5 => _5.disabledColumn]));let r=g.addWorksheet(h||_optionalChain([n, 'optionalAccess', _6 => _6.titleExcel])),I=M(l),G=r.addRow([]);G.getCell(1).value=h||_optionalChain([n, 'optionalAccess', _7 => _7.titleExcel]),G.getCell(1).alignment={horizontal:"center"};let F=r.getColumn(I).letter;if(r.mergeCells(`A${G.number}:${F}${G.number}`),G.eachCell(e=>{e.font={color:{argb:"000000"},bold:!0,size:12}}),t){let e=r.addRow([]);e.getCell(1).value=`${t.caption?t.caption:"Tanggal "} : ${_optionalChain([t, 'optionalAccess', _8 => _8.start_date])} ${_optionalChain([t, 'optionalAccess', _9 => _9.end_date])?`s/d ${_optionalChain([t, 'optionalAccess', _10 => _10.end_date])}`:""}`,e.getCell(1).alignment={horizontal:"center"},r.mergeCells(`A${e.number}:${F}${e.number}`),e.eachCell(d=>{d.font={color:{argb:"00000"},bold:!0,size:12}})}let z=r.addRow([]);z.getCell(1).value=_optionalChain([n, 'optionalAccess', _11 => _11.additionalTextHeader])||"",z.getCell(1).alignment={horizontal:"center"},r.mergeCells(`A${z.number}:${F}${z.number}`),z.eachCell(e=>{e.font={color:{argb:"000000"},bold:!0,size:12}});let L=l.some(e=>e.child&&e.child.length>0),R=r.addRow([]),$=L?r.addRow([]):null;l.forEach(e=>{if(e.child&&e.child.length>0){let d=R.actualCellCount+1,E=e.child.length;R.getCell(d).value=e.label,E>1&&r.mergeCells(R.number,d,R.number,d+E-1);for(let c=d;c<d+E;c++){let a=R.getCell(c);a.fill={type:"pattern",pattern:"solid",fgColor:{argb:_optionalChain([n, 'optionalAccess', _12 => _12.bgColor])||"E8E5E5"}},a.font={color:{argb:_optionalChain([n, 'optionalAccess', _13 => _13.txtColor])||"000000"},bold:!0},a.alignment={horizontal:"center",vertical:"middle"}}e.child.forEach((c,a)=>{if($){let f=$.getCell(d+a);f.value=c.label,f.fill={type:"pattern",pattern:"solid",fgColor:{argb:_optionalChain([n, 'optionalAccess', _14 => _14.bgColor])||"E8E5E5"}},f.font={color:{argb:_optionalChain([n, 'optionalAccess', _15 => _15.txtColor])||"000000"},bold:!0};let C=_optionalChain([c, 'access', _16 => _16.options, 'optionalAccess', _17 => _17.halign])||(["RP","GR","NUMBER"].includes(_optionalChain([c, 'optionalAccess', _18 => _18.options, 'optionalAccess', _19 => _19.format])||"")?"right":"left"),u=_optionalChain([c, 'access', _20 => _20.options, 'optionalAccess', _21 => _21.valign])||"middle";f.alignment={horizontal:C,vertical:u}}})}else{let d=R.actualCellCount+1;R.getCell(d).value=e.label,R.getCell(d).fill={type:"pattern",pattern:"solid",fgColor:{argb:_optionalChain([n, 'optionalAccess', _22 => _22.bgColor])||"E8E5E5"}},R.getCell(d).font={color:{argb:_optionalChain([n, 'optionalAccess', _23 => _23.txtColor])||"000000"},bold:!0},R.getCell(d).alignment={horizontal:_optionalChain([e, 'access', _24 => _24.options, 'optionalAccess', _25 => _25.halign])||"center",vertical:_optionalChain([e, 'access', _26 => _26.options, 'optionalAccess', _27 => _27.valign])||"middle"},L&&$&&r.mergeCells(R.number,d,$.number,d)}});let y={};i.forEach(async e=>{if(m.length>0){let d=M(l),E=m.map(u=>e[u]!==void 0?`${j(u)} : ${e[u]}`:"").filter(Boolean).join("  |  "),c=r.addRow([E]);r.mergeCells(`A${c.number}:${String.fromCharCode(64+d)}${c.number}`),c.getCell(1).alignment={horizontal:"left"},c.getCell(1).font={bold:!0};let a={};e.detail.forEach(async u=>{let b=N(l).map(s=>{if(_optionalChain([s, 'optionalAccess', _28 => _28.options, 'optionalAccess', _29 => _29.format])==="IMAGE"&&u[s.key])return{value:"",alignment:{horizontal:"center",vertical:"middle"},isImage:!0,imageSrc:u[s.key]};let T=_optionalChain([s, 'optionalAccess', _30 => _30.options, 'optionalAccess', _31 => _31.format])==="DATETIME"?D(u[s.key]):u[s.key],v={horizontal:_optionalChain([s, 'optionalAccess', _32 => _32.options, 'optionalAccess', _33 => _33.halign])?_optionalChain([s, 'optionalAccess', _34 => _34.options, 'optionalAccess', _35 => _35.halign]):_optionalChain([s, 'optionalAccess', _36 => _36.options, 'optionalAccess', _37 => _37.format])==="RP"||_optionalChain([s, 'optionalAccess', _38 => _38.options, 'optionalAccess', _39 => _39.format])==="GR"||_optionalChain([s, 'optionalAccess', _40 => _40.options, 'optionalAccess', _41 => _41.format])==="NUMBER"?"right":"left"},P=s.key;return y[P]=(y[P]||0)+Number(T),a[P]=(a[P]||0)+Number(T),{value:T,alignment:v,numFmt:_optionalChain([s, 'optionalAccess', _42 => _42.options, 'optionalAccess', _43 => _43.format])==="RP"?"#,##0":_optionalChain([s, 'optionalAccess', _44 => _44.options, 'optionalAccess', _45 => _45.format])==="GR"?"#,##0.000":void 0}}),k=r.addRow(b.map(s=>s.value));b.forEach((s,T)=>{let v=k.getCell(T+1),P=["center","right","left","fill","justify","centerContinuous","distributed"],q=["top","middle","bottom","distributed","justify"],_,H;s.alignment&&typeof s.alignment.horizontal=="string"&&P.includes(s.alignment.horizontal)&&(_=s.alignment.horizontal),s.alignment&&"vertical"in s.alignment&&typeof s.alignment.vertical=="string"&&q.includes(s.alignment.vertical)&&(H=s.alignment.vertical),v.alignment={..._?{horizontal:_}:{},...H?{vertical:H}:{}},s.numFmt&&typeof s.value=="number"&&!isNaN(s.value)&&(v.value=Number(s.value),v.numFmt=s.numFmt)}),await O(g,r,k,b)});let f=N(l),C=r.addRow(l.map(()=>null));f.forEach((u,x)=>{if(_optionalChain([u, 'optionalAccess', _46 => _46.options, 'optionalAccess', _47 => _47.format])==="RP"||_optionalChain([u, 'optionalAccess', _48 => _48.options, 'optionalAccess', _49 => _49.format])==="GR"||_optionalChain([u, 'optionalAccess', _50 => _50.options, 'optionalAccess', _51 => _51.format])==="NUMBER"){let k=i.length+4-1,s=`SUM(${String.fromCharCode(65+x)}4:${String.fromCharCode(65+x)}${k})`,T=C.getCell(x+1),v=_optionalChain([p, 'optionalAccess', _52 => _52.subTotal, 'optionalAccess', _53 => _53.enableCount])&&m.length>0?" : "+e.detail.length:"",P=_optionalChain([p, 'optionalAccess', _54 => _54.subTotal, 'optionalAccess', _55 => _55.captionItem])?_optionalChain([p, 'optionalAccess', _56 => _56.subTotal, 'optionalAccess', _57 => _57.captionItem]):"";C.getCell(1).value=`${_optionalChain([p, 'optionalAccess', _58 => _58.subTotal, 'optionalAccess', _59 => _59.caption])||"SUB TOTAL"} ${v} ${P}`,C.getCell(1).alignment={horizontal:"center"},T.numFmt=_optionalChain([u, 'optionalAccess', _60 => _60.options, 'optionalAccess', _61 => _61.format])==="GR"?"#,##0.000":"#,##0",T.value={formula:s},C.getCell(x+1).value=_optionalChain([u, 'optionalAccess', _62 => _62.options, 'access', _63 => _63.disabledFooter])?"":a[u.key]}else C.getCell(x+1).value=""}),_optionalChain([n, 'optionalAccess', _64 => _64.grandTotalSetting, 'optionalAccess', _65 => _65.colSpan])&&r.mergeCells(`A${C.number}:${String.fromCharCode(64+Number(_optionalChain([n, 'optionalAccess', _66 => _66.grandTotalSetting, 'optionalAccess', _67 => _67.colSpan])))}${C.number}`),C.eachCell(u=>{u.fill={type:"pattern",pattern:"solid",fgColor:{argb:_optionalChain([n, 'optionalAccess', _68 => _68.bgColor])||"#E8E5E5"},bgColor:{argb:_optionalChain([n, 'optionalAccess', _69 => _69.bgColor])||"#E8E5E5"}},u.font={color:{argb:_optionalChain([n, 'optionalAccess', _70 => _70.txtColor])},bold:!0}})}else{let E=N(l).map(a=>{if(_optionalChain([a, 'optionalAccess', _71 => _71.options, 'optionalAccess', _72 => _72.format])==="IMAGE"&&e[a.key])return{value:"",alignment:{horizontal:"center",vertical:"middle"},isImage:!0,imageSrc:e[a.key]};let f=_optionalChain([a, 'optionalAccess', _73 => _73.options, 'optionalAccess', _74 => _74.format])==="DATETIME"?D(e[a.key]):e[a.key],C={horizontal:_optionalChain([a, 'optionalAccess', _75 => _75.options, 'optionalAccess', _76 => _76.halign])?_optionalChain([a, 'optionalAccess', _77 => _77.options, 'optionalAccess', _78 => _78.halign]):_optionalChain([a, 'optionalAccess', _79 => _79.options, 'optionalAccess', _80 => _80.format])==="RP"||_optionalChain([a, 'optionalAccess', _81 => _81.options, 'optionalAccess', _82 => _82.format])==="GR"||_optionalChain([a, 'optionalAccess', _83 => _83.options, 'optionalAccess', _84 => _84.format])==="NUMBER"?"right":"left"},u=a.key;return y[u]=(y[u]||0)+Number(f),{value:f,alignment:C,numFmt:_optionalChain([a, 'optionalAccess', _85 => _85.options, 'optionalAccess', _86 => _86.format])==="RP"?"#,##0":_optionalChain([a, 'optionalAccess', _87 => _87.options, 'optionalAccess', _88 => _88.format])==="GR"?"#,##0.000":void 0}}),c=r.addRow(E.map(a=>a.value));E.forEach((a,f)=>{let C=c.getCell(f+1),u=["center","right","left","fill","justify","centerContinuous","distributed"],x=["top","middle","bottom","distributed","justify"],b,k;a.alignment&&typeof a.alignment.horizontal=="string"&&u.includes(a.alignment.horizontal)&&(b=a.alignment.horizontal),a.alignment&&"vertical"in a.alignment&&typeof a.alignment.vertical=="string"&&x.includes(a.alignment.vertical)&&(k=a.alignment.vertical),C.alignment={...b?{horizontal:b}:{},...k?{vertical:k}:{}},a.numFmt&&typeof a.value=="number"&&!isNaN(a.value)&&(C.value=Number(a.value),C.numFmt=a.numFmt)}),await O(g,r,c,E)}});let w=r.addRow(l.map(()=>null));N(l).forEach((e,d)=>{if(_optionalChain([e, 'optionalAccess', _89 => _89.options, 'optionalAccess', _90 => _90.format])==="RP"||_optionalChain([e, 'optionalAccess', _91 => _91.options, 'optionalAccess', _92 => _92.format])==="GR"||_optionalChain([e, 'optionalAccess', _93 => _93.options, 'optionalAccess', _94 => _94.format])==="NUMBER"){let c=i.length+4-1,a=`SUM(${String.fromCharCode(65+d)}4:${String.fromCharCode(65+d)}${c})`,f=w.getCell(d+1),C=_optionalChain([p, 'optionalAccess', _95 => _95.grandTotal, 'optionalAccess', _96 => _96.enableCount])?m.length>0?" : "+i.map(b=>b.detail.length).reduce((b,k)=>b+k,0):" : "+i.length:"",u=_optionalChain([p, 'optionalAccess', _97 => _97.grandTotal, 'optionalAccess', _98 => _98.captionItem])?_optionalChain([p, 'optionalAccess', _99 => _99.grandTotal, 'optionalAccess', _100 => _100.captionItem]):"",x=`${_optionalChain([p, 'optionalAccess', _101 => _101.grandTotal, 'optionalAccess', _102 => _102.caption])||"GRAND TOTAL"} ${C} ${u}`;w.getCell(1).value=x,w.getCell(1).alignment={horizontal:"center"},f.numFmt=_optionalChain([e, 'optionalAccess', _103 => _103.options, 'optionalAccess', _104 => _104.format])==="GR"?"#,##0.000":"#,##0",f.value={formula:a},w.getCell(d+1).value=_optionalChain([e, 'optionalAccess', _105 => _105.options, 'access', _106 => _106.disabledFooter])?"":y[e.key]}else w.getCell(d+1).value=""}),_optionalChain([n, 'optionalAccess', _107 => _107.grandTotalSetting, 'optionalAccess', _108 => _108.colSpan])&&r.mergeCells(`A${w.number}:${String.fromCharCode(64+Number(_optionalChain([n, 'optionalAccess', _109 => _109.grandTotalSetting, 'optionalAccess', _110 => _110.colSpan])))}${w.number}`),w.eachCell(e=>{e.fill={type:"pattern",pattern:"solid",fgColor:{argb:_optionalChain([n, 'optionalAccess', _111 => _111.bgColor])||"#E8E5E5"},bgColor:{argb:_optionalChain([n, 'optionalAccess', _112 => _112.bgColor])||"#E8E5E5"}},e.font={color:{argb:_optionalChain([n, 'optionalAccess', _113 => _113.txtColor])},bold:!0}}),_optionalChain([n, 'optionalAccess', _114 => _114.customize])&&n.customize(r);let B=await g.xlsx.writeBuffer(),S=new Blob([B],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),o=document.createElement("a");o.href=URL.createObjectURL(S),o.download=`${_optionalChain([n, 'optionalAccess', _115 => _115.titleExcel])||h}.xlsx`,document.body.appendChild(o),o.click(),document.body.removeChild(o)},X=tt;var _jspdf = require('jspdf'); var _jspdf2 = _interopRequireDefault(_jspdf);var _jspdfautotable = require('jspdf-autotable'); var _jspdfautotable2 = _interopRequireDefault(_jspdfautotable);var ot=({columns:l,data:i,grouping:m,pdfSetting:t,date:n,title:h,footerSetting:p})=>{let g=new (0, _jspdf2.default)(_optionalChain([t, 'optionalAccess', _116 => _116.orientation]),_optionalChain([t, 'optionalAccess', _117 => _117.unit]),[_optionalChain([t, 'optionalAccess', _118 => _118.width])||297,_optionalChain([t, 'optionalAccess', _119 => _119.height])||210]),r=[],I=n?30:20;l=l.filter(o=>!_optionalChain([o, 'access', _120 => _120.options, 'optionalAccess', _121 => _121.disabledColumn])),g.setFontSize(10);let G=g.internal.pageSize.getWidth(),F=g.splitTextToSize(_optionalChain([t, 'optionalAccess', _122 => _122.textHeaderLeft])||"",110);g.text(F,15,18),g.text(`${h||_optionalChain([t, 'optionalAccess', _123 => _123.titlePdf])}`,G-15,18,{align:"right"}),n&&g.text(`${n.caption?n.caption:"TANGGAL "} : ${_optionalChain([n, 'optionalAccess', _124 => _124.start_date])} ${_optionalChain([n, 'optionalAccess', _125 => _125.end_date])?`s/d ${_optionalChain([n, 'optionalAccess', _126 => _126.end_date])}`:""}`,G-15,22,{align:"right"}),g.setProperties({title:h||_optionalChain([t, 'optionalAccess', _127 => _127.titlePdf])}),_optionalChain([t, 'optionalAccess', _128 => _128.finalY])&&(console.log(t.finalY),I=t.finalY);let z=[],L=[],R=l.some(o=>o.child&&o.child.length>0);l.forEach(o=>{let e={textColor:`#${_optionalChain([t, 'optionalAccess', _129 => _129.txtColor])||"000"}`,fillColor:`#${_optionalChain([t, 'optionalAccess', _130 => _130.bgColor])||"E8E5E5"}`,fontStyle:"bold",..._optionalChain([o, 'optionalAccess', _131 => _131.options, 'optionalAccess', _132 => _132.valign])?{valign:o.options.valign}:{},halign:_nullishCoalesce(_optionalChain([o, 'optionalAccess', _133 => _133.options, 'optionalAccess', _134 => _134.halign]), () => ((["RP","GR","NUMBER"].includes(_optionalChain([o, 'optionalAccess', _135 => _135.options, 'optionalAccess', _136 => _136.format])||"")?"right":"left")))};R?o.child&&o.child.length>0?(z.push({content:o.label,colSpan:o.child.length,styles:e}),o.child.forEach(d=>{L.push({content:d.label,key:d.key,options:d.options,styles:{...e,halign:_nullishCoalesce(_optionalChain([d, 'optionalAccess', _137 => _137.options, 'optionalAccess', _138 => _138.halign]), () => ((["RP","GR","NUMBER"].includes(_optionalChain([d, 'optionalAccess', _139 => _139.options, 'optionalAccess', _140 => _140.format])||"")?"right":"left")))}})})):z.push({content:o.label,rowSpan:2,key:o.key,options:o.options,styles:e}):z.push({content:o.label,key:o.key,options:o.options,styles:e})}),r.push(z),R&&L.length>0&&r.push(L);let $={};i.forEach(o=>{if(m.length>0){let e=M(l),E=[{content:m.map(b=>o[b]!==void 0?`${j(b)} : ${o[b]}`:"").filter(Boolean).join("  |  "),colSpan:e,styles:{fontStyle:"bold",halign:"left"}}];r.push(E);let c={},a=N(l);o.detail.forEach(b=>{let k=a.map(s=>{let T=b[s.key],v=s.key;$[v]=($[v]||0)+Number(T||0),c[v]=(c[v]||0)+Number(T||0);let P=_optionalChain([s, 'access', _141 => _141.options, 'optionalAccess', _142 => _142.format])==="IMAGE";return{content:(()=>{switch(_optionalChain([s, 'optionalAccess', _143 => _143.options, 'optionalAccess', _144 => _144.format])){case"RP":return T!==void 0?Number(T||0).toLocaleString("kr-ko"):"";case"GR":return T!==void 0?Number(T||0).toFixed(3):"";case"NUMBER":return T!==void 0?Number(T||0):"";case"IMAGE":return"";case"DATETIME":return T!==void 0?D(T||new Date):"";default:return T!==void 0?T.toString():""}})(),foto:P?T:null,styles:{halign:_optionalChain([s, 'optionalAccess', _145 => _145.options, 'optionalAccess', _146 => _146.halign])?_optionalChain([s, 'optionalAccess', _147 => _147.options, 'optionalAccess', _148 => _148.halign]):_optionalChain([s, 'optionalAccess', _149 => _149.options, 'optionalAccess', _150 => _150.format])==="RP"||_optionalChain([s, 'optionalAccess', _151 => _151.options, 'optionalAccess', _152 => _152.format])==="GR"||_optionalChain([s, 'optionalAccess', _153 => _153.options, 'optionalAccess', _154 => _154.format])==="NUMBER"||typeof T=="number"?"right":"left"}}});r.push(k)});let f=[];a.forEach(b=>{let k=c[b.key];_optionalChain([b, 'optionalAccess', _155 => _155.options, 'optionalAccess', _156 => _156.format])==="RP"||_optionalChain([b, 'optionalAccess', _157 => _157.options, 'optionalAccess', _158 => _158.format])==="GR"||_optionalChain([b, 'optionalAccess', _159 => _159.options, 'optionalAccess', _160 => _160.format])==="NUMBER"?f.push({content:_optionalChain([b, 'optionalAccess', _161 => _161.options, 'optionalAccess', _162 => _162.disabledFooter])?"":(()=>{switch(_optionalChain([b, 'optionalAccess', _163 => _163.options, 'optionalAccess', _164 => _164.format])){case"RP":return k.toLocaleString("kr-ko");case"GR":return k.toFixed(3);case"NUMBER":return k;default:return k.toString()}})(),styles:{halign:_optionalChain([b, 'optionalAccess', _165 => _165.options, 'optionalAccess', _166 => _166.halign])||"right",textColor:`#${_optionalChain([t, 'optionalAccess', _167 => _167.txtColor])||"000"}`,fillColor:`#${_optionalChain([t, 'optionalAccess', _168 => _168.bgColor])||"E8E5E5"}`,fontStyle:"bold"}}):f.push({content:"",styles:{textColor:`#${_optionalChain([t, 'optionalAccess', _169 => _169.txtColor])||"000"}`,fillColor:`#${_optionalChain([t, 'optionalAccess', _170 => _170.bgColor])||"E8E5E5"}`,fontStyle:"bold"}})});let C=_optionalChain([t, 'optionalAccess', _171 => _171.grandTotalSetting, 'optionalAccess', _172 => _172.colSpan])?Number(_optionalChain([t, 'optionalAccess', _173 => _173.grandTotalSetting, 'optionalAccess', _174 => _174.colSpan])||0)+1:0,u=_optionalChain([p, 'optionalAccess', _175 => _175.subTotal, 'optionalAccess', _176 => _176.enableCount])&&m.length>0?" : "+o.detail.length:"",x=_optionalChain([p, 'optionalAccess', _177 => _177.subTotal, 'optionalAccess', _178 => _178.captionItem])?_optionalChain([p, 'optionalAccess', _179 => _179.subTotal, 'optionalAccess', _180 => _180.captionItem]):"";f[0]={content:`${_optionalChain([p, 'optionalAccess', _181 => _181.subTotal, 'optionalAccess', _182 => _182.caption])||"SUB TOTAL"}${u} ${x}`,colSpan:C,styles:{textColor:`#${_optionalChain([t, 'optionalAccess', _183 => _183.txtColor])||"000"}`,fillColor:`#${_optionalChain([t, 'optionalAccess', _184 => _184.bgColor])||"E8E5E5"}`,fontStyle:"bold",halign:"center"}},_optionalChain([t, 'optionalAccess', _185 => _185.grandTotalSetting, 'optionalAccess', _186 => _186.colSpan])&&f.splice(1,_optionalChain([t, 'optionalAccess', _187 => _187.grandTotalSetting, 'optionalAccess', _188 => _188.colSpan])),r.push(f)}else{let e=(c,a)=>{let f=a[c.key],C=c.key;_optionalChain([c, 'access', _189 => _189.options, 'optionalAccess', _190 => _190.disabledFooter])||($[C]=($[C]||0)+Number(f||0));let u=(()=>{switch(_optionalChain([c, 'optionalAccess', _191 => _191.options, 'optionalAccess', _192 => _192.format])){case"RP":return f!==void 0?Number(f||0).toLocaleString("kr-ko"):"";case"GR":return f!==void 0?Number(f||0).toFixed(3):"";case"NUMBER":return f!==void 0?Number(f||0):"";case"IMAGE":return"";case"DATETIME":return f!==void 0?D(f||new Date):"";default:return f!==void 0?_optionalChain([f, 'optionalAccess', _193 => _193.toString, 'call', _194 => _194()]):""}})(),x=_optionalChain([c, 'optionalAccess', _195 => _195.options, 'optionalAccess', _196 => _196.halign])?_optionalChain([c, 'optionalAccess', _197 => _197.options, 'optionalAccess', _198 => _198.halign]):_optionalChain([c, 'optionalAccess', _199 => _199.options, 'optionalAccess', _200 => _200.format])==="RP"||_optionalChain([c, 'optionalAccess', _201 => _201.options, 'optionalAccess', _202 => _202.format])==="GR"||_optionalChain([c, 'optionalAccess', _203 => _203.options, 'optionalAccess', _204 => _204.format])==="NUMBER"||typeof f=="number"?"right":"left",b=_optionalChain([c, 'access', _205 => _205.options, 'optionalAccess', _206 => _206.format])==="IMAGE";return{options:_optionalChain([c, 'optionalAccess', _207 => _207.options]),content:u,foto:b?f:null,styles:{halign:x}}},E=N(l).map(c=>e(c,o));r.push(E)}});let y=N(l),w=[];if(y.forEach(o=>{let e=$[o.key],d=["RP","GR","NUMBER"].includes(_optionalChain([o, 'optionalAccess', _208 => _208.options, 'optionalAccess', _209 => _209.format])||""),E=_optionalChain([o, 'optionalAccess', _210 => _210.options, 'optionalAccess', _211 => _211.disabledFooter])?"":(()=>{if(!d)return"";switch(_optionalChain([o, 'access', _212 => _212.options, 'optionalAccess', _213 => _213.format])){case"RP":return Number(e||0).toLocaleString("kr-KO");case"GR":return Number(e||0).toFixed(3);case"NUMBER":return Number(e||0);default:return(e||0).toString()}})();w.push({options:_optionalChain([o, 'optionalAccess', _214 => _214.options]),content:E,styles:{halign:_optionalChain([o, 'optionalAccess', _215 => _215.options, 'optionalAccess', _216 => _216.halign])?o.options.halign:d?"right":"left",textColor:`#${_optionalChain([t, 'optionalAccess', _217 => _217.txtColor])||"000"}`,fillColor:`#${_optionalChain([t, 'optionalAccess', _218 => _218.bgColor])||"E8E5E5"}`,fontStyle:"bold"}})}),!_optionalChain([t, 'optionalAccess', _219 => _219.grandTotalSetting, 'optionalAccess', _220 => _220.disableGrandTotal])){let o=Number(_optionalChain([t, 'optionalAccess', _221 => _221.grandTotalSetting, 'optionalAccess', _222 => _222.colSpan])||0),e=Math.min(o+1,y.length),d=_optionalChain([p, 'optionalAccess', _223 => _223.grandTotal, 'optionalAccess', _224 => _224.enableCount])?m.length>0?i.reduce((a,f)=>a+f.detail.length,0):i.length:0,E=_optionalChain([p, 'optionalAccess', _225 => _225.grandTotal, 'optionalAccess', _226 => _226.captionItem])||"",c=`${_optionalChain([p, 'optionalAccess', _227 => _227.grandTotal, 'optionalAccess', _228 => _228.caption])||"GRAND TOTAL"}`+(d?` : ${d}`:"")+(E?` ${E}`:"");for(w[0]={content:c,colSpan:e,styles:{textColor:`#${_optionalChain([t, 'optionalAccess', _229 => _229.txtColor])||"000"}`,fillColor:`#${_optionalChain([t, 'optionalAccess', _230 => _230.bgColor])||"E8E5E5"}`,fontStyle:"bold",halign:"center"}},w.splice(1,e-1);w.length<y.length;)w.push({content:"",styles:{textColor:`#${_optionalChain([t, 'optionalAccess', _231 => _231.txtColor])||"000"}`,fillColor:`#${_optionalChain([t, 'optionalAccess', _232 => _232.bgColor])||"E8E5E5"}`,fontStyle:"bold"}});r.push(w)}if(typeof _optionalChain([t, 'optionalAccess', _233 => _233.addRow])=="function"&&_optionalChain([t, 'optionalAccess', _234 => _234.addRow, 'call', _235 => _235(r)]),!_optionalChain([t, 'optionalAccess', _236 => _236.disablePrintDate])){let o=M(l);r.push([{content:`Print Date : ${D(`${new Date}`)}`,colSpan:o,styles:{textColor:`#${_optionalChain([t, 'optionalAccess', _237 => _237.txtColor])||"000"}`,fillColor:`#${_optionalChain([t, 'optionalAccess', _238 => _238.bgColor])||"E8E5E5"}`,fontStyle:"italic"}}])}_jspdfautotable2.default.call(void 0, g,{head:[],body:r,startY:I,theme:_optionalChain([t, 'optionalAccess', _239 => _239.theme])||"plain",rowPageBreak:"avoid",margin:{top:10},bodyStyles:{fontSize:_optionalChain([t, 'optionalAccess', _240 => _240.fontSIze])||8},headStyles:{fontSize:_optionalChain([t, 'optionalAccess', _241 => _241.fontSIze])||8,textColor:`#${_optionalChain([t, 'optionalAccess', _242 => _242.txtColor])||"000"}`,fillColor:`#${_optionalChain([t, 'optionalAccess', _243 => _243.bgColor])||"E8E5E5"}`},tableLineColor:[255,255,255],didParseCell:function(o){let e=o.column.index;_optionalChain([y, 'access', _244 => _244[e], 'optionalAccess', _245 => _245.options, 'optionalAccess', _246 => _246.format])==="IMAGE"&&o.cell.raw&&o.cell.raw.foto&&(o.row.height=20,o.cell.styles.valign="middle",o.cell.styles.halign="center")},didDrawCell:function(o){let{cell:e}=o,E=(e.raw||{}).foto,c=o.column.index;if(_optionalChain([y, 'access', _247 => _247[c], 'optionalAccess', _248 => _248.options, 'optionalAccess', _249 => _249.format])==="IMAGE"&&E){let C=e.x+(e.width-15)/2,u=e.y+(e.height-15)/2;try{g.addImage(E,"JPG",C,u,15,15)}catch(x){console.warn("\u274C Gagal render gambar:",x)}}}}),r=[],I=g.lastAutoTable.finalY;let A=g.internal.getNumberOfPages(),B=g.internal.pageSize.width,S=g.internal.pageSize.height;g.setFontSize(10);for(let o=1;o<A+1;o++){let e=B/2,d=S-10;g.setPage(o),g.text(`${o} of ${A}`,e,d,{align:"center"})}if(typeof _optionalChain([t, 'optionalAccess', _250 => _250.customize])=="function"&&t.customize(g,I,_jspdfautotable2.default),_optionalChain([t, 'optionalAccess', _251 => _251.openNewTab])){let o=g.output("bloburl");window.open(o)}else g.save(`${_optionalChain([t, 'optionalAccess', _252 => _252.titlePdf])||h}.pdf`)},V=ot;var nt=l=>{let i=[],m=l.copy?2:1;for(let t=0;t<m;t++){let n=l.data.map(h=>{let p=l.template;for(;/\n!!LOOP\((.+)\)(\{\n(.*\n)+\})\n/gm.exec(p);)p=p.replace(/\n!!LOOP\((.+)\)(\{\n(.*\n)+\})\n/,(g,r,I)=>{let G=I.replace(/^\{/,"").replace(/\}$/,"");return(Array.isArray(h[r])?h[r]:[h[r]]).reduce((L,R)=>L+G.replace(/\{([a-z0-9_]+)\}/gm,$=>{let y=$.replace(/(\{|\})/g,"");if(y.match(/nama_barang/)){let w=y.match(/nama_barang/),A=y==="nama_barang2"?[20,40]:y==="nama_barang3"?[40,60]:[0,20];return _optionalChain([R, 'access', _253 => _253[w], 'optionalAccess', _254 => _254.slice, 'call', _255 => _255(...A), 'access', _256 => _256.trim, 'call', _257 => _257()])||""}if(y.match(/deskripsi_jual/)){let w=y.match(/deskripsi_jual/),A=y==="deskripsi_jual2"?[20,40]:y==="deskripsi_jual3"?[40,60]:[0,20];return _optionalChain([R, 'access', _258 => _258[w], 'optionalAccess', _259 => _259.slice, 'call', _260 => _260(...A), 'access', _261 => _261.trim, 'call', _262 => _262()])||""}if(y.match(/deskripsi/)){let w=y.match(/deskripsi/),A=y==="deskripsi2"?[20,40]:y==="deskripsi3"?[40,60]:[0,20];return _optionalChain([R, 'access', _263 => _263[w], 'optionalAccess', _264 => _264.slice, 'call', _265 => _265(...A), 'access', _266 => _266.trim, 'call', _267 => _267()])||""}return R[y]||""}),"").replace(/\n(\s)+\n/gm,`
`)});return p.replace(/\{([a-z0-9_]+)\}/gm,g=>{let r=g.replace(/(\{|\})/g,"");return r.match(/auto_cut/)?`
VA`:h[r]||""}).replace(/\n(\s)+\n/gm,`
`).replace(/~new_line~/gm,`
`).replace(/!!LOOP\(detail\)/g,"").replace(/[}{]/g,"")});for(let h in n)n[h]+=`

`;i.push(...n)}return i},at=async(l,i)=>{let m=nt(l),t=new Blob([_optionalChain([m, 'optionalAccess', _268 => _268.join, 'call', _269 => _269(`
`)])||""],{type:"text/plain"}),n=document.createElement("a");n.href=URL.createObjectURL(t),n.download=i,document.body.appendChild(n),n.click(),document.body.removeChild(n)},Y=at;var $t=({columns:l,data:i,grouping:m,date:t,type:n,txtSetting:h,pdfSetting:p,excelSetting:g,title:r,footerSetting:I})=>{let G={data:[_optionalChain([h, 'optionalAccess', _270 => _270.dataTxt])],template:_optionalChain([h, 'optionalAccess', _271 => _271.templateTxt]),copy:_optionalChain([h, 'optionalAccess', _272 => _272.copy])};if(i.length===0)throw new Error("Data is required");if(n.length===0)throw new Error("Type is required");if(!W(n))throw new Error('Type Export must use ["EXCEL", "PDF", "TXT", "ALL"]');n.forEach(F=>{F==="PDF"?V({pdfSetting:p,date:t,data:i,type:n,columns:l,grouping:m,title:r,footerSetting:I}):F==="TXT"?Y(G,_optionalChain([h, 'optionalAccess', _273 => _273.titleTxt])||""):F==="EXCEL"?X({date:t,data:i,type:n,columns:l,grouping:m,excelSetting:g,title:r,footerSetting:I}):(X({date:t,data:i,type:n,columns:l,grouping:m,excelSetting:g,title:r}),V({pdfSetting:p,date:t,data:i,type:n,columns:l,grouping:m,title:r}),Y(G,_optionalChain([h, 'optionalAccess', _274 => _274.titleTxt])||""))})};exports.ExportData = $t;
//# sourceMappingURL=index.js.map