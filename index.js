"use strict";Object.defineProperty(exports, "__esModule", {value: true}); function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; } function _nullishCoalesce(lhs, rhsFn) { if (lhs != null) { return lhs; } else { return rhsFn(); } } function _optionalChain(ops) { let lastAccessLHS = undefined; let value = ops[0]; let i = 1; while (i < ops.length) { const op = ops[i]; const fn = ops[i + 1]; i += 2; if ((op === 'optionalAccess' || op === 'optionalCall') && value == null) { return undefined; } if (op === 'access' || op === 'optionalAccess') { lastAccessLHS = value; value = fn(value); } else if (op === 'call' || op === 'optionalCall') { value = fn((...args) => value.call(lastAccessLHS, ...args)); lastAccessLHS = undefined; } } return value; }var X=["EXCEL","PDF","TXT","ALL"];function N(d){let c=new Date(d),m=c.getFullYear(),e=String(c.getMonth()+1).padStart(2,"0"),n=String(c.getDate()).padStart(2,"0"),h=String(c.getHours()).padStart(2,"0"),p=String(c.getMinutes()).padStart(2,"0"),g=String(c.getSeconds()).padStart(2,"0");return`${n}-${e}-${m} ${h}:${p}:${g}`}function V(d){return d.every(c=>X.includes(c))}function A(d){let c=0;return d.forEach(m=>{m.child&&m.child.length>0?c+=A(m.child):c+=1}),c}var z=d=>{let c=[];return d.forEach(m=>{m.child&&m.child.length>0?c.push(...z(m.child)):c.push(m)}),c},D=d=>d.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ");async function S(d,c,m,e){for(let n=0;n<e.length;n++){let h=e[n];if(_optionalChain([h, 'optionalAccess', _2 => _2.isImage])&&_optionalChain([h, 'optionalAccess', _3 => _3.imageSrc])&&typeof h.imageSrc=="string"&&h.imageSrc.startsWith("data:image"))try{let{buffer:p,extension:g}=J(h.imageSrc),l=d.addImage({buffer:p,extension:g});c.addImage(l,{tl:{col:n,row:m.number-1},ext:{width:70,height:60},editAs:"oneCell"}),(!m.height||m.height<60)&&(m.height=35)}catch(p){console.error("\u274C Error adding image to row:",p),m.getCell(n+1).value="[Image]"}}}function J(d){let c=d.match(/^data:image\/(\w+);base64,(.*)$/);if(!c)throw new Error("Invalid base64 image format");let m=c[1]==="jpg"?"jpeg":c[1],e=c[2],n=atob(e),h=n.length,p=new Uint8Array(h);for(let g=0;g<h;g++)p[g]=n.charCodeAt(g);return{buffer:p,extension:m}}var _exceljs = require('exceljs'); var _exceljs2 = _interopRequireDefault(_exceljs);var K=async({columns:d,data:c,grouping:m,date:e,excelSetting:n,title:h,footerSetting:p})=>{let g=new _exceljs2.default.Workbook;d=d.filter(o=>!_optionalChain([o, 'access', _4 => _4.options, 'optionalAccess', _5 => _5.disabledColumn]));let l=g.addWorksheet(h||_optionalChain([n, 'optionalAccess', _6 => _6.titleExcel])),$=A(d),k=l.addRow([]);k.getCell(1).value=h||_optionalChain([n, 'optionalAccess', _7 => _7.titleExcel]),k.getCell(1).alignment={horizontal:"center"};let I=l.getColumn($).letter;if(l.mergeCells(`A${k.number}:${I}${k.number}`),k.eachCell(o=>{o.font={color:{argb:"000000"},bold:!0,size:12}}),e){let o=l.addRow([]);o.getCell(1).value=`${e.caption?e.caption:"Tanggal "} : ${_optionalChain([e, 'optionalAccess', _8 => _8.start_date])} ${_optionalChain([e, 'optionalAccess', _9 => _9.end_date])?`s/d ${_optionalChain([e, 'optionalAccess', _10 => _10.end_date])}`:""}`,o.getCell(1).alignment={horizontal:"center"},l.mergeCells(`A${o.number}:${I}${o.number}`),o.eachCell(f=>{f.font={color:{argb:"00000"},bold:!0,size:12}})}let v=l.addRow([]);v.getCell(1).value=_optionalChain([n, 'optionalAccess', _11 => _11.additionalTextHeader])||"",v.getCell(1).alignment={horizontal:"center"},l.mergeCells(`A${v.number}:${I}${v.number}`),v.eachCell(o=>{o.font={color:{argb:"000000"},bold:!0,size:12}});let P=d.some(o=>o.child&&o.child.length>0),E=l.addRow([]),G=P?l.addRow([]):null;d.forEach(o=>{if(o.child&&o.child.length>0){let f=E.actualCellCount+1,u=o.child.length;E.getCell(f).value=o.label,u>1&&l.mergeCells(E.number,f,E.number,f+u-1);for(let i=f;i<f+u;i++){let t=E.getCell(i);t.fill={type:"pattern",pattern:"solid",fgColor:{argb:_optionalChain([n, 'optionalAccess', _12 => _12.bgColor])||"E8E5E5"}},t.font={color:{argb:_optionalChain([n, 'optionalAccess', _13 => _13.txtColor])||"000000"},bold:!0},t.alignment={horizontal:"center",vertical:"middle"}}o.child.forEach((i,t)=>{if(G){let r=G.getCell(f+t);r.value=i.label,r.fill={type:"pattern",pattern:"solid",fgColor:{argb:_optionalChain([n, 'optionalAccess', _14 => _14.bgColor])||"E8E5E5"}},r.font={color:{argb:_optionalChain([n, 'optionalAccess', _15 => _15.txtColor])||"000000"},bold:!0};let b=_optionalChain([i, 'access', _16 => _16.options, 'optionalAccess', _17 => _17.halign])||(["RP","GR","NUMBER"].includes(_optionalChain([i, 'optionalAccess', _18 => _18.options, 'optionalAccess', _19 => _19.format])||"")?"right":"left"),s=_optionalChain([i, 'access', _20 => _20.options, 'optionalAccess', _21 => _21.valign])||"middle";r.alignment={horizontal:b,vertical:s}}})}else{let f=E.actualCellCount+1;E.getCell(f).value=o.label,E.getCell(f).fill={type:"pattern",pattern:"solid",fgColor:{argb:_optionalChain([n, 'optionalAccess', _22 => _22.bgColor])||"E8E5E5"}},E.getCell(f).font={color:{argb:_optionalChain([n, 'optionalAccess', _23 => _23.txtColor])||"000000"},bold:!0},E.getCell(f).alignment={horizontal:_optionalChain([o, 'access', _24 => _24.options, 'optionalAccess', _25 => _25.halign])||"center",vertical:_optionalChain([o, 'access', _26 => _26.options, 'optionalAccess', _27 => _27.valign])||"middle"},P&&G&&l.mergeCells(E.number,f,G.number,f)}});let C={};c.forEach(async o=>{if(o.detail.length>0){if(m.length>0){let i=A(d),t=m.map(b=>o[b]!==void 0||o[b]!==null?`${D(b)} : ${o[b]}`:"").filter(Boolean).join("  |  "),r=l.addRow([t]);l.mergeCells(`A${r.number}:${String.fromCharCode(64+i)}${r.number}`),r.getCell(1).alignment={horizontal:"left"},r.getCell(1).font={bold:!0}}let f={};o.detail.forEach(async i=>{let r=z(d).map(s=>{if(_optionalChain([s, 'optionalAccess', _28 => _28.options, 'optionalAccess', _29 => _29.format])==="IMAGE"&&i[s.key])return{value:"",alignment:{horizontal:"center",vertical:"middle"},isImage:!0,imageSrc:i[s.key]};let x=_optionalChain([s, 'optionalAccess', _30 => _30.options, 'optionalAccess', _31 => _31.format])==="DATETIME"?N(i[s.key]):i[s.key],w={horizontal:_optionalChain([s, 'optionalAccess', _32 => _32.options, 'optionalAccess', _33 => _33.halign])?_optionalChain([s, 'optionalAccess', _34 => _34.options, 'optionalAccess', _35 => _35.halign]):_optionalChain([s, 'optionalAccess', _36 => _36.options, 'optionalAccess', _37 => _37.format])==="RP"||_optionalChain([s, 'optionalAccess', _38 => _38.options, 'optionalAccess', _39 => _39.format])==="GR"||_optionalChain([s, 'optionalAccess', _40 => _40.options, 'optionalAccess', _41 => _41.format])==="NUMBER"?"right":"left"},R=s.key;return C[R]=(C[R]||0)+Number(x),f[R]=(f[R]||0)+Number(x),{value:x,alignment:w,numFmt:_optionalChain([s, 'optionalAccess', _42 => _42.options, 'optionalAccess', _43 => _43.format])==="RP"?"#,##0":_optionalChain([s, 'optionalAccess', _44 => _44.options, 'optionalAccess', _45 => _45.format])==="GR"?"#,##0.000":void 0}}),b=l.addRow(r.map(s=>s.value));r.forEach((s,x)=>{let w=b.getCell(x+1),R=["center","right","left","fill","justify","centerContinuous","distributed"],U=["top","middle","bottom","distributed","justify"],j,B;s.alignment&&typeof s.alignment.horizontal=="string"&&R.includes(s.alignment.horizontal)&&(j=s.alignment.horizontal),s.alignment&&"vertical"in s.alignment&&typeof s.alignment.vertical=="string"&&U.includes(s.alignment.vertical)&&(B=s.alignment.vertical),w.alignment={...j?{horizontal:j}:{},...B?{vertical:B}:{}},s.numFmt&&typeof s.value=="number"&&!isNaN(s.value)&&(w.value=Number(s.value),w.numFmt=s.numFmt)}),await S(g,l,b,r)});let u=z(d);if(!_optionalChain([p, 'optionalAccess', _46 => _46.subTotal, 'optionalAccess', _47 => _47.disableSubtotal])){let i=l.addRow(d.map(()=>null));u.forEach((t,r)=>{if(_optionalChain([t, 'optionalAccess', _48 => _48.options, 'optionalAccess', _49 => _49.format])==="RP"||_optionalChain([t, 'optionalAccess', _50 => _50.options, 'optionalAccess', _51 => _51.format])==="GR"||_optionalChain([t, 'optionalAccess', _52 => _52.options, 'optionalAccess', _53 => _53.format])==="NUMBER"){let s=c.length+4-1,x=`SUM(${String.fromCharCode(65+r)}4:${String.fromCharCode(65+r)}${s})`,w=i.getCell(r+1),R=_optionalChain([p, 'optionalAccess', _54 => _54.subTotal, 'optionalAccess', _55 => _55.enableCount])&&m.length>0?" : "+o.detail.length:"",U=_optionalChain([p, 'optionalAccess', _56 => _56.subTotal, 'optionalAccess', _57 => _57.captionItem])?_optionalChain([p, 'optionalAccess', _58 => _58.subTotal, 'optionalAccess', _59 => _59.captionItem]):"";i.getCell(1).value=`${_optionalChain([p, 'optionalAccess', _60 => _60.subTotal, 'optionalAccess', _61 => _61.caption])||"SUB TOTAL"} ${R} ${U}`,i.getCell(1).alignment={horizontal:"center"},w.numFmt=_optionalChain([t, 'optionalAccess', _62 => _62.options, 'optionalAccess', _63 => _63.format])==="GR"?"#,##0.000":"#,##0",w.value={formula:x},i.getCell(r+1).value=_optionalChain([t, 'optionalAccess', _64 => _64.options, 'access', _65 => _65.disabledFooter])?"":f[t.key]}else i.getCell(r+1).value=""}),_optionalChain([n, 'optionalAccess', _66 => _66.grandTotalSetting, 'optionalAccess', _67 => _67.colSpan])&&l.mergeCells(`A${i.number}:${String.fromCharCode(64+Number(_optionalChain([n, 'optionalAccess', _68 => _68.grandTotalSetting, 'optionalAccess', _69 => _69.colSpan])))}${i.number}`),i.eachCell(t=>{t.fill={type:"pattern",pattern:"solid",fgColor:{argb:_optionalChain([n, 'optionalAccess', _70 => _70.bgColor])||"#E8E5E5"},bgColor:{argb:_optionalChain([n, 'optionalAccess', _71 => _71.bgColor])||"#E8E5E5"}},t.font={color:{argb:_optionalChain([n, 'optionalAccess', _72 => _72.txtColor])},bold:!0}})}}else{let u=z(d).map(t=>{if(_optionalChain([t, 'optionalAccess', _73 => _73.options, 'optionalAccess', _74 => _74.format])==="IMAGE"&&o[t.key])return{value:"",alignment:{horizontal:"center",vertical:"middle"},isImage:!0,imageSrc:o[t.key]};let r=_optionalChain([t, 'optionalAccess', _75 => _75.options, 'optionalAccess', _76 => _76.format])==="DATETIME"?N(o[t.key]):o[t.key],b={horizontal:_optionalChain([t, 'optionalAccess', _77 => _77.options, 'optionalAccess', _78 => _78.halign])?_optionalChain([t, 'optionalAccess', _79 => _79.options, 'optionalAccess', _80 => _80.halign]):_optionalChain([t, 'optionalAccess', _81 => _81.options, 'optionalAccess', _82 => _82.format])==="RP"||_optionalChain([t, 'optionalAccess', _83 => _83.options, 'optionalAccess', _84 => _84.format])==="GR"||_optionalChain([t, 'optionalAccess', _85 => _85.options, 'optionalAccess', _86 => _86.format])==="NUMBER"?"right":"left"},s=t.key;return C[s]=(C[s]||0)+Number(r),{value:r,alignment:b,numFmt:_optionalChain([t, 'optionalAccess', _87 => _87.options, 'optionalAccess', _88 => _88.format])==="RP"?"#,##0":_optionalChain([t, 'optionalAccess', _89 => _89.options, 'optionalAccess', _90 => _90.format])==="GR"?"#,##0.000":void 0}}),i=l.addRow(u.map(t=>t.value));u.forEach((t,r)=>{let b=i.getCell(r+1),s=["center","right","left","fill","justify","centerContinuous","distributed"],x=["top","middle","bottom","distributed","justify"],w,R;t.alignment&&typeof t.alignment.horizontal=="string"&&s.includes(t.alignment.horizontal)&&(w=t.alignment.horizontal),t.alignment&&"vertical"in t.alignment&&typeof t.alignment.vertical=="string"&&x.includes(t.alignment.vertical)&&(R=t.alignment.vertical),b.alignment={...w?{horizontal:w}:{},...R?{vertical:R}:{}},t.numFmt&&typeof t.value=="number"&&!isNaN(t.value)&&(b.value=Number(t.value),b.numFmt=t.numFmt)}),await S(g,l,i,u)}});let T=l.addRow(d.map(()=>null)),F=z(d);_optionalChain([p, 'optionalAccess', _91 => _91.grandTotal, 'optionalAccess', _92 => _92.disableGrandTotal])||(F.forEach((o,f)=>{if(_optionalChain([o, 'optionalAccess', _93 => _93.options, 'optionalAccess', _94 => _94.format])==="RP"||_optionalChain([o, 'optionalAccess', _95 => _95.options, 'optionalAccess', _96 => _96.format])==="GR"||_optionalChain([o, 'optionalAccess', _97 => _97.options, 'optionalAccess', _98 => _98.format])==="NUMBER"){let i=c.length+4-1,t=`SUM(${String.fromCharCode(65+f)}4:${String.fromCharCode(65+f)}${i})`,r=T.getCell(f+1),b=_optionalChain([p, 'optionalAccess', _99 => _99.grandTotal, 'optionalAccess', _100 => _100.enableCount])?m.length>0?" : "+c.map(w=>w.detail.length).reduce((w,R)=>w+R,0):" : "+c.length:"",s=_optionalChain([p, 'optionalAccess', _101 => _101.grandTotal, 'optionalAccess', _102 => _102.captionItem])?_optionalChain([p, 'optionalAccess', _103 => _103.grandTotal, 'optionalAccess', _104 => _104.captionItem]):"",x=`${_optionalChain([p, 'optionalAccess', _105 => _105.grandTotal, 'optionalAccess', _106 => _106.caption])||"GRAND TOTAL"} ${b} ${s}`;T.getCell(1).value=x,T.getCell(1).alignment={horizontal:"center"},r.numFmt=_optionalChain([o, 'optionalAccess', _107 => _107.options, 'optionalAccess', _108 => _108.format])==="GR"?"#,##0.000":"#,##0",r.value={formula:t},T.getCell(f+1).value=_optionalChain([o, 'optionalAccess', _109 => _109.options, 'access', _110 => _110.disabledFooter])?"":C[o.key]}else T.getCell(f+1).value=""}),_optionalChain([n, 'optionalAccess', _111 => _111.grandTotalSetting, 'optionalAccess', _112 => _112.colSpan])&&l.mergeCells(`A${T.number}:${String.fromCharCode(64+Number(_optionalChain([n, 'optionalAccess', _113 => _113.grandTotalSetting, 'optionalAccess', _114 => _114.colSpan])))}${T.number}`),T.eachCell(o=>{o.fill={type:"pattern",pattern:"solid",fgColor:{argb:_optionalChain([n, 'optionalAccess', _115 => _115.bgColor])||"#E8E5E5"},bgColor:{argb:_optionalChain([n, 'optionalAccess', _116 => _116.bgColor])||"#E8E5E5"}},o.font={color:{argb:_optionalChain([n, 'optionalAccess', _117 => _117.txtColor])},bold:!0}})),_optionalChain([n, 'optionalAccess', _118 => _118.customize])&&n.customize(l);let M=await g.xlsx.writeBuffer(),a=new Blob([M],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),y=document.createElement("a");y.href=URL.createObjectURL(a),y.download=`${_optionalChain([n, 'optionalAccess', _119 => _119.titleExcel])||h}.xlsx`,document.body.appendChild(y),y.click(),document.body.removeChild(y)},_=K;var _jspdf = require('jspdf'); var _jspdf2 = _interopRequireDefault(_jspdf);var _jspdfautotable = require('jspdf-autotable'); var _jspdfautotable2 = _interopRequireDefault(_jspdfautotable);var Q=({columns:d,data:c,grouping:m,pdfSetting:e,date:n,title:h,footerSetting:p})=>{let g=new (0, _jspdf2.default)(_optionalChain([e, 'optionalAccess', _120 => _120.orientation]),_optionalChain([e, 'optionalAccess', _121 => _121.unit]),[_optionalChain([e, 'optionalAccess', _122 => _122.width])||297,_optionalChain([e, 'optionalAccess', _123 => _123.height])||210]),l=[],$=n?30:20;d=d.filter(a=>!_optionalChain([a, 'access', _124 => _124.options, 'optionalAccess', _125 => _125.disabledColumn])),g.setFontSize(10);let k=g.internal.pageSize.getWidth(),I=g.splitTextToSize(_optionalChain([e, 'optionalAccess', _126 => _126.textHeaderLeft])||"",110);g.text(I,15,18),g.text(`${h||_optionalChain([e, 'optionalAccess', _127 => _127.titlePdf])}`,k-15,18,{align:"right"}),n&&g.text(`${n.caption?n.caption:"TANGGAL "} : ${_optionalChain([n, 'optionalAccess', _128 => _128.start_date])} ${_optionalChain([n, 'optionalAccess', _129 => _129.end_date])?`s/d ${_optionalChain([n, 'optionalAccess', _130 => _130.end_date])}`:""}`,k-15,22,{align:"right"}),g.setProperties({title:h||_optionalChain([e, 'optionalAccess', _131 => _131.titlePdf])}),_optionalChain([e, 'optionalAccess', _132 => _132.finalY])&&(console.log(e.finalY),$=e.finalY);let v=[],P=[],E=d.some(a=>a.child&&a.child.length>0);d.forEach(a=>{let y={textColor:`#${_optionalChain([e, 'optionalAccess', _133 => _133.txtColor])||"000"}`,fillColor:`#${_optionalChain([e, 'optionalAccess', _134 => _134.bgColor])||"E8E5E5"}`,fontStyle:"bold",..._optionalChain([a, 'optionalAccess', _135 => _135.options, 'optionalAccess', _136 => _136.valign])?{valign:a.options.valign}:{},halign:_nullishCoalesce(_optionalChain([a, 'optionalAccess', _137 => _137.options, 'optionalAccess', _138 => _138.halign]), () => ((["RP","GR","NUMBER"].includes(_optionalChain([a, 'optionalAccess', _139 => _139.options, 'optionalAccess', _140 => _140.format])||"")?"right":"left")))};E?a.child&&a.child.length>0?(v.push({content:a.label,colSpan:a.child.length,styles:y}),a.child.forEach(o=>{P.push({content:o.label,key:o.key,options:o.options,styles:{...y,halign:_nullishCoalesce(_optionalChain([o, 'optionalAccess', _141 => _141.options, 'optionalAccess', _142 => _142.halign]), () => ((["RP","GR","NUMBER"].includes(_optionalChain([o, 'optionalAccess', _143 => _143.options, 'optionalAccess', _144 => _144.format])||"")?"right":"left")))}})})):v.push({content:a.label,rowSpan:2,key:a.key,options:a.options,styles:y}):v.push({content:a.label,key:a.key,options:a.options,styles:y})}),l.push(v),E&&P.length>0&&l.push(P);let G={};c.forEach(a=>{if(a.detail.length>0){if(m.length>0){let f=A(d),i=[{content:m.map(t=>a[t]!==void 0||a[t]!==null?`${D(t)} : ${a[t]}`:"").filter(Boolean).join("  |  "),colSpan:f,styles:{fontStyle:"bold",halign:"left"}}];l.push(i)}let y={},o=z(d);if(a.detail.forEach(f=>{let u=o.map(i=>{let t=f[i.key],r=i.key;G[r]=(G[r]||0)+Number(t||0),y[r]=(y[r]||0)+Number(t||0);let b=_optionalChain([i, 'access', _145 => _145.options, 'optionalAccess', _146 => _146.format])==="IMAGE";return{content:(()=>{switch(_optionalChain([i, 'optionalAccess', _147 => _147.options, 'optionalAccess', _148 => _148.format])){case"RP":return t!==void 0?Number(t||0).toLocaleString("kr-ko"):"";case"GR":return t!==void 0?Number(t||0).toFixed(3):"";case"NUMBER":return t!==void 0?Number(t||0):"";case"IMAGE":return"";case"DATETIME":return t!==void 0?N(t||new Date):"";default:return t!==void 0?t.toString():""}})(),foto:b?t:null,styles:{halign:_optionalChain([i, 'optionalAccess', _149 => _149.options, 'optionalAccess', _150 => _150.halign])?_optionalChain([i, 'optionalAccess', _151 => _151.options, 'optionalAccess', _152 => _152.halign]):_optionalChain([i, 'optionalAccess', _153 => _153.options, 'optionalAccess', _154 => _154.format])==="RP"||_optionalChain([i, 'optionalAccess', _155 => _155.options, 'optionalAccess', _156 => _156.format])==="GR"||_optionalChain([i, 'optionalAccess', _157 => _157.options, 'optionalAccess', _158 => _158.format])==="NUMBER"||typeof t=="number"?"right":"left"}}});l.push(u)}),!_optionalChain([p, 'optionalAccess', _159 => _159.subTotal, 'optionalAccess', _160 => _160.disableSubtotal])){let f=[];o.forEach(r=>{let b=y[r.key];_optionalChain([r, 'optionalAccess', _161 => _161.options, 'optionalAccess', _162 => _162.format])==="RP"||_optionalChain([r, 'optionalAccess', _163 => _163.options, 'optionalAccess', _164 => _164.format])==="GR"||_optionalChain([r, 'optionalAccess', _165 => _165.options, 'optionalAccess', _166 => _166.format])==="NUMBER"?f.push({content:_optionalChain([r, 'optionalAccess', _167 => _167.options, 'optionalAccess', _168 => _168.disabledFooter])?"":(()=>{switch(_optionalChain([r, 'optionalAccess', _169 => _169.options, 'optionalAccess', _170 => _170.format])){case"RP":return b.toLocaleString("kr-ko");case"GR":return b.toFixed(3);case"NUMBER":return b;default:return b.toString()}})(),styles:{halign:_optionalChain([r, 'optionalAccess', _171 => _171.options, 'optionalAccess', _172 => _172.halign])||"right",textColor:`#${_optionalChain([e, 'optionalAccess', _173 => _173.txtColor])||"000"}`,fillColor:`#${_optionalChain([e, 'optionalAccess', _174 => _174.bgColor])||"E8E5E5"}`,fontStyle:"bold"}}):f.push({content:"",styles:{textColor:`#${_optionalChain([e, 'optionalAccess', _175 => _175.txtColor])||"000"}`,fillColor:`#${_optionalChain([e, 'optionalAccess', _176 => _176.bgColor])||"E8E5E5"}`,fontStyle:"bold"}})});let u=_optionalChain([e, 'optionalAccess', _177 => _177.grandTotalSetting, 'optionalAccess', _178 => _178.colSpan])?Number(_optionalChain([e, 'optionalAccess', _179 => _179.grandTotalSetting, 'optionalAccess', _180 => _180.colSpan])||0)+1:0,i=_optionalChain([p, 'optionalAccess', _181 => _181.subTotal, 'optionalAccess', _182 => _182.enableCount])&&m.length>0?" : "+a.detail.length:"",t=_optionalChain([p, 'optionalAccess', _183 => _183.subTotal, 'optionalAccess', _184 => _184.captionItem])?_optionalChain([p, 'optionalAccess', _185 => _185.subTotal, 'optionalAccess', _186 => _186.captionItem]):"";f[0]={content:`${_optionalChain([p, 'optionalAccess', _187 => _187.subTotal, 'optionalAccess', _188 => _188.caption])||"SUB TOTAL"}${i} ${t}`,colSpan:u,styles:{textColor:`#${_optionalChain([e, 'optionalAccess', _189 => _189.txtColor])||"000"}`,fillColor:`#${_optionalChain([e, 'optionalAccess', _190 => _190.bgColor])||"E8E5E5"}`,fontStyle:"bold",halign:"center"}},_optionalChain([e, 'optionalAccess', _191 => _191.grandTotalSetting, 'optionalAccess', _192 => _192.colSpan])&&f.splice(1,_optionalChain([e, 'optionalAccess', _193 => _193.grandTotalSetting, 'optionalAccess', _194 => _194.colSpan])),l.push(f)}}else{let y=(u,i)=>{let t=i[u.key],r=u.key;_optionalChain([u, 'access', _195 => _195.options, 'optionalAccess', _196 => _196.disabledFooter])||(G[r]=(G[r]||0)+Number(t||0));let b=(()=>{switch(_optionalChain([u, 'optionalAccess', _197 => _197.options, 'optionalAccess', _198 => _198.format])){case"RP":return t!==void 0?Number(t||0).toLocaleString("kr-ko"):"";case"GR":return t!==void 0?Number(t||0).toFixed(3):"";case"NUMBER":return t!==void 0?Number(t||0):"";case"IMAGE":return"";case"DATETIME":return t!==void 0?N(t||new Date):"";default:return t!==void 0?_optionalChain([t, 'optionalAccess', _199 => _199.toString, 'call', _200 => _200()]):""}})(),s=_optionalChain([u, 'optionalAccess', _201 => _201.options, 'optionalAccess', _202 => _202.halign])?_optionalChain([u, 'optionalAccess', _203 => _203.options, 'optionalAccess', _204 => _204.halign]):_optionalChain([u, 'optionalAccess', _205 => _205.options, 'optionalAccess', _206 => _206.format])==="RP"||_optionalChain([u, 'optionalAccess', _207 => _207.options, 'optionalAccess', _208 => _208.format])==="GR"||_optionalChain([u, 'optionalAccess', _209 => _209.options, 'optionalAccess', _210 => _210.format])==="NUMBER"||typeof t=="number"?"right":"left",x=_optionalChain([u, 'access', _211 => _211.options, 'optionalAccess', _212 => _212.format])==="IMAGE";return{options:_optionalChain([u, 'optionalAccess', _213 => _213.options]),content:b,foto:x?t:null,styles:{halign:s}}},f=z(d).map(u=>y(u,a));l.push(f)}});let C=z(d);if(!_optionalChain([p, 'optionalAccess', _214 => _214.grandTotal, 'optionalAccess', _215 => _215.disableGrandTotal])){let a=[];C.forEach(t=>{let r=G[t.key],b=["RP","GR","NUMBER"].includes(_optionalChain([t, 'optionalAccess', _216 => _216.options, 'optionalAccess', _217 => _217.format])||""),s=_optionalChain([t, 'optionalAccess', _218 => _218.options, 'optionalAccess', _219 => _219.disabledFooter])?"":(()=>{if(!b)return"";switch(_optionalChain([t, 'access', _220 => _220.options, 'optionalAccess', _221 => _221.format])){case"RP":return Number(r||0).toLocaleString("kr-KO");case"GR":return Number(r||0).toFixed(3);case"NUMBER":return Number(r||0);default:return(r||0).toString()}})();a.push({options:_optionalChain([t, 'optionalAccess', _222 => _222.options]),content:s,styles:{halign:_optionalChain([t, 'optionalAccess', _223 => _223.options, 'optionalAccess', _224 => _224.halign])?t.options.halign:b?"right":"left",textColor:`#${_optionalChain([e, 'optionalAccess', _225 => _225.txtColor])||"000"}`,fillColor:`#${_optionalChain([e, 'optionalAccess', _226 => _226.bgColor])||"E8E5E5"}`,fontStyle:"bold"}})});let y=Number(_optionalChain([e, 'optionalAccess', _227 => _227.grandTotalSetting, 'optionalAccess', _228 => _228.colSpan])||0),o=Math.min(y+1,C.length),f=_optionalChain([p, 'optionalAccess', _229 => _229.grandTotal, 'optionalAccess', _230 => _230.enableCount])?m.length>0?c.reduce((t,r)=>t+r.detail.length,0):c.length:0,u=_optionalChain([p, 'optionalAccess', _231 => _231.grandTotal, 'optionalAccess', _232 => _232.captionItem])||"",i=`${_optionalChain([p, 'optionalAccess', _233 => _233.grandTotal, 'optionalAccess', _234 => _234.caption])||"GRAND TOTAL"}`+(f?` : ${f}`:"")+(u?` ${u}`:"");for(a[0]={content:i,colSpan:o,styles:{textColor:`#${_optionalChain([e, 'optionalAccess', _235 => _235.txtColor])||"000"}`,fillColor:`#${_optionalChain([e, 'optionalAccess', _236 => _236.bgColor])||"E8E5E5"}`,fontStyle:"bold",halign:"center"}},a.splice(1,o-1);a.length<C.length;)a.push({content:"",styles:{textColor:`#${_optionalChain([e, 'optionalAccess', _237 => _237.txtColor])||"000"}`,fillColor:`#${_optionalChain([e, 'optionalAccess', _238 => _238.bgColor])||"E8E5E5"}`,fontStyle:"bold"}});l.push(a)}if(typeof _optionalChain([e, 'optionalAccess', _239 => _239.addRow])=="function"&&_optionalChain([e, 'optionalAccess', _240 => _240.addRow, 'call', _241 => _241(l)]),!_optionalChain([e, 'optionalAccess', _242 => _242.disablePrintDate])){let a=A(d);l.push([{content:`Print Date : ${N(`${new Date}`)}`,colSpan:a,styles:{textColor:`#${_optionalChain([e, 'optionalAccess', _243 => _243.txtColor])||"000"}`,fillColor:`#${_optionalChain([e, 'optionalAccess', _244 => _244.bgColor])||"E8E5E5"}`,fontStyle:"italic"}}])}_jspdfautotable2.default.call(void 0, g,{head:[],body:l,startY:$,theme:_optionalChain([e, 'optionalAccess', _245 => _245.theme])||"plain",rowPageBreak:"avoid",margin:{top:10},bodyStyles:{fontSize:_optionalChain([e, 'optionalAccess', _246 => _246.fontSIze])||8},headStyles:{fontSize:_optionalChain([e, 'optionalAccess', _247 => _247.fontSIze])||8,textColor:`#${_optionalChain([e, 'optionalAccess', _248 => _248.txtColor])||"000"}`,fillColor:`#${_optionalChain([e, 'optionalAccess', _249 => _249.bgColor])||"E8E5E5"}`},tableLineColor:[255,255,255],didParseCell:function(a){let y=a.column.index;_optionalChain([C, 'access', _250 => _250[y], 'optionalAccess', _251 => _251.options, 'optionalAccess', _252 => _252.format])==="IMAGE"&&a.cell.raw&&a.cell.raw.foto&&(a.row.height=20,a.cell.styles.valign="middle",a.cell.styles.halign="center")},didDrawCell:function(a){let{cell:y}=a,f=(y.raw||{}).foto,u=a.column.index;if(_optionalChain([C, 'access', _253 => _253[u], 'optionalAccess', _254 => _254.options, 'optionalAccess', _255 => _255.format])==="IMAGE"&&f){let r=y.x+(y.width-15)/2,b=y.y+(y.height-15)/2;try{g.addImage(f,"JPG",r,b,15,15)}catch(s){console.warn("\u274C Gagal render gambar:",s)}}}}),l=[],$=g.lastAutoTable.finalY;let T=g.internal.getNumberOfPages(),F=g.internal.pageSize.width,M=g.internal.pageSize.height;g.setFontSize(10);for(let a=1;a<T+1;a++){let y=F/2,o=M-10;g.setPage(a),g.text(`${a} of ${T}`,y,o,{align:"center"})}if(typeof _optionalChain([e, 'optionalAccess', _256 => _256.customize])=="function"&&e.customize(g,$,_jspdfautotable2.default),_optionalChain([e, 'optionalAccess', _257 => _257.openNewTab])){let a=g.output("bloburl");window.open(a)}else g.save(`${_optionalChain([e, 'optionalAccess', _258 => _258.titlePdf])||h}.pdf`)},H=Q;var Z=d=>{let c=[],m=d.copy?2:1;for(let e=0;e<m;e++){let n=d.data.map(h=>{let p=d.template;for(;/\n!!LOOP\((.+)\)(\{\n(.*\n)+\})\n/gm.exec(p);)p=p.replace(/\n!!LOOP\((.+)\)(\{\n(.*\n)+\})\n/,(g,l,$)=>{let k=$.replace(/^\{/,"").replace(/\}$/,"");return(Array.isArray(h[l])?h[l]:[h[l]]).reduce((P,E)=>P+k.replace(/\{([a-z0-9_]+)\}/gm,G=>{let C=G.replace(/(\{|\})/g,"");if(C.match(/nama_barang/)){let T=C.match(/nama_barang/),F=C==="nama_barang2"?[20,40]:C==="nama_barang3"?[40,60]:[0,20];return _optionalChain([E, 'access', _259 => _259[T], 'optionalAccess', _260 => _260.slice, 'call', _261 => _261(...F), 'access', _262 => _262.trim, 'call', _263 => _263()])||""}if(C.match(/deskripsi_jual/)){let T=C.match(/deskripsi_jual/),F=C==="deskripsi_jual2"?[20,40]:C==="deskripsi_jual3"?[40,60]:[0,20];return _optionalChain([E, 'access', _264 => _264[T], 'optionalAccess', _265 => _265.slice, 'call', _266 => _266(...F), 'access', _267 => _267.trim, 'call', _268 => _268()])||""}if(C.match(/deskripsi/)){let T=C.match(/deskripsi/),F=C==="deskripsi2"?[20,40]:C==="deskripsi3"?[40,60]:[0,20];return _optionalChain([E, 'access', _269 => _269[T], 'optionalAccess', _270 => _270.slice, 'call', _271 => _271(...F), 'access', _272 => _272.trim, 'call', _273 => _273()])||""}return E[C]||""}),"").replace(/\n(\s)+\n/gm,`
`)});return p.replace(/\{([a-z0-9_]+)\}/gm,g=>{let l=g.replace(/(\{|\})/g,"");return l.match(/auto_cut/)?`
VA`:h[l]||""}).replace(/\n(\s)+\n/gm,`
`).replace(/~new_line~/gm,`
`).replace(/!!LOOP\(detail\)/g,"").replace(/[}{]/g,"")});for(let h in n)n[h]+=`

`;c.push(...n)}return c},tt=async(d,c)=>{let m=Z(d),e=new Blob([_optionalChain([m, 'optionalAccess', _274 => _274.join, 'call', _275 => _275(`
`)])||""],{type:"text/plain"}),n=document.createElement("a");n.href=URL.createObjectURL(e),n.download=c,document.body.appendChild(n),n.click(),document.body.removeChild(n)},O=tt;var Rt=({columns:d,data:c,grouping:m,date:e,type:n,txtSetting:h,pdfSetting:p,excelSetting:g,title:l,footerSetting:$})=>{let k={data:[_optionalChain([h, 'optionalAccess', _276 => _276.dataTxt])],template:_optionalChain([h, 'optionalAccess', _277 => _277.templateTxt]),copy:_optionalChain([h, 'optionalAccess', _278 => _278.copy])};if(c.length===0)throw new Error("Data is required");if(n.length===0)throw new Error("Type is required");if(!V(n))throw new Error('Type Export must use ["EXCEL", "PDF", "TXT", "ALL"]');n.forEach(I=>{I==="PDF"?H({pdfSetting:p,date:e,data:c,type:n,columns:d,grouping:m,title:l,footerSetting:$}):I==="TXT"?O(k,_optionalChain([h, 'optionalAccess', _279 => _279.titleTxt])||""):I==="EXCEL"?_({date:e,data:c,type:n,columns:d,grouping:m,excelSetting:g,title:l,footerSetting:$}):(_({date:e,data:c,type:n,columns:d,grouping:m,excelSetting:g,title:l}),H({pdfSetting:p,date:e,data:c,type:n,columns:d,grouping:m,title:l}),O(k,_optionalChain([h, 'optionalAccess', _280 => _280.titleTxt])||""))})};exports.ExportData = Rt;
//# sourceMappingURL=index.js.map