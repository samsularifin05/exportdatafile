"use strict";Object.defineProperty(exports, "__esModule", {value: true}); function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; } function _nullishCoalesce(lhs, rhsFn) { if (lhs != null) { return lhs; } else { return rhsFn(); } } function _optionalChain(ops) { let lastAccessLHS = undefined; let value = ops[0]; let i = 1; while (i < ops.length) { const op = ops[i]; const fn = ops[i + 1]; i += 2; if ((op === 'optionalAccess' || op === 'optionalCall') && value == null) { return undefined; } if (op === 'access' || op === 'optionalAccess') { lastAccessLHS = value; value = fn(value); } else if (op === 'call' || op === 'optionalCall') { value = fn((...args) => value.call(lastAccessLHS, ...args)); lastAccessLHS = undefined; } } return value; }var X=["EXCEL","PDF","TXT","ALL"];function z(d,g=!1){let m=new Date(d),e=new Date(m.getTime()+420*60*1e3),r=e.getUTCFullYear(),b=String(e.getUTCMonth()+1).padStart(2,"0"),u=String(e.getUTCDate()).padStart(2,"0"),f=String(e.getUTCHours()).padStart(2,"0"),s=String(e.getUTCMinutes()).padStart(2,"0"),k=String(e.getUTCSeconds()).padStart(2,"0");return g?`${u}-${b}-${r} ${f}:${s}:${k}`:`${u}-${b}-${r}`}function K(d){return d.every(g=>X.includes(g))}function M(d){let g=0;return d.forEach(m=>{m.child&&m.child.length>0?g+=M(m.child):g+=1}),g}var P=d=>{let g=[];return d.forEach(m=>{m.child&&m.child.length>0?g.push(...P(m.child)):g.push(m)}),g},B=d=>d.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ");async function O(d,g,m,e){for(let r=0;r<e.length;r++){let b=e[r];if(_optionalChain([b, 'optionalAccess', _2 => _2.isImage])&&_optionalChain([b, 'optionalAccess', _3 => _3.imageSrc])&&typeof b.imageSrc=="string"&&b.imageSrc.startsWith("data:image"))try{let{buffer:u,extension:f}=q(b.imageSrc),s=d.addImage({buffer:u,extension:f});g.addImage(s,{tl:{col:r,row:m.number-1},ext:{width:70,height:60},editAs:"oneCell"}),(!m.height||m.height<60)&&(m.height=35)}catch(u){console.error("\u274C Error adding image to row:",u),m.getCell(r+1).value="[Image]"}}}function q(d){let g=d.match(/^data:image\/(\w+);base64,(.*)$/);if(!g)throw new Error("Invalid base64 image format");let m=g[1]==="jpg"?"jpeg":g[1],e=g[2],r=atob(e),b=r.length,u=new Uint8Array(b);for(let f=0;f<b;f++)u[f]=r.charCodeAt(f);return{buffer:u,extension:m}}var T=d=>{if(!d)return d;let g=d.replace(/^#/,"");return g.length===8?g.substring(2):g};var _exceljs = require('exceljs'); var _exceljs2 = _interopRequireDefault(_exceljs);var Z=async({columns:d,data:g,grouping:m,date:e,excelSetting:r,title:b,footerSetting:u})=>{let f=new _exceljs2.default.Workbook;d=d.filter(n=>!_optionalChain([n, 'access', _4 => _4.options, 'optionalAccess', _5 => _5.disabledColumn]));let s=f.addWorksheet(b||_optionalChain([r, 'optionalAccess', _6 => _6.titleExcel])),k=M(d),v=s.addRow([]);v.getCell(1).value=b||_optionalChain([r, 'optionalAccess', _7 => _7.titleExcel]),v.getCell(1).alignment={horizontal:"center"};let A=s.getColumn(k).letter;if(s.mergeCells(`A${v.number}:${A}${v.number}`),v.eachCell(n=>{n.font={color:{argb:"000000"},bold:!0,size:12}}),e){let n=s.addRow([]);n.getCell(1).value=`${e.caption?e.caption:"Tanggal "} : ${_optionalChain([e, 'optionalAccess', _8 => _8.start_date])} ${_optionalChain([e, 'optionalAccess', _9 => _9.end_date])?`s/d ${_optionalChain([e, 'optionalAccess', _10 => _10.end_date])}`:""}`,n.getCell(1).alignment={horizontal:"center"},s.mergeCells(`A${n.number}:${A}${n.number}`),n.eachCell(i=>{i.font={color:{argb:"00000"},bold:!0,size:12}})}let I=s.addRow([]);I.getCell(1).value=_optionalChain([r, 'optionalAccess', _11 => _11.additionalTextHeader])||"",I.getCell(1).alignment={horizontal:"center"},s.mergeCells(`A${I.number}:${A}${I.number}`),I.eachCell(n=>{n.font={color:{argb:"000000"},bold:!0,size:12}}),_optionalChain([r, 'optionalAccess', _12 => _12.customHeader])&&r.customHeader(s,k);let N=_optionalChain([r, 'optionalAccess', _13 => _13.startY])&&r.startY>0?r.startY:1;if(N>1)for(let n=1;n<N;n++)s.addRow([]);let F=d.some(n=>n.child&&n.child.length>0),w=s.addRow([]),y=F?s.addRow([]):null;d.forEach(n=>{if(n.child&&n.child.length>0){let i=w.actualCellCount+1,c=n.child.length;w.getCell(i).value=n.label,c>1&&s.mergeCells(w.number,i,w.number,i+c-1);for(let o=i;o<i+c;o++){let t=w.getCell(o);t.fill={type:"pattern",pattern:"solid",fgColor:{argb:_optionalChain([r, 'optionalAccess', _14 => _14.bgColor])||"E8E5E5"}},t.font={color:{argb:_optionalChain([r, 'optionalAccess', _15 => _15.txtColor])||"000000"},bold:!0},t.alignment={horizontal:"center",vertical:"middle"}}n.child.forEach((o,t)=>{if(y){let p=y.getCell(i+t);p.value=o.label,p.fill={type:"pattern",pattern:"solid",fgColor:{argb:_optionalChain([r, 'optionalAccess', _16 => _16.bgColor])||"E8E5E5"}},p.font={color:{argb:_optionalChain([r, 'optionalAccess', _17 => _17.txtColor])||"000000"},bold:!0};let h=_optionalChain([o, 'access', _18 => _18.options, 'optionalAccess', _19 => _19.halign])||(["RP","GR","NUMBER"].includes(_optionalChain([o, 'optionalAccess', _20 => _20.options, 'optionalAccess', _21 => _21.format])||"")?"right":"left"),l=_optionalChain([o, 'access', _22 => _22.options, 'optionalAccess', _23 => _23.valign])||"middle";p.alignment={horizontal:h,vertical:l}}})}else{let i=w.actualCellCount+1;w.getCell(i).value=n.label,w.getCell(i).fill={type:"pattern",pattern:"solid",fgColor:{argb:_optionalChain([r, 'optionalAccess', _24 => _24.bgColor])||"E8E5E5"}},w.getCell(i).font={color:{argb:_optionalChain([r, 'optionalAccess', _25 => _25.txtColor])||"000000"},bold:!0},w.getCell(i).alignment={horizontal:_optionalChain([n, 'access', _26 => _26.options, 'optionalAccess', _27 => _27.halign])||"center",vertical:_optionalChain([n, 'access', _28 => _28.options, 'optionalAccess', _29 => _29.valign])||"middle"},F&&y&&s.mergeCells(w.number,i,y.number,i)}}),P(d).forEach((n,i)=>{let c=i+1,o=s.getColumn(c);if(_optionalChain([n, 'access', _30 => _30.options, 'optionalAccess', _31 => _31.width]))o.width=n.options.width;else{let t=_optionalChain([n, 'access', _32 => _32.options, 'optionalAccess', _33 => _33.format])==="IMAGE"?15:20;o.width=t}});let G={};g.forEach(async n=>{if(_optionalChain([n, 'access', _34 => _34.detail, 'optionalAccess', _35 => _35.length])>0){if(m.length>0){let o=M(d),t=m.map(h=>n[h]!==void 0||n[h]!==null?`${B(h)} : ${n[h]}`:"").filter(Boolean).join("  |  "),p=s.addRow([t]);s.mergeCells(`A${p.number}:${String.fromCharCode(64+o)}${p.number}`),p.getCell(1).alignment={horizontal:"left"},p.getCell(1).font={bold:!0}}let i={};n.detail.forEach(async o=>{let p=P(d).map(l=>{if(_optionalChain([l, 'optionalAccess', _36 => _36.options, 'optionalAccess', _37 => _37.format])==="IMAGE"&&o[l.key])return{value:"",alignment:{horizontal:"center",vertical:"middle"},isImage:!0,imageSrc:o[l.key]};let R=_optionalChain([l, 'optionalAccess', _38 => _38.options, 'optionalAccess', _39 => _39.format])==="DATETIME"?z(o[l.key],!0):_optionalChain([l, 'optionalAccess', _40 => _40.options, 'optionalAccess', _41 => _41.format])==="DATE"?z(o[l.key]):o[l.key];l.formatter&&(R=l.formatter(R,o));let x={horizontal:_optionalChain([l, 'optionalAccess', _42 => _42.options, 'optionalAccess', _43 => _43.halign])?_optionalChain([l, 'optionalAccess', _44 => _44.options, 'optionalAccess', _45 => _45.halign]):_optionalChain([l, 'optionalAccess', _46 => _46.options, 'optionalAccess', _47 => _47.format])==="RP"||_optionalChain([l, 'optionalAccess', _48 => _48.options, 'optionalAccess', _49 => _49.format])==="GR"||_optionalChain([l, 'optionalAccess', _50 => _50.options, 'optionalAccess', _51 => _51.format])==="NUMBER"?"right":"left"},$=l.key,U=o[l.key];return G[$]=(G[$]||0)+Number(U),i[$]=(i[$]||0)+Number(U),{value:R,alignment:x,..._optionalChain([l, 'optionalAccess', _52 => _52.options, 'optionalAccess', _53 => _53.bgColor])&&{fgColor:{argb:l.options.bgColor}},..._optionalChain([l, 'optionalAccess', _54 => _54.options, 'optionalAccess', _55 => _55.txtColor])&&{color:{argb:l.options.txtColor}},numFmt:_optionalChain([l, 'optionalAccess', _56 => _56.options, 'optionalAccess', _57 => _57.format])==="RP"?"#,##0":_optionalChain([l, 'optionalAccess', _58 => _58.options, 'optionalAccess', _59 => _59.format])==="GR"?"#,##0.000":void 0}}),h=s.addRow(p.map(l=>l.value));p.forEach((l,R)=>{let x=h.getCell(R+1),$=["center","right","left","fill","justify","centerContinuous","distributed"],U=["top","middle","bottom","distributed","justify"],H,S;l.alignment&&typeof l.alignment.horizontal=="string"&&$.includes(l.alignment.horizontal)&&(H=l.alignment.horizontal),l.alignment&&"vertical"in l.alignment&&typeof l.alignment.vertical=="string"&&U.includes(l.alignment.vertical)&&(S=l.alignment.vertical),x.alignment={...H?{horizontal:H}:{},...S?{vertical:S}:{}},!l.isImage&&"numFmt"in l&&l.numFmt&&typeof l.value=="number"&&!isNaN(l.value)&&(x.value=Number(l.value),x.numFmt=l.numFmt)}),await O(f,s,h,p)});let c=P(d);if(!_optionalChain([u, 'optionalAccess', _60 => _60.subTotal, 'optionalAccess', _61 => _61.disableSubtotal])){let o=s.addRow(d.map(()=>null));c.forEach((t,p)=>{if(_optionalChain([t, 'optionalAccess', _62 => _62.options, 'optionalAccess', _63 => _63.format])==="RP"||_optionalChain([t, 'optionalAccess', _64 => _64.options, 'optionalAccess', _65 => _65.format])==="GR"||_optionalChain([t, 'optionalAccess', _66 => _66.options, 'optionalAccess', _67 => _67.format])==="NUMBER"){let l=g.length+4-1,R=`SUM(${String.fromCharCode(65+p)}4:${String.fromCharCode(65+p)}${l})`,x=o.getCell(p+1),$=_optionalChain([u, 'optionalAccess', _68 => _68.subTotal, 'optionalAccess', _69 => _69.enableCount])&&m.length>0?" : "+n.detail.length:"",U=_optionalChain([u, 'optionalAccess', _70 => _70.subTotal, 'optionalAccess', _71 => _71.captionItem])?_optionalChain([u, 'optionalAccess', _72 => _72.subTotal, 'optionalAccess', _73 => _73.captionItem]):"";o.getCell(1).value=`${_optionalChain([u, 'optionalAccess', _74 => _74.subTotal, 'optionalAccess', _75 => _75.caption])||"SUB TOTAL"} ${$} ${U}`,o.getCell(1).alignment={horizontal:"center"},x.numFmt=_optionalChain([t, 'optionalAccess', _76 => _76.options, 'optionalAccess', _77 => _77.format])==="GR"?"#,##0.000":"#,##0",x.value={formula:R},o.getCell(p+1).value=_optionalChain([t, 'optionalAccess', _78 => _78.options, 'access', _79 => _79.disabledFooter])?"":i[t.key]}else o.getCell(p+1).value=""}),_optionalChain([r, 'optionalAccess', _80 => _80.grandTotalSetting, 'optionalAccess', _81 => _81.colSpan])&&s.mergeCells(`A${o.number}:${String.fromCharCode(64+Number(_optionalChain([r, 'optionalAccess', _82 => _82.grandTotalSetting, 'optionalAccess', _83 => _83.colSpan])))}${o.number}`),o.eachCell(t=>{t.fill={type:"pattern",pattern:"solid",fgColor:{argb:_optionalChain([r, 'optionalAccess', _84 => _84.bgColor])||"#E8E5E5"},bgColor:{argb:_optionalChain([r, 'optionalAccess', _85 => _85.bgColor])||"#E8E5E5"}},t.font={color:{argb:_optionalChain([r, 'optionalAccess', _86 => _86.txtColor])},bold:!0}})}}else{let c=P(d).map(t=>{if(_optionalChain([t, 'optionalAccess', _87 => _87.options, 'optionalAccess', _88 => _88.format])==="IMAGE"&&n[t.key])return{value:"",alignment:{horizontal:"center",vertical:"middle"},isImage:!0,imageSrc:n[t.key]};let p=_optionalChain([t, 'optionalAccess', _89 => _89.options, 'optionalAccess', _90 => _90.format])==="DATETIME"?z(n[t.key]):_optionalChain([t, 'optionalAccess', _91 => _91.options, 'optionalAccess', _92 => _92.format])==="DATE"?z(n[t.key]):n[t.key];t.formatter&&(p=t.formatter(p,n));let h={horizontal:_optionalChain([t, 'optionalAccess', _93 => _93.options, 'optionalAccess', _94 => _94.halign])?_optionalChain([t, 'optionalAccess', _95 => _95.options, 'optionalAccess', _96 => _96.halign]):_optionalChain([t, 'optionalAccess', _97 => _97.options, 'optionalAccess', _98 => _98.format])==="RP"||_optionalChain([t, 'optionalAccess', _99 => _99.options, 'optionalAccess', _100 => _100.format])==="GR"||_optionalChain([t, 'optionalAccess', _101 => _101.options, 'optionalAccess', _102 => _102.format])==="NUMBER"?"right":"left"},l=t.key,R=n[t.key];return G[l]=(G[l]||0)+Number(R),{value:p,alignment:h,..._optionalChain([t, 'optionalAccess', _103 => _103.options, 'optionalAccess', _104 => _104.bgColor])&&{fgColor:{argb:t.options.bgColor}},..._optionalChain([t, 'optionalAccess', _105 => _105.options, 'optionalAccess', _106 => _106.txtColor])&&{color:{argb:t.options.txtColor}},numFmt:_optionalChain([t, 'optionalAccess', _107 => _107.options, 'optionalAccess', _108 => _108.format])==="RP"?"#,##0":_optionalChain([t, 'optionalAccess', _109 => _109.options, 'optionalAccess', _110 => _110.format])==="GR"?"#,##0.000":void 0}}),o=s.addRow(c.map(t=>t.value));c.forEach((t,p)=>{let h=o.getCell(p+1),l=["center","right","left","fill","justify","centerContinuous","distributed"],R=["top","middle","bottom","distributed","justify"],x,$;t.alignment&&typeof t.alignment.horizontal=="string"&&l.includes(t.alignment.horizontal)&&(x=t.alignment.horizontal),t.alignment&&"vertical"in t.alignment&&typeof t.alignment.vertical=="string"&&R.includes(t.alignment.vertical)&&($=t.alignment.vertical),h.alignment={...x?{horizontal:x}:{},...$?{vertical:$}:{}},!t.isImage&&"numFmt"in t&&t.numFmt&&typeof t.value=="number"&&!isNaN(t.value)&&(h.value=Number(t.value),h.numFmt=t.numFmt),!t.isImage&&"fgColor"in t&&t.fgColor&&(h.fill={type:"pattern",pattern:"solid",fgColor:t.fgColor}),!t.isImage&&"color"in t&&t.color&&(h.font={color:t.color})}),await O(f,s,o,c)}});let D=s.addRow(d.map(()=>null)),_=P(d);_optionalChain([u, 'optionalAccess', _111 => _111.grandTotal, 'optionalAccess', _112 => _112.disableGrandTotal])||(_.forEach((n,i)=>{if(_optionalChain([n, 'optionalAccess', _113 => _113.options, 'optionalAccess', _114 => _114.format])==="RP"||_optionalChain([n, 'optionalAccess', _115 => _115.options, 'optionalAccess', _116 => _116.format])==="GR"||_optionalChain([n, 'optionalAccess', _117 => _117.options, 'optionalAccess', _118 => _118.format])==="NUMBER"){let o=g.length+4-1,t=`SUM(${String.fromCharCode(65+i)}4:${String.fromCharCode(65+i)}${o})`,p=D.getCell(i+1),h=_optionalChain([u, 'optionalAccess', _119 => _119.grandTotal, 'optionalAccess', _120 => _120.enableCount])?m.length>0?" : "+g.map(x=>x.detail.length).reduce((x,$)=>x+$,0):" : "+g.length:"",l=_optionalChain([u, 'optionalAccess', _121 => _121.grandTotal, 'optionalAccess', _122 => _122.captionItem])?_optionalChain([u, 'optionalAccess', _123 => _123.grandTotal, 'optionalAccess', _124 => _124.captionItem]):"",R=`${_optionalChain([u, 'optionalAccess', _125 => _125.grandTotal, 'optionalAccess', _126 => _126.caption])||"GRAND TOTAL"} ${h} ${l}`;D.getCell(1).value=R,D.getCell(1).alignment={horizontal:"center"},p.numFmt=_optionalChain([n, 'optionalAccess', _127 => _127.options, 'optionalAccess', _128 => _128.format])==="GR"?"#,##0.000":"#,##0",p.value={formula:t},D.getCell(i+1).value=_optionalChain([n, 'optionalAccess', _129 => _129.options, 'access', _130 => _130.disabledFooter])?"":G[n.key]}else D.getCell(i+1).value=""}),_optionalChain([r, 'optionalAccess', _131 => _131.grandTotalSetting, 'optionalAccess', _132 => _132.colSpan])&&s.mergeCells(`A${D.number}:${String.fromCharCode(64+Number(_optionalChain([r, 'optionalAccess', _133 => _133.grandTotalSetting, 'optionalAccess', _134 => _134.colSpan])))}${D.number}`),D.eachCell(n=>{n.fill={type:"pattern",pattern:"solid",fgColor:{argb:_optionalChain([r, 'optionalAccess', _135 => _135.bgColor])||"#E8E5E5"},bgColor:{argb:_optionalChain([r, 'optionalAccess', _136 => _136.bgColor])||"#E8E5E5"}},n.font={color:{argb:_optionalChain([r, 'optionalAccess', _137 => _137.txtColor])},bold:!0}})),_optionalChain([r, 'optionalAccess', _138 => _138.customFooter])&&r.customFooter(s,k);let a=await f.xlsx.writeBuffer(),C=new Blob([a],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),E=document.createElement("a");E.href=URL.createObjectURL(C),E.download=`${_optionalChain([r, 'optionalAccess', _139 => _139.titleExcel])||b}.xlsx`,document.body.appendChild(E),E.click(),document.body.removeChild(E)},V=Z;var _jspdf = require('jspdf'); var _jspdf2 = _interopRequireDefault(_jspdf);var _jspdfautotable = require('jspdf-autotable'); var _jspdfautotable2 = _interopRequireDefault(_jspdfautotable);var ot=({columns:d,data:g,grouping:m,pdfSetting:e,date:r,title:b,footerSetting:u})=>{let f=new (0, _jspdf2.default)(_optionalChain([e, 'optionalAccess', _140 => _140.orientation]),_optionalChain([e, 'optionalAccess', _141 => _141.unit]),[_optionalChain([e, 'optionalAccess', _142 => _142.width])||297,_optionalChain([e, 'optionalAccess', _143 => _143.height])||210]),s=[],k=r?30:20;d=d.filter(a=>!_optionalChain([a, 'access', _144 => _144.options, 'optionalAccess', _145 => _145.disabledColumn])),f.setFontSize(10);let v=f.internal.pageSize.getWidth(),A=f.splitTextToSize(_optionalChain([e, 'optionalAccess', _146 => _146.textHeaderLeft])||"",110);f.text(A,15,18),f.text(`${b||_optionalChain([e, 'optionalAccess', _147 => _147.titlePdf])}`,v-15,18,{align:"right"}),r&&f.text(`${r.caption?r.caption:"TANGGAL "} : ${_optionalChain([r, 'optionalAccess', _148 => _148.start_date])} ${_optionalChain([r, 'optionalAccess', _149 => _149.end_date])?`s/d ${_optionalChain([r, 'optionalAccess', _150 => _150.end_date])}`:""}`,v-15,22,{align:"right"}),typeof _optionalChain([e, 'optionalAccess', _151 => _151.customHeader])=="function"&&e.customHeader(f,k,_jspdfautotable2.default),f.setProperties({title:b||_optionalChain([e, 'optionalAccess', _152 => _152.titlePdf])}),_optionalChain([e, 'optionalAccess', _153 => _153.startY])&&(k=e.startY);let I=[],N=[],F=d.some(a=>a.child&&a.child.length>0);d.forEach(a=>{let C={textColor:`#${T(_optionalChain([e, 'optionalAccess', _154 => _154.txtColor])||"000")}`,fillColor:`#${T(_optionalChain([e, 'optionalAccess', _155 => _155.bgColor])||"E8E5E5")}`,..._optionalChain([a, 'optionalAccess', _156 => _156.options, 'optionalAccess', _157 => _157.width])&&{cellWidth:_optionalChain([a, 'optionalAccess', _158 => _158.options, 'optionalAccess', _159 => _159.width])},fontStyle:"bold",..._optionalChain([a, 'optionalAccess', _160 => _160.options, 'optionalAccess', _161 => _161.valign])?{valign:a.options.valign}:{},halign:_nullishCoalesce(_optionalChain([a, 'optionalAccess', _162 => _162.options, 'optionalAccess', _163 => _163.halign]), () => ((["RP","GR","NUMBER"].includes(_optionalChain([a, 'optionalAccess', _164 => _164.options, 'optionalAccess', _165 => _165.format])||"")?"right":"left")))};F?a.child&&a.child.length>0?(I.push({content:a.label,colSpan:a.child.length,styles:C}),a.child.forEach(E=>{N.push({content:E.label,key:E.key,options:E.options,styles:{...C,halign:_nullishCoalesce(_optionalChain([E, 'optionalAccess', _166 => _166.options, 'optionalAccess', _167 => _167.halign]), () => ((["RP","GR","NUMBER"].includes(_optionalChain([E, 'optionalAccess', _168 => _168.options, 'optionalAccess', _169 => _169.format])||"")?"right":"left")))}})})):I.push({content:a.label,rowSpan:2,key:a.key,options:a.options,styles:C}):I.push({content:a.label,key:a.key,options:a.options,styles:C})}),s.push(I),F&&N.length>0&&s.push(N);let w={};g.forEach(a=>{if(_optionalChain([a, 'access', _170 => _170.detail, 'optionalAccess', _171 => _171.length])>0){if(m.length>0){let n=M(d),c=[{content:m.map(o=>a[o]!==void 0||a[o]!==null?`${B(o)} : ${a[o]}`:"").filter(Boolean).join("  |  "),colSpan:n,styles:{fontStyle:"bold",halign:"left"}}];s.push(c)}let C={},E=P(d);if(a.detail.forEach(n=>{let i=E.map(c=>{let o=n[c.key],t=c.key;c.formatter&&(o=c.formatter(o,n));let p=n[c.key];w[t]=(w[t]||0)+Number(p||0),C[t]=(C[t]||0)+Number(p||0);let h=_optionalChain([c, 'access', _172 => _172.options, 'optionalAccess', _173 => _173.format])==="IMAGE";return{content:(()=>{switch(_optionalChain([c, 'optionalAccess', _174 => _174.options, 'optionalAccess', _175 => _175.format])){case"RP":return o!==void 0?Number(o||0).toLocaleString("kr-ko"):"";case"GR":return o!==void 0?Number(o||0).toFixed(3):"";case"NUMBER":return o!==void 0?Number(o||0):"";case"IMAGE":return"";case"DATETIME":return o!==void 0?z(o||new Date,!0):"";case"DATE":return o!==void 0?z(o||new Date):"";default:return o!==void 0?o.toString():""}})(),foto:h?o:null,styles:{textColor:_optionalChain([c, 'optionalAccess', _176 => _176.options, 'optionalAccess', _177 => _177.txtColor])?`#${T(_optionalChain([c, 'optionalAccess', _178 => _178.options, 'optionalAccess', _179 => _179.txtColor]))}`:void 0,fillColor:_optionalChain([c, 'optionalAccess', _180 => _180.options, 'optionalAccess', _181 => _181.bgColor])?`#${T(_optionalChain([c, 'optionalAccess', _182 => _182.options, 'optionalAccess', _183 => _183.bgColor]))}`:void 0,halign:_optionalChain([c, 'optionalAccess', _184 => _184.options, 'optionalAccess', _185 => _185.halign])?_optionalChain([c, 'optionalAccess', _186 => _186.options, 'optionalAccess', _187 => _187.halign]):_optionalChain([c, 'optionalAccess', _188 => _188.options, 'optionalAccess', _189 => _189.format])==="RP"||_optionalChain([c, 'optionalAccess', _190 => _190.options, 'optionalAccess', _191 => _191.format])==="GR"||_optionalChain([c, 'optionalAccess', _192 => _192.options, 'optionalAccess', _193 => _193.format])==="NUMBER"||typeof o=="number"?"right":"left"}}});s.push(i)}),!_optionalChain([u, 'optionalAccess', _194 => _194.subTotal, 'optionalAccess', _195 => _195.disableSubtotal])){let n=[];E.forEach(t=>{let p=C[t.key];_optionalChain([t, 'optionalAccess', _196 => _196.options, 'optionalAccess', _197 => _197.format])==="RP"||_optionalChain([t, 'optionalAccess', _198 => _198.options, 'optionalAccess', _199 => _199.format])==="GR"||_optionalChain([t, 'optionalAccess', _200 => _200.options, 'optionalAccess', _201 => _201.format])==="NUMBER"?n.push({content:_optionalChain([t, 'optionalAccess', _202 => _202.options, 'optionalAccess', _203 => _203.disabledFooter])?"":(()=>{switch(_optionalChain([t, 'optionalAccess', _204 => _204.options, 'optionalAccess', _205 => _205.format])){case"RP":return p.toLocaleString("kr-ko");case"GR":return p.toFixed(3);case"NUMBER":return p;default:return p.toString()}})(),styles:{halign:_optionalChain([t, 'optionalAccess', _206 => _206.options, 'optionalAccess', _207 => _207.halign])||"right",textColor:`#${T(_optionalChain([e, 'optionalAccess', _208 => _208.txtColor])||"000")}`,fillColor:`#${T(_optionalChain([e, 'optionalAccess', _209 => _209.bgColor])||"E8E5E5")}`,fontStyle:"bold"}}):n.push({content:"",styles:{textColor:`#${T(_optionalChain([e, 'optionalAccess', _210 => _210.txtColor])||"000")}`,fillColor:`#${T(_optionalChain([e, 'optionalAccess', _211 => _211.bgColor])||"E8E5E5")}`,fontStyle:"bold"}})});let i=_optionalChain([e, 'optionalAccess', _212 => _212.grandTotalSetting, 'optionalAccess', _213 => _213.colSpan])?Number(_optionalChain([e, 'optionalAccess', _214 => _214.grandTotalSetting, 'optionalAccess', _215 => _215.colSpan])||0)+1:0,c=_optionalChain([u, 'optionalAccess', _216 => _216.subTotal, 'optionalAccess', _217 => _217.enableCount])&&m.length>0?" : "+a.detail.length:"",o=_optionalChain([u, 'optionalAccess', _218 => _218.subTotal, 'optionalAccess', _219 => _219.captionItem])?_optionalChain([u, 'optionalAccess', _220 => _220.subTotal, 'optionalAccess', _221 => _221.captionItem]):"";n[0]={content:`${_optionalChain([u, 'optionalAccess', _222 => _222.subTotal, 'optionalAccess', _223 => _223.caption])||"SUB TOTAL"}${c} ${o}`,colSpan:i,styles:{textColor:`#${T(_optionalChain([e, 'optionalAccess', _224 => _224.txtColor])||"000")}`,fillColor:`#${T(_optionalChain([e, 'optionalAccess', _225 => _225.bgColor])||"E8E5E5")}`,fontStyle:"bold",halign:"center"}},_optionalChain([e, 'optionalAccess', _226 => _226.grandTotalSetting, 'optionalAccess', _227 => _227.colSpan])&&n.splice(1,_optionalChain([e, 'optionalAccess', _228 => _228.grandTotalSetting, 'optionalAccess', _229 => _229.colSpan])),s.push(n)}}else{let C=(i,c)=>{let o=c[i.key],t=i.key;if(i.formatter&&(o=i.formatter(o,c)),!_optionalChain([i, 'access', _230 => _230.options, 'optionalAccess', _231 => _231.disabledFooter])){let R=c[i.key];w[t]=(w[t]||0)+Number(R||0)}let p=(()=>{switch(_optionalChain([i, 'optionalAccess', _232 => _232.options, 'optionalAccess', _233 => _233.format])){case"RP":return o!==void 0?Number(o||0).toLocaleString("kr-ko"):"";case"GR":return o!==void 0?Number(o||0).toFixed(3):"";case"NUMBER":return o!==void 0?Number(o||0):"";case"IMAGE":return"";case"DATETIME":return o!==void 0?z(o||new Date,!0):"";case"DATE":return o!==void 0?z(o||new Date):"";default:return o!==void 0?_optionalChain([o, 'optionalAccess', _234 => _234.toString, 'call', _235 => _235()]):""}})(),h=_optionalChain([i, 'optionalAccess', _236 => _236.options, 'optionalAccess', _237 => _237.halign])?_optionalChain([i, 'optionalAccess', _238 => _238.options, 'optionalAccess', _239 => _239.halign]):_optionalChain([i, 'optionalAccess', _240 => _240.options, 'optionalAccess', _241 => _241.format])==="RP"||_optionalChain([i, 'optionalAccess', _242 => _242.options, 'optionalAccess', _243 => _243.format])==="GR"||_optionalChain([i, 'optionalAccess', _244 => _244.options, 'optionalAccess', _245 => _245.format])==="NUMBER"||typeof o=="number"?"right":"left",l=_optionalChain([i, 'access', _246 => _246.options, 'optionalAccess', _247 => _247.format])==="IMAGE";return{options:_optionalChain([i, 'optionalAccess', _248 => _248.options]),content:p,foto:l?o:null,styles:{halign:h,textColor:_optionalChain([i, 'optionalAccess', _249 => _249.options, 'optionalAccess', _250 => _250.txtColor])?`#${T(_optionalChain([i, 'optionalAccess', _251 => _251.options, 'optionalAccess', _252 => _252.txtColor]))}`:"#000",fillColor:_optionalChain([i, 'optionalAccess', _253 => _253.options, 'optionalAccess', _254 => _254.bgColor])?`#${T(_optionalChain([i, 'optionalAccess', _255 => _255.options, 'optionalAccess', _256 => _256.bgColor]))}`:void 0}}},n=P(d).map(i=>C(i,a));s.push(n)}});let y=P(d);if(!_optionalChain([u, 'optionalAccess', _257 => _257.grandTotal, 'optionalAccess', _258 => _258.disableGrandTotal])){let a=[];y.forEach(o=>{let t=w[o.key],p=["RP","GR","NUMBER"].includes(_optionalChain([o, 'optionalAccess', _259 => _259.options, 'optionalAccess', _260 => _260.format])||""),h=_optionalChain([o, 'optionalAccess', _261 => _261.options, 'optionalAccess', _262 => _262.disabledFooter])?"":(()=>{if(!p)return"";switch(_optionalChain([o, 'access', _263 => _263.options, 'optionalAccess', _264 => _264.format])){case"RP":return Number(t||0).toLocaleString("kr-KO");case"GR":return Number(t||0).toFixed(3);case"NUMBER":return Number(t||0);default:return(t||0).toString()}})();a.push({options:_optionalChain([o, 'optionalAccess', _265 => _265.options]),content:h,styles:{halign:_optionalChain([o, 'optionalAccess', _266 => _266.options, 'optionalAccess', _267 => _267.halign])?o.options.halign:p?"right":"left",textColor:`#${T(_optionalChain([e, 'optionalAccess', _268 => _268.txtColor])||"000")}`,fillColor:`#${T(_optionalChain([e, 'optionalAccess', _269 => _269.bgColor])||"E8E5E5")}`,fontStyle:"bold"}})});let C=Number(_optionalChain([e, 'optionalAccess', _270 => _270.grandTotalSetting, 'optionalAccess', _271 => _271.colSpan])||0),E=Math.min(C+1,y.length),n=_optionalChain([u, 'optionalAccess', _272 => _272.grandTotal, 'optionalAccess', _273 => _273.enableCount])?m.length>0?g.reduce((o,t)=>o+t.detail.length,0):g.length:0,i=_optionalChain([u, 'optionalAccess', _274 => _274.grandTotal, 'optionalAccess', _275 => _275.captionItem])||"",c=`${_optionalChain([u, 'optionalAccess', _276 => _276.grandTotal, 'optionalAccess', _277 => _277.caption])||"GRAND TOTAL"}`+(n?` : ${n}`:"")+(i?` ${i}`:"");for(a[0]={content:c,colSpan:E,styles:{textColor:`#${T(_optionalChain([e, 'optionalAccess', _278 => _278.txtColor])||"000")}`,fillColor:`#${T(_optionalChain([e, 'optionalAccess', _279 => _279.bgColor])||"E8E5E5")}`,fontStyle:"bold",halign:"center"}},a.splice(1,E-1);a.length<y.length;)a.push({content:"",styles:{textColor:`#${T(_optionalChain([e, 'optionalAccess', _280 => _280.txtColor])||"000")}`,fillColor:`#${T(_optionalChain([e, 'optionalAccess', _281 => _281.bgColor])||"E8E5E5")}`,fontStyle:"bold"}});s.push(a)}if(typeof _optionalChain([e, 'optionalAccess', _282 => _282.addRow])=="function"&&_optionalChain([e, 'optionalAccess', _283 => _283.addRow, 'call', _284 => _284(s)]),!_optionalChain([e, 'optionalAccess', _285 => _285.disablePrintDate])){let a=M(d);s.push([{content:`Print Date : ${z(`${new Date}`)}`,colSpan:a,styles:{textColor:`#${T(_optionalChain([e, 'optionalAccess', _286 => _286.txtColor])||"000")}`,fillColor:`#${T(_optionalChain([e, 'optionalAccess', _287 => _287.bgColor])||"E8E5E5")}`,fontStyle:"italic"}}])}let L=[];_optionalChain([e, 'optionalAccess', _288 => _288.header, 'optionalAccess', _289 => _289.column])&&(L.push(I),F&&N.length>0&&L.push(N)),_jspdfautotable2.default.call(void 0, f,{head:L,body:s,startY:k,theme:_optionalChain([e, 'optionalAccess', _290 => _290.theme])||"plain",rowPageBreak:"avoid",margin:{top:_optionalChain([e, 'optionalAccess', _291 => _291.header, 'optionalAccess', _292 => _292.information])?30:10},bodyStyles:{fontSize:_optionalChain([e, 'optionalAccess', _293 => _293.fontSIze])||8},headStyles:{fontSize:_optionalChain([e, 'optionalAccess', _294 => _294.fontSIze])||8,textColor:`#${T(_optionalChain([e, 'optionalAccess', _295 => _295.txtColor])||"000")}`,fillColor:`#${T(_optionalChain([e, 'optionalAccess', _296 => _296.bgColor])||"E8E5E5")}`},tableLineColor:[255,255,255],didParseCell:function(a){let C=a.column.index;_optionalChain([y, 'access', _297 => _297[C], 'optionalAccess', _298 => _298.options, 'optionalAccess', _299 => _299.format])==="IMAGE"&&a.cell.raw&&a.cell.raw.foto&&(a.row.height=20,a.cell.styles.valign="middle",a.cell.styles.halign="center")},didDrawPage:function(a){if(_optionalChain([e, 'optionalAccess', _300 => _300.header, 'optionalAccess', _301 => _301.information])&&a.pageNumber>1){f.setFontSize(10);let C=f.internal.pageSize.getWidth(),E=f.splitTextToSize(_optionalChain([e, 'optionalAccess', _302 => _302.textHeaderLeft])||"",110);f.text(E,15,18),f.text(`${b||_optionalChain([e, 'optionalAccess', _303 => _303.titlePdf])}`,C-15,18,{align:"right"}),r&&f.text(`${r.caption?r.caption:"TANGGAL "} : ${_optionalChain([r, 'optionalAccess', _304 => _304.start_date])} ${_optionalChain([r, 'optionalAccess', _305 => _305.end_date])?`s/d ${_optionalChain([r, 'optionalAccess', _306 => _306.end_date])}`:""}`,C-15,22,{align:"right"})}},didDrawCell:function(a){let{cell:C}=a,n=(C.raw||{}).foto,i=a.column.index;if(_optionalChain([y, 'access', _307 => _307[i], 'optionalAccess', _308 => _308.options, 'optionalAccess', _309 => _309.format])==="IMAGE"&&n){let t=C.x+(C.width-15)/2,p=C.y+(C.height-15)/2;try{f.addImage(n,"JPG",t,p,15,15)}catch(h){console.warn("\u274C Gagal render gambar:",h)}}}}),s=[],k=f.lastAutoTable.finalY;let G=f.internal.getNumberOfPages(),D=f.internal.pageSize.width,_=f.internal.pageSize.height;f.setFontSize(10);for(let a=1;a<G+1;a++){let C=D/2,E=_-10;f.setPage(a),f.text(`${a} of ${G}`,C,E,{align:"center"})}if(typeof _optionalChain([e, 'optionalAccess', _310 => _310.customFooter])=="function"&&e.customFooter(f,k,_jspdfautotable2.default),_optionalChain([e, 'optionalAccess', _311 => _311.openNewTab])){let a=f.output("bloburl");window.open(a)}else f.save(`${_optionalChain([e, 'optionalAccess', _312 => _312.titlePdf])||b}.pdf`)},W=ot;var et=d=>{let g=[],m=d.copy?2:1;for(let e=0;e<m;e++){let r=d.data.map(b=>{let u=d.template;for(;/\n!!LOOP\((.+)\)(\{\n(.*\n)+\})\n/gm.exec(u);)u=u.replace(/\n!!LOOP\((.+)\)(\{\n(.*\n)+\})\n/,(f,s,k)=>{let v=k.replace(/^\{/,"").replace(/\}$/,"");return(Array.isArray(b[s])?b[s]:[b[s]]).reduce((N,F)=>N+v.replace(/\{([a-z0-9_]+)\}/gm,w=>{let y=w.replace(/(\{|\})/g,"");if(y.match(/nama_barang/)){let L=y.match(/nama_barang/),G=y==="nama_barang2"?[20,40]:y==="nama_barang3"?[40,60]:[0,20];return _optionalChain([F, 'access', _313 => _313[L], 'optionalAccess', _314 => _314.slice, 'call', _315 => _315(...G), 'access', _316 => _316.trim, 'call', _317 => _317()])||""}if(y.match(/deskripsi_jual/)){let L=y.match(/deskripsi_jual/),G=y==="deskripsi_jual2"?[20,40]:y==="deskripsi_jual3"?[40,60]:[0,20];return _optionalChain([F, 'access', _318 => _318[L], 'optionalAccess', _319 => _319.slice, 'call', _320 => _320(...G), 'access', _321 => _321.trim, 'call', _322 => _322()])||""}if(y.match(/deskripsi/)){let L=y.match(/deskripsi/),G=y==="deskripsi2"?[20,40]:y==="deskripsi3"?[40,60]:[0,20];return _optionalChain([F, 'access', _323 => _323[L], 'optionalAccess', _324 => _324.slice, 'call', _325 => _325(...G), 'access', _326 => _326.trim, 'call', _327 => _327()])||""}return F[y]||""}),"").replace(/\n(\s)+\n/gm,`
`)});return u.replace(/\{([a-z0-9_]+)\}/gm,f=>{let s=f.replace(/(\{|\})/g,"");return s.match(/auto_cut/)?`
VA`:b[s]||""}).replace(/\n(\s)+\n/gm,`
`).replace(/~new_line~/gm,`
`).replace(/!!LOOP\(detail\)/g,"").replace(/[}{]/g,"")});for(let b in r)r[b]+=`

`;g.push(...r)}return g},nt=async(d,g)=>{let m=et(d),e=new Blob([_optionalChain([m, 'optionalAccess', _328 => _328.join, 'call', _329 => _329(`
`)])||""],{type:"text/plain"}),r=document.createElement("a");r.href=URL.createObjectURL(e),r.download=g,document.body.appendChild(r),r.click(),document.body.removeChild(r)},J=nt;var Gt=({columns:d,data:g,grouping:m,date:e,type:r,txtSetting:b,pdfSetting:u,excelSetting:f,title:s,footerSetting:k})=>{let v={data:[_optionalChain([b, 'optionalAccess', _330 => _330.dataTxt])],template:_optionalChain([b, 'optionalAccess', _331 => _331.templateTxt]),copy:_optionalChain([b, 'optionalAccess', _332 => _332.copy])};if(g.length===0)throw new Error("Data is required");if(r.length===0)throw new Error("Type is required");if(!K(r))throw new Error('Type Export must use ["EXCEL", "PDF", "TXT", "ALL"]');r.forEach(A=>{A==="PDF"?W({pdfSetting:u,date:e,data:g,type:r,columns:d,grouping:m,title:s,footerSetting:k}):A==="TXT"?J(v,_optionalChain([b, 'optionalAccess', _333 => _333.titleTxt])||""):A==="EXCEL"?V({date:e,data:g,type:r,columns:d,grouping:m,excelSetting:f,title:s,footerSetting:k}):(V({date:e,data:g,type:r,columns:d,grouping:m,excelSetting:f,title:s}),W({pdfSetting:u,date:e,data:g,type:r,columns:d,grouping:m,title:s}),J(v,_optionalChain([b, 'optionalAccess', _334 => _334.titleTxt])||""))})};exports.ExportData = Gt;
//# sourceMappingURL=index.js.map