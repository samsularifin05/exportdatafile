"use strict";Object.defineProperty(exports, "__esModule", {value: true}); function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; } function _nullishCoalesce(lhs, rhsFn) { if (lhs != null) { return lhs; } else { return rhsFn(); } } function _optionalChain(ops) { let lastAccessLHS = undefined; let value = ops[0]; let i = 1; while (i < ops.length) { const op = ops[i]; const fn = ops[i + 1]; i += 2; if ((op === 'optionalAccess' || op === 'optionalCall') && value == null) { return undefined; } if (op === 'access' || op === 'optionalAccess') { lastAccessLHS = value; value = fn(value); } else if (op === 'call' || op === 'optionalCall') { value = fn((...args) => value.call(lastAccessLHS, ...args)); lastAccessLHS = undefined; } } return value; }var J=["EXCEL","PDF","TXT","ALL"];function D(l){let s=new Date(l),f=s.getFullYear(),e=String(s.getMonth()+1).padStart(2,"0"),o=String(s.getDate()).padStart(2,"0"),b=String(s.getHours()).padStart(2,"0"),g=String(s.getMinutes()).padStart(2,"0"),c=String(s.getSeconds()).padStart(2,"0");return`${o}-${e}-${f} ${b}:${g}:${c}`}function W(l){return l.every(s=>J.includes(s))}function M(l){let s=0;return l.forEach(f=>{f.child&&f.child.length>0?s+=M(f.child):s+=1}),s}var z=l=>{let s=[];return l.forEach(f=>{f.child&&f.child.length>0?s.push(...z(f.child)):s.push(f)}),s},j=l=>l.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ");async function O(l,s,f,e){for(let o=0;o<e.length;o++){let b=e[o];if(_optionalChain([b, 'optionalAccess', _2 => _2.isImage])&&_optionalChain([b, 'optionalAccess', _3 => _3.imageSrc])&&typeof b.imageSrc=="string"&&b.imageSrc.startsWith("data:image"))try{let{buffer:g,extension:c}=q(b.imageSrc),r=l.addImage({buffer:g,extension:c});s.addImage(r,{tl:{col:o,row:f.number-1},ext:{width:70,height:60},editAs:"oneCell"}),(!f.height||f.height<60)&&(f.height=35)}catch(g){console.error("\u274C Error adding image to row:",g),f.getCell(o+1).value="[Image]"}}}function q(l){let s=l.match(/^data:image\/(\w+);base64,(.*)$/);if(!s)throw new Error("Invalid base64 image format");let f=s[1]==="jpg"?"jpeg":s[1],e=s[2],o=atob(e),b=o.length,g=new Uint8Array(b);for(let c=0;c<b;c++)g[c]=o.charCodeAt(c);return{buffer:g,extension:f}}var _exceljs = require('exceljs'); var _exceljs2 = _interopRequireDefault(_exceljs);var Z=async({columns:l,data:s,grouping:f,date:e,excelSetting:o,title:b,footerSetting:g})=>{let c=new _exceljs2.default.Workbook;l=l.filter(n=>!_optionalChain([n, 'access', _4 => _4.options, 'optionalAccess', _5 => _5.disabledColumn]));let r=c.addWorksheet(b||_optionalChain([o, 'optionalAccess', _6 => _6.titleExcel])),$=M(l),x=r.addRow([]);x.getCell(1).value=b||_optionalChain([o, 'optionalAccess', _7 => _7.titleExcel]),x.getCell(1).alignment={horizontal:"center"};let I=r.getColumn($).letter;if(r.mergeCells(`A${x.number}:${I}${x.number}`),x.eachCell(n=>{n.font={color:{argb:"000000"},bold:!0,size:12}}),e){let n=r.addRow([]);n.getCell(1).value=`${e.caption?e.caption:"Tanggal "} : ${_optionalChain([e, 'optionalAccess', _8 => _8.start_date])} ${_optionalChain([e, 'optionalAccess', _9 => _9.end_date])?`s/d ${_optionalChain([e, 'optionalAccess', _10 => _10.end_date])}`:""}`,n.getCell(1).alignment={horizontal:"center"},r.mergeCells(`A${n.number}:${I}${n.number}`),n.eachCell(p=>{p.font={color:{argb:"00000"},bold:!0,size:12}})}let v=r.addRow([]);v.getCell(1).value=_optionalChain([o, 'optionalAccess', _11 => _11.additionalTextHeader])||"",v.getCell(1).alignment={horizontal:"center"},r.mergeCells(`A${v.number}:${I}${v.number}`),v.eachCell(n=>{n.font={color:{argb:"000000"},bold:!0,size:12}});let P=l.some(n=>n.child&&n.child.length>0),w=r.addRow([]),G=P?r.addRow([]):null;l.forEach(n=>{if(n.child&&n.child.length>0){let p=w.actualCellCount+1,u=n.child.length;w.getCell(p).value=n.label,u>1&&r.mergeCells(w.number,p,w.number,p+u-1);for(let E=p;E<p+u;E++){let t=w.getCell(E);t.fill={type:"pattern",pattern:"solid",fgColor:{argb:_optionalChain([o, 'optionalAccess', _12 => _12.bgColor])||"E8E5E5"}},t.font={color:{argb:_optionalChain([o, 'optionalAccess', _13 => _13.txtColor])||"000000"},bold:!0},t.alignment={horizontal:"center",vertical:"middle"}}n.child.forEach((E,t)=>{if(G){let h=G.getCell(p+t);h.value=E.label,h.fill={type:"pattern",pattern:"solid",fgColor:{argb:_optionalChain([o, 'optionalAccess', _14 => _14.bgColor])||"E8E5E5"}},h.font={color:{argb:_optionalChain([o, 'optionalAccess', _15 => _15.txtColor])||"000000"},bold:!0};let i=_optionalChain([E, 'access', _16 => _16.options, 'optionalAccess', _17 => _17.halign])||(["RP","GR","NUMBER"].includes(_optionalChain([E, 'optionalAccess', _18 => _18.options, 'optionalAccess', _19 => _19.format])||"")?"right":"left"),d=_optionalChain([E, 'access', _20 => _20.options, 'optionalAccess', _21 => _21.valign])||"middle";h.alignment={horizontal:i,vertical:d}}})}else{let p=w.actualCellCount+1;w.getCell(p).value=n.label,w.getCell(p).fill={type:"pattern",pattern:"solid",fgColor:{argb:_optionalChain([o, 'optionalAccess', _22 => _22.bgColor])||"E8E5E5"}},w.getCell(p).font={color:{argb:_optionalChain([o, 'optionalAccess', _23 => _23.txtColor])||"000000"},bold:!0},w.getCell(p).alignment={horizontal:_optionalChain([n, 'access', _24 => _24.options, 'optionalAccess', _25 => _25.halign])||"center",vertical:_optionalChain([n, 'access', _26 => _26.options, 'optionalAccess', _27 => _27.valign])||"middle"},P&&G&&r.mergeCells(w.number,p,G.number,p)}});let T={};s.forEach(async n=>{if(f.length>0){let p=M(l),u=f.map(i=>n[i]!==void 0?`${j(i)} : ${n[i]}`:"").filter(Boolean).join("  |  "),E=r.addRow([u]);r.mergeCells(`A${E.number}:${String.fromCharCode(64+p)}${E.number}`),E.getCell(1).alignment={horizontal:"left"},E.getCell(1).font={bold:!0};let t={};n.detail.forEach(async i=>{let y=z(l).map(m=>{if(_optionalChain([m, 'optionalAccess', _28 => _28.options, 'optionalAccess', _29 => _29.format])==="IMAGE"&&i[m.key])return{value:"",alignment:{horizontal:"center",vertical:"middle"},isImage:!0,imageSrc:i[m.key]};let L=_optionalChain([m, 'optionalAccess', _30 => _30.options, 'optionalAccess', _31 => _31.format])==="DATETIME"?D(i[m.key]):i[m.key],N={horizontal:_optionalChain([m, 'optionalAccess', _32 => _32.options, 'optionalAccess', _33 => _33.halign])?_optionalChain([m, 'optionalAccess', _34 => _34.options, 'optionalAccess', _35 => _35.halign]):_optionalChain([m, 'optionalAccess', _36 => _36.options, 'optionalAccess', _37 => _37.format])==="RP"||_optionalChain([m, 'optionalAccess', _38 => _38.options, 'optionalAccess', _39 => _39.format])==="GR"||_optionalChain([m, 'optionalAccess', _40 => _40.options, 'optionalAccess', _41 => _41.format])==="NUMBER"?"right":"left"},A=m.key;return T[A]=(T[A]||0)+Number(L),t[A]=(t[A]||0)+Number(L),{value:L,alignment:N,numFmt:_optionalChain([m, 'optionalAccess', _42 => _42.options, 'optionalAccess', _43 => _43.format])==="RP"?"#,##0":_optionalChain([m, 'optionalAccess', _44 => _44.options, 'optionalAccess', _45 => _45.format])==="GR"?"#,##0.000":void 0}}),R=r.addRow(y.map(m=>m.value));y.forEach((m,L)=>{let N=R.getCell(L+1),A=["center","right","left","fill","justify","centerContinuous","distributed"],S=["top","middle","bottom","distributed","justify"],_,H;m.alignment&&typeof m.alignment.horizontal=="string"&&A.includes(m.alignment.horizontal)&&(_=m.alignment.horizontal),m.alignment&&"vertical"in m.alignment&&typeof m.alignment.vertical=="string"&&S.includes(m.alignment.vertical)&&(H=m.alignment.vertical),N.alignment={..._?{horizontal:_}:{},...H?{vertical:H}:{}},m.numFmt&&typeof m.value=="number"&&!isNaN(m.value)&&(N.value=Number(m.value),N.numFmt=m.numFmt)}),await O(c,r,R,y)});let h=z(l);if(!_optionalChain([g, 'optionalAccess', _46 => _46.subTotal, 'optionalAccess', _47 => _47.disableSubtotal])){let i=r.addRow(l.map(()=>null));h.forEach((d,y)=>{if(_optionalChain([d, 'optionalAccess', _48 => _48.options, 'optionalAccess', _49 => _49.format])==="RP"||_optionalChain([d, 'optionalAccess', _50 => _50.options, 'optionalAccess', _51 => _51.format])==="GR"||_optionalChain([d, 'optionalAccess', _52 => _52.options, 'optionalAccess', _53 => _53.format])==="NUMBER"){let m=s.length+4-1,L=`SUM(${String.fromCharCode(65+y)}4:${String.fromCharCode(65+y)}${m})`,N=i.getCell(y+1),A=_optionalChain([g, 'optionalAccess', _54 => _54.subTotal, 'optionalAccess', _55 => _55.enableCount])&&f.length>0?" : "+n.detail.length:"",S=_optionalChain([g, 'optionalAccess', _56 => _56.subTotal, 'optionalAccess', _57 => _57.captionItem])?_optionalChain([g, 'optionalAccess', _58 => _58.subTotal, 'optionalAccess', _59 => _59.captionItem]):"";i.getCell(1).value=`${_optionalChain([g, 'optionalAccess', _60 => _60.subTotal, 'optionalAccess', _61 => _61.caption])||"SUB TOTAL"} ${A} ${S}`,i.getCell(1).alignment={horizontal:"center"},N.numFmt=_optionalChain([d, 'optionalAccess', _62 => _62.options, 'optionalAccess', _63 => _63.format])==="GR"?"#,##0.000":"#,##0",N.value={formula:L},i.getCell(y+1).value=_optionalChain([d, 'optionalAccess', _64 => _64.options, 'access', _65 => _65.disabledFooter])?"":t[d.key]}else i.getCell(y+1).value=""}),_optionalChain([o, 'optionalAccess', _66 => _66.grandTotalSetting, 'optionalAccess', _67 => _67.colSpan])&&r.mergeCells(`A${i.number}:${String.fromCharCode(64+Number(_optionalChain([o, 'optionalAccess', _68 => _68.grandTotalSetting, 'optionalAccess', _69 => _69.colSpan])))}${i.number}`),i.eachCell(d=>{d.fill={type:"pattern",pattern:"solid",fgColor:{argb:_optionalChain([o, 'optionalAccess', _70 => _70.bgColor])||"#E8E5E5"},bgColor:{argb:_optionalChain([o, 'optionalAccess', _71 => _71.bgColor])||"#E8E5E5"}},d.font={color:{argb:_optionalChain([o, 'optionalAccess', _72 => _72.txtColor])},bold:!0}})}}else{let u=z(l).map(t=>{if(_optionalChain([t, 'optionalAccess', _73 => _73.options, 'optionalAccess', _74 => _74.format])==="IMAGE"&&n[t.key])return{value:"",alignment:{horizontal:"center",vertical:"middle"},isImage:!0,imageSrc:n[t.key]};let h=_optionalChain([t, 'optionalAccess', _75 => _75.options, 'optionalAccess', _76 => _76.format])==="DATETIME"?D(n[t.key]):n[t.key],i={horizontal:_optionalChain([t, 'optionalAccess', _77 => _77.options, 'optionalAccess', _78 => _78.halign])?_optionalChain([t, 'optionalAccess', _79 => _79.options, 'optionalAccess', _80 => _80.halign]):_optionalChain([t, 'optionalAccess', _81 => _81.options, 'optionalAccess', _82 => _82.format])==="RP"||_optionalChain([t, 'optionalAccess', _83 => _83.options, 'optionalAccess', _84 => _84.format])==="GR"||_optionalChain([t, 'optionalAccess', _85 => _85.options, 'optionalAccess', _86 => _86.format])==="NUMBER"?"right":"left"},d=t.key;return T[d]=(T[d]||0)+Number(h),{value:h,alignment:i,numFmt:_optionalChain([t, 'optionalAccess', _87 => _87.options, 'optionalAccess', _88 => _88.format])==="RP"?"#,##0":_optionalChain([t, 'optionalAccess', _89 => _89.options, 'optionalAccess', _90 => _90.format])==="GR"?"#,##0.000":void 0}}),E=r.addRow(u.map(t=>t.value));u.forEach((t,h)=>{let i=E.getCell(h+1),d=["center","right","left","fill","justify","centerContinuous","distributed"],y=["top","middle","bottom","distributed","justify"],R,m;t.alignment&&typeof t.alignment.horizontal=="string"&&d.includes(t.alignment.horizontal)&&(R=t.alignment.horizontal),t.alignment&&"vertical"in t.alignment&&typeof t.alignment.vertical=="string"&&y.includes(t.alignment.vertical)&&(m=t.alignment.vertical),i.alignment={...R?{horizontal:R}:{},...m?{vertical:m}:{}},t.numFmt&&typeof t.value=="number"&&!isNaN(t.value)&&(i.value=Number(t.value),i.numFmt=t.numFmt)}),await O(c,r,E,u)}});let k=r.addRow(l.map(()=>null)),F=z(l);_optionalChain([g, 'optionalAccess', _91 => _91.grandTotal, 'optionalAccess', _92 => _92.disableGrandTotal])||(F.forEach((n,p)=>{if(_optionalChain([n, 'optionalAccess', _93 => _93.options, 'optionalAccess', _94 => _94.format])==="RP"||_optionalChain([n, 'optionalAccess', _95 => _95.options, 'optionalAccess', _96 => _96.format])==="GR"||_optionalChain([n, 'optionalAccess', _97 => _97.options, 'optionalAccess', _98 => _98.format])==="NUMBER"){let E=s.length+4-1,t=`SUM(${String.fromCharCode(65+p)}4:${String.fromCharCode(65+p)}${E})`,h=k.getCell(p+1),i=_optionalChain([g, 'optionalAccess', _99 => _99.grandTotal, 'optionalAccess', _100 => _100.enableCount])?f.length>0?" : "+s.map(R=>R.detail.length).reduce((R,m)=>R+m,0):" : "+s.length:"",d=_optionalChain([g, 'optionalAccess', _101 => _101.grandTotal, 'optionalAccess', _102 => _102.captionItem])?_optionalChain([g, 'optionalAccess', _103 => _103.grandTotal, 'optionalAccess', _104 => _104.captionItem]):"",y=`${_optionalChain([g, 'optionalAccess', _105 => _105.grandTotal, 'optionalAccess', _106 => _106.caption])||"GRAND TOTAL"} ${i} ${d}`;k.getCell(1).value=y,k.getCell(1).alignment={horizontal:"center"},h.numFmt=_optionalChain([n, 'optionalAccess', _107 => _107.options, 'optionalAccess', _108 => _108.format])==="GR"?"#,##0.000":"#,##0",h.value={formula:t},k.getCell(p+1).value=_optionalChain([n, 'optionalAccess', _109 => _109.options, 'access', _110 => _110.disabledFooter])?"":T[n.key]}else k.getCell(p+1).value=""}),_optionalChain([o, 'optionalAccess', _111 => _111.grandTotalSetting, 'optionalAccess', _112 => _112.colSpan])&&r.mergeCells(`A${k.number}:${String.fromCharCode(64+Number(_optionalChain([o, 'optionalAccess', _113 => _113.grandTotalSetting, 'optionalAccess', _114 => _114.colSpan])))}${k.number}`),k.eachCell(n=>{n.fill={type:"pattern",pattern:"solid",fgColor:{argb:_optionalChain([o, 'optionalAccess', _115 => _115.bgColor])||"#E8E5E5"},bgColor:{argb:_optionalChain([o, 'optionalAccess', _116 => _116.bgColor])||"#E8E5E5"}},n.font={color:{argb:_optionalChain([o, 'optionalAccess', _117 => _117.txtColor])},bold:!0}})),_optionalChain([o, 'optionalAccess', _118 => _118.customize])&&o.customize(r);let B=await c.xlsx.writeBuffer(),a=new Blob([B],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),C=document.createElement("a");C.href=URL.createObjectURL(a),C.download=`${_optionalChain([o, 'optionalAccess', _119 => _119.titleExcel])||b}.xlsx`,document.body.appendChild(C),C.click(),document.body.removeChild(C)},X=Z;var _jspdf = require('jspdf'); var _jspdf2 = _interopRequireDefault(_jspdf);var _jspdfautotable = require('jspdf-autotable'); var _jspdfautotable2 = _interopRequireDefault(_jspdfautotable);var et=({columns:l,data:s,grouping:f,pdfSetting:e,date:o,title:b,footerSetting:g})=>{let c=new (0, _jspdf2.default)(_optionalChain([e, 'optionalAccess', _120 => _120.orientation]),_optionalChain([e, 'optionalAccess', _121 => _121.unit]),[_optionalChain([e, 'optionalAccess', _122 => _122.width])||297,_optionalChain([e, 'optionalAccess', _123 => _123.height])||210]),r=[],$=o?30:20;l=l.filter(a=>!_optionalChain([a, 'access', _124 => _124.options, 'optionalAccess', _125 => _125.disabledColumn])),c.setFontSize(10);let x=c.internal.pageSize.getWidth(),I=c.splitTextToSize(_optionalChain([e, 'optionalAccess', _126 => _126.textHeaderLeft])||"",110);c.text(I,15,18),c.text(`${b||_optionalChain([e, 'optionalAccess', _127 => _127.titlePdf])}`,x-15,18,{align:"right"}),o&&c.text(`${o.caption?o.caption:"TANGGAL "} : ${_optionalChain([o, 'optionalAccess', _128 => _128.start_date])} ${_optionalChain([o, 'optionalAccess', _129 => _129.end_date])?`s/d ${_optionalChain([o, 'optionalAccess', _130 => _130.end_date])}`:""}`,x-15,22,{align:"right"}),c.setProperties({title:b||_optionalChain([e, 'optionalAccess', _131 => _131.titlePdf])}),_optionalChain([e, 'optionalAccess', _132 => _132.finalY])&&(console.log(e.finalY),$=e.finalY);let v=[],P=[],w=l.some(a=>a.child&&a.child.length>0);l.forEach(a=>{let C={textColor:`#${_optionalChain([e, 'optionalAccess', _133 => _133.txtColor])||"000"}`,fillColor:`#${_optionalChain([e, 'optionalAccess', _134 => _134.bgColor])||"E8E5E5"}`,fontStyle:"bold",..._optionalChain([a, 'optionalAccess', _135 => _135.options, 'optionalAccess', _136 => _136.valign])?{valign:a.options.valign}:{},halign:_nullishCoalesce(_optionalChain([a, 'optionalAccess', _137 => _137.options, 'optionalAccess', _138 => _138.halign]), () => ((["RP","GR","NUMBER"].includes(_optionalChain([a, 'optionalAccess', _139 => _139.options, 'optionalAccess', _140 => _140.format])||"")?"right":"left")))};w?a.child&&a.child.length>0?(v.push({content:a.label,colSpan:a.child.length,styles:C}),a.child.forEach(n=>{P.push({content:n.label,key:n.key,options:n.options,styles:{...C,halign:_nullishCoalesce(_optionalChain([n, 'optionalAccess', _141 => _141.options, 'optionalAccess', _142 => _142.halign]), () => ((["RP","GR","NUMBER"].includes(_optionalChain([n, 'optionalAccess', _143 => _143.options, 'optionalAccess', _144 => _144.format])||"")?"right":"left")))}})})):v.push({content:a.label,rowSpan:2,key:a.key,options:a.options,styles:C}):v.push({content:a.label,key:a.key,options:a.options,styles:C})}),r.push(v),w&&P.length>0&&r.push(P);let G={};s.forEach(a=>{if(f.length>0){let C=M(l),p=[{content:f.map(t=>a[t]!==void 0?`${j(t)} : ${a[t]}`:"").filter(Boolean).join("  |  "),colSpan:C,styles:{fontStyle:"bold",halign:"left"}}];r.push(p);let u={},E=z(l);if(a.detail.forEach(t=>{let h=E.map(i=>{let d=t[i.key],y=i.key;G[y]=(G[y]||0)+Number(d||0),u[y]=(u[y]||0)+Number(d||0);let R=_optionalChain([i, 'access', _145 => _145.options, 'optionalAccess', _146 => _146.format])==="IMAGE";return{content:(()=>{switch(_optionalChain([i, 'optionalAccess', _147 => _147.options, 'optionalAccess', _148 => _148.format])){case"RP":return d!==void 0?Number(d||0).toLocaleString("kr-ko"):"";case"GR":return d!==void 0?Number(d||0).toFixed(3):"";case"NUMBER":return d!==void 0?Number(d||0):"";case"IMAGE":return"";case"DATETIME":return d!==void 0?D(d||new Date):"";default:return d!==void 0?d.toString():""}})(),foto:R?d:null,styles:{halign:_optionalChain([i, 'optionalAccess', _149 => _149.options, 'optionalAccess', _150 => _150.halign])?_optionalChain([i, 'optionalAccess', _151 => _151.options, 'optionalAccess', _152 => _152.halign]):_optionalChain([i, 'optionalAccess', _153 => _153.options, 'optionalAccess', _154 => _154.format])==="RP"||_optionalChain([i, 'optionalAccess', _155 => _155.options, 'optionalAccess', _156 => _156.format])==="GR"||_optionalChain([i, 'optionalAccess', _157 => _157.options, 'optionalAccess', _158 => _158.format])==="NUMBER"||typeof d=="number"?"right":"left"}}});r.push(h)}),!_optionalChain([g, 'optionalAccess', _159 => _159.subTotal, 'optionalAccess', _160 => _160.disableSubtotal])){let t=[];E.forEach(y=>{let R=u[y.key];_optionalChain([y, 'optionalAccess', _161 => _161.options, 'optionalAccess', _162 => _162.format])==="RP"||_optionalChain([y, 'optionalAccess', _163 => _163.options, 'optionalAccess', _164 => _164.format])==="GR"||_optionalChain([y, 'optionalAccess', _165 => _165.options, 'optionalAccess', _166 => _166.format])==="NUMBER"?t.push({content:_optionalChain([y, 'optionalAccess', _167 => _167.options, 'optionalAccess', _168 => _168.disabledFooter])?"":(()=>{switch(_optionalChain([y, 'optionalAccess', _169 => _169.options, 'optionalAccess', _170 => _170.format])){case"RP":return R.toLocaleString("kr-ko");case"GR":return R.toFixed(3);case"NUMBER":return R;default:return R.toString()}})(),styles:{halign:_optionalChain([y, 'optionalAccess', _171 => _171.options, 'optionalAccess', _172 => _172.halign])||"right",textColor:`#${_optionalChain([e, 'optionalAccess', _173 => _173.txtColor])||"000"}`,fillColor:`#${_optionalChain([e, 'optionalAccess', _174 => _174.bgColor])||"E8E5E5"}`,fontStyle:"bold"}}):t.push({content:"",styles:{textColor:`#${_optionalChain([e, 'optionalAccess', _175 => _175.txtColor])||"000"}`,fillColor:`#${_optionalChain([e, 'optionalAccess', _176 => _176.bgColor])||"E8E5E5"}`,fontStyle:"bold"}})});let h=_optionalChain([e, 'optionalAccess', _177 => _177.grandTotalSetting, 'optionalAccess', _178 => _178.colSpan])?Number(_optionalChain([e, 'optionalAccess', _179 => _179.grandTotalSetting, 'optionalAccess', _180 => _180.colSpan])||0)+1:0,i=_optionalChain([g, 'optionalAccess', _181 => _181.subTotal, 'optionalAccess', _182 => _182.enableCount])&&f.length>0?" : "+a.detail.length:"",d=_optionalChain([g, 'optionalAccess', _183 => _183.subTotal, 'optionalAccess', _184 => _184.captionItem])?_optionalChain([g, 'optionalAccess', _185 => _185.subTotal, 'optionalAccess', _186 => _186.captionItem]):"";t[0]={content:`${_optionalChain([g, 'optionalAccess', _187 => _187.subTotal, 'optionalAccess', _188 => _188.caption])||"SUB TOTAL"}${i} ${d}`,colSpan:h,styles:{textColor:`#${_optionalChain([e, 'optionalAccess', _189 => _189.txtColor])||"000"}`,fillColor:`#${_optionalChain([e, 'optionalAccess', _190 => _190.bgColor])||"E8E5E5"}`,fontStyle:"bold",halign:"center"}},_optionalChain([e, 'optionalAccess', _191 => _191.grandTotalSetting, 'optionalAccess', _192 => _192.colSpan])&&t.splice(1,_optionalChain([e, 'optionalAccess', _193 => _193.grandTotalSetting, 'optionalAccess', _194 => _194.colSpan])),r.push(t)}}else{let C=(u,E)=>{let t=E[u.key],h=u.key;_optionalChain([u, 'access', _195 => _195.options, 'optionalAccess', _196 => _196.disabledFooter])||(G[h]=(G[h]||0)+Number(t||0));let i=(()=>{switch(_optionalChain([u, 'optionalAccess', _197 => _197.options, 'optionalAccess', _198 => _198.format])){case"RP":return t!==void 0?Number(t||0).toLocaleString("kr-ko"):"";case"GR":return t!==void 0?Number(t||0).toFixed(3):"";case"NUMBER":return t!==void 0?Number(t||0):"";case"IMAGE":return"";case"DATETIME":return t!==void 0?D(t||new Date):"";default:return t!==void 0?_optionalChain([t, 'optionalAccess', _199 => _199.toString, 'call', _200 => _200()]):""}})(),d=_optionalChain([u, 'optionalAccess', _201 => _201.options, 'optionalAccess', _202 => _202.halign])?_optionalChain([u, 'optionalAccess', _203 => _203.options, 'optionalAccess', _204 => _204.halign]):_optionalChain([u, 'optionalAccess', _205 => _205.options, 'optionalAccess', _206 => _206.format])==="RP"||_optionalChain([u, 'optionalAccess', _207 => _207.options, 'optionalAccess', _208 => _208.format])==="GR"||_optionalChain([u, 'optionalAccess', _209 => _209.options, 'optionalAccess', _210 => _210.format])==="NUMBER"||typeof t=="number"?"right":"left",y=_optionalChain([u, 'access', _211 => _211.options, 'optionalAccess', _212 => _212.format])==="IMAGE";return{options:_optionalChain([u, 'optionalAccess', _213 => _213.options]),content:i,foto:y?t:null,styles:{halign:d}}},p=z(l).map(u=>C(u,a));r.push(p)}});let T=z(l);if(!_optionalChain([g, 'optionalAccess', _214 => _214.grandTotal, 'optionalAccess', _215 => _215.disableGrandTotal])){let a=[];T.forEach(t=>{let h=G[t.key],i=["RP","GR","NUMBER"].includes(_optionalChain([t, 'optionalAccess', _216 => _216.options, 'optionalAccess', _217 => _217.format])||""),d=_optionalChain([t, 'optionalAccess', _218 => _218.options, 'optionalAccess', _219 => _219.disabledFooter])?"":(()=>{if(!i)return"";switch(_optionalChain([t, 'access', _220 => _220.options, 'optionalAccess', _221 => _221.format])){case"RP":return Number(h||0).toLocaleString("kr-KO");case"GR":return Number(h||0).toFixed(3);case"NUMBER":return Number(h||0);default:return(h||0).toString()}})();a.push({options:_optionalChain([t, 'optionalAccess', _222 => _222.options]),content:d,styles:{halign:_optionalChain([t, 'optionalAccess', _223 => _223.options, 'optionalAccess', _224 => _224.halign])?t.options.halign:i?"right":"left",textColor:`#${_optionalChain([e, 'optionalAccess', _225 => _225.txtColor])||"000"}`,fillColor:`#${_optionalChain([e, 'optionalAccess', _226 => _226.bgColor])||"E8E5E5"}`,fontStyle:"bold"}})});let C=Number(_optionalChain([e, 'optionalAccess', _227 => _227.grandTotalSetting, 'optionalAccess', _228 => _228.colSpan])||0),n=Math.min(C+1,T.length),p=_optionalChain([g, 'optionalAccess', _229 => _229.grandTotal, 'optionalAccess', _230 => _230.enableCount])?f.length>0?s.reduce((t,h)=>t+h.detail.length,0):s.length:0,u=_optionalChain([g, 'optionalAccess', _231 => _231.grandTotal, 'optionalAccess', _232 => _232.captionItem])||"",E=`${_optionalChain([g, 'optionalAccess', _233 => _233.grandTotal, 'optionalAccess', _234 => _234.caption])||"GRAND TOTAL"}`+(p?` : ${p}`:"")+(u?` ${u}`:"");for(a[0]={content:E,colSpan:n,styles:{textColor:`#${_optionalChain([e, 'optionalAccess', _235 => _235.txtColor])||"000"}`,fillColor:`#${_optionalChain([e, 'optionalAccess', _236 => _236.bgColor])||"E8E5E5"}`,fontStyle:"bold",halign:"center"}},a.splice(1,n-1);a.length<T.length;)a.push({content:"",styles:{textColor:`#${_optionalChain([e, 'optionalAccess', _237 => _237.txtColor])||"000"}`,fillColor:`#${_optionalChain([e, 'optionalAccess', _238 => _238.bgColor])||"E8E5E5"}`,fontStyle:"bold"}});r.push(a)}if(typeof _optionalChain([e, 'optionalAccess', _239 => _239.addRow])=="function"&&_optionalChain([e, 'optionalAccess', _240 => _240.addRow, 'call', _241 => _241(r)]),!_optionalChain([e, 'optionalAccess', _242 => _242.disablePrintDate])){let a=M(l);r.push([{content:`Print Date : ${D(`${new Date}`)}`,colSpan:a,styles:{textColor:`#${_optionalChain([e, 'optionalAccess', _243 => _243.txtColor])||"000"}`,fillColor:`#${_optionalChain([e, 'optionalAccess', _244 => _244.bgColor])||"E8E5E5"}`,fontStyle:"italic"}}])}_jspdfautotable2.default.call(void 0, c,{head:[],body:r,startY:$,theme:_optionalChain([e, 'optionalAccess', _245 => _245.theme])||"plain",rowPageBreak:"avoid",margin:{top:10},bodyStyles:{fontSize:_optionalChain([e, 'optionalAccess', _246 => _246.fontSIze])||8},headStyles:{fontSize:_optionalChain([e, 'optionalAccess', _247 => _247.fontSIze])||8,textColor:`#${_optionalChain([e, 'optionalAccess', _248 => _248.txtColor])||"000"}`,fillColor:`#${_optionalChain([e, 'optionalAccess', _249 => _249.bgColor])||"E8E5E5"}`},tableLineColor:[255,255,255],didParseCell:function(a){let C=a.column.index;_optionalChain([T, 'access', _250 => _250[C], 'optionalAccess', _251 => _251.options, 'optionalAccess', _252 => _252.format])==="IMAGE"&&a.cell.raw&&a.cell.raw.foto&&(a.row.height=20,a.cell.styles.valign="middle",a.cell.styles.halign="center")},didDrawCell:function(a){let{cell:C}=a,p=(C.raw||{}).foto,u=a.column.index;if(_optionalChain([T, 'access', _253 => _253[u], 'optionalAccess', _254 => _254.options, 'optionalAccess', _255 => _255.format])==="IMAGE"&&p){let h=C.x+(C.width-15)/2,i=C.y+(C.height-15)/2;try{c.addImage(p,"JPG",h,i,15,15)}catch(d){console.warn("\u274C Gagal render gambar:",d)}}}}),r=[],$=c.lastAutoTable.finalY;let k=c.internal.getNumberOfPages(),F=c.internal.pageSize.width,B=c.internal.pageSize.height;c.setFontSize(10);for(let a=1;a<k+1;a++){let C=F/2,n=B-10;c.setPage(a),c.text(`${a} of ${k}`,C,n,{align:"center"})}if(typeof _optionalChain([e, 'optionalAccess', _256 => _256.customize])=="function"&&e.customize(c,$,_jspdfautotable2.default),_optionalChain([e, 'optionalAccess', _257 => _257.openNewTab])){let a=c.output("bloburl");window.open(a)}else c.save(`${_optionalChain([e, 'optionalAccess', _258 => _258.titlePdf])||b}.pdf`)},V=et;var ot=l=>{let s=[],f=l.copy?2:1;for(let e=0;e<f;e++){let o=l.data.map(b=>{let g=l.template;for(;/\n!!LOOP\((.+)\)(\{\n(.*\n)+\})\n/gm.exec(g);)g=g.replace(/\n!!LOOP\((.+)\)(\{\n(.*\n)+\})\n/,(c,r,$)=>{let x=$.replace(/^\{/,"").replace(/\}$/,"");return(Array.isArray(b[r])?b[r]:[b[r]]).reduce((P,w)=>P+x.replace(/\{([a-z0-9_]+)\}/gm,G=>{let T=G.replace(/(\{|\})/g,"");if(T.match(/nama_barang/)){let k=T.match(/nama_barang/),F=T==="nama_barang2"?[20,40]:T==="nama_barang3"?[40,60]:[0,20];return _optionalChain([w, 'access', _259 => _259[k], 'optionalAccess', _260 => _260.slice, 'call', _261 => _261(...F), 'access', _262 => _262.trim, 'call', _263 => _263()])||""}if(T.match(/deskripsi_jual/)){let k=T.match(/deskripsi_jual/),F=T==="deskripsi_jual2"?[20,40]:T==="deskripsi_jual3"?[40,60]:[0,20];return _optionalChain([w, 'access', _264 => _264[k], 'optionalAccess', _265 => _265.slice, 'call', _266 => _266(...F), 'access', _267 => _267.trim, 'call', _268 => _268()])||""}if(T.match(/deskripsi/)){let k=T.match(/deskripsi/),F=T==="deskripsi2"?[20,40]:T==="deskripsi3"?[40,60]:[0,20];return _optionalChain([w, 'access', _269 => _269[k], 'optionalAccess', _270 => _270.slice, 'call', _271 => _271(...F), 'access', _272 => _272.trim, 'call', _273 => _273()])||""}return w[T]||""}),"").replace(/\n(\s)+\n/gm,`
`)});return g.replace(/\{([a-z0-9_]+)\}/gm,c=>{let r=c.replace(/(\{|\})/g,"");return r.match(/auto_cut/)?`
VA`:b[r]||""}).replace(/\n(\s)+\n/gm,`
`).replace(/~new_line~/gm,`
`).replace(/!!LOOP\(detail\)/g,"").replace(/[}{]/g,"")});for(let b in o)o[b]+=`

`;s.push(...o)}return s},nt=async(l,s)=>{let f=ot(l),e=new Blob([_optionalChain([f, 'optionalAccess', _274 => _274.join, 'call', _275 => _275(`
`)])||""],{type:"text/plain"}),o=document.createElement("a");o.href=URL.createObjectURL(e),o.download=s,document.body.appendChild(o),o.click(),document.body.removeChild(o)},Y=nt;var Gt=({columns:l,data:s,grouping:f,date:e,type:o,txtSetting:b,pdfSetting:g,excelSetting:c,title:r,footerSetting:$})=>{let x={data:[_optionalChain([b, 'optionalAccess', _276 => _276.dataTxt])],template:_optionalChain([b, 'optionalAccess', _277 => _277.templateTxt]),copy:_optionalChain([b, 'optionalAccess', _278 => _278.copy])};if(s.length===0)throw new Error("Data is required");if(o.length===0)throw new Error("Type is required");if(!W(o))throw new Error('Type Export must use ["EXCEL", "PDF", "TXT", "ALL"]');o.forEach(I=>{I==="PDF"?V({pdfSetting:g,date:e,data:s,type:o,columns:l,grouping:f,title:r,footerSetting:$}):I==="TXT"?Y(x,_optionalChain([b, 'optionalAccess', _279 => _279.titleTxt])||""):I==="EXCEL"?X({date:e,data:s,type:o,columns:l,grouping:f,excelSetting:c,title:r,footerSetting:$}):(X({date:e,data:s,type:o,columns:l,grouping:f,excelSetting:c,title:r}),V({pdfSetting:g,date:e,data:s,type:o,columns:l,grouping:f,title:r}),Y(x,_optionalChain([b, 'optionalAccess', _280 => _280.titleTxt])||""))})};exports.ExportData = Gt;
//# sourceMappingURL=index.js.map