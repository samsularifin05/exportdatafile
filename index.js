"use strict";Object.defineProperty(exports, "__esModule", {value: true}); function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; } function _nullishCoalesce(lhs, rhsFn) { if (lhs != null) { return lhs; } else { return rhsFn(); } } function _optionalChain(ops) { let lastAccessLHS = undefined; let value = ops[0]; let i = 1; while (i < ops.length) { const op = ops[i]; const fn = ops[i + 1]; i += 2; if ((op === 'optionalAccess' || op === 'optionalCall') && value == null) { return undefined; } if (op === 'access' || op === 'optionalAccess') { lastAccessLHS = value; value = fn(value); } else if (op === 'call' || op === 'optionalCall') { value = fn((...args) => value.call(lastAccessLHS, ...args)); lastAccessLHS = undefined; } } return value; }var H=["EXCEL","PDF","TXT","ALL"];function I(r){let i=new Date(r),g=i.getFullYear(),t=String(i.getMonth()+1).padStart(2,"0"),a=String(i.getDate()).padStart(2,"0"),b=String(i.getHours()).padStart(2,"0"),u=String(i.getMinutes()).padStart(2,"0"),m=String(i.getSeconds()).padStart(2,"0");return`${a}-${t}-${g} ${b}:${u}:${m}`}function Y(r){return r.every(i=>H.includes(i))}function A(r){let i=0;return r.forEach(g=>{g.child&&g.child.length>0?i+=A(g.child):i+=1}),i}var N=r=>{let i=[];return r.forEach(g=>{g.child&&g.child.length>0?i.push(...N(g.child)):i.push(g)}),i},B=r=>r.split("_").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" ");var _exceljs = require('exceljs'); var _exceljs2 = _interopRequireDefault(_exceljs);var J=async({columns:r,data:i,grouping:g,date:t,excelSetting:a,title:b,footerSetting:u})=>{let m=new _exceljs2.default.Workbook;r=r.filter(o=>!_optionalChain([o, 'access', _2 => _2.options, 'optionalAccess', _3 => _3.disabledColumn]));let n=m.addWorksheet(b||_optionalChain([a, 'optionalAccess', _4 => _4.titleExcel])),F=A(r),k=n.addRow([]);k.getCell(1).value=b||_optionalChain([a, 'optionalAccess', _5 => _5.titleExcel]),k.getCell(1).alignment={horizontal:"center"};let D=n.getColumn(F).letter;if(n.mergeCells(`A${k.number}:${D}${k.number}`),k.eachCell(o=>{o.font={color:{argb:"000000"},bold:!0,size:12}}),t){let o=n.addRow([]);o.getCell(1).value=`${t.caption?t.caption:"Tanggal "} : ${_optionalChain([t, 'optionalAccess', _6 => _6.start_date])} ${_optionalChain([t, 'optionalAccess', _7 => _7.end_date])?`s/d ${_optionalChain([t, 'optionalAccess', _8 => _8.end_date])}`:""}`,o.getCell(1).alignment={horizontal:"center"},n.mergeCells(`A${o.number}:${D}${o.number}`),o.eachCell(l=>{l.font={color:{argb:"00000"},bold:!0,size:12}})}let v=n.addRow([]);v.getCell(1).value=_optionalChain([a, 'optionalAccess', _9 => _9.additionalTextHeader])||"",v.getCell(1).alignment={horizontal:"center"},n.mergeCells(`A${v.number}:${D}${v.number}`),v.eachCell(o=>{o.font={color:{argb:"000000"},bold:!0,size:12}});let L=r.some(o=>o.child&&o.child.length>0),R=n.addRow([]),x=L?n.addRow([]):null;r.forEach(o=>{if(o.child&&o.child.length>0){let l=R.actualCellCount+1,$=o.child.length;R.getCell(l).value=o.label,$>1&&n.mergeCells(R.number,l,R.number,l+$-1);for(let p=l;p<l+$;p++){let s=R.getCell(p);s.fill={type:"pattern",pattern:"solid",fgColor:{argb:_optionalChain([a, 'optionalAccess', _10 => _10.bgColor])||"E8E5E5"}},s.font={color:{argb:_optionalChain([a, 'optionalAccess', _11 => _11.txtColor])||"000000"},bold:!0},s.alignment={horizontal:"center",vertical:"middle"}}o.child.forEach((p,s)=>{if(x){let d=x.getCell(l+s);d.value=p.label,d.fill={type:"pattern",pattern:"solid",fgColor:{argb:_optionalChain([a, 'optionalAccess', _12 => _12.bgColor])||"E8E5E5"}},d.font={color:{argb:_optionalChain([a, 'optionalAccess', _13 => _13.txtColor])||"000000"},bold:!0};let C=_optionalChain([p, 'access', _14 => _14.options, 'optionalAccess', _15 => _15.halign])||(["RP","GR","NUMBER"].includes(_optionalChain([p, 'optionalAccess', _16 => _16.options, 'optionalAccess', _17 => _17.format])||"")?"right":"left"),c=_optionalChain([p, 'access', _18 => _18.options, 'optionalAccess', _19 => _19.valign])||"middle";d.alignment={horizontal:C,vertical:c}}})}else{let l=R.actualCellCount+1;R.getCell(l).value=o.label,R.getCell(l).fill={type:"pattern",pattern:"solid",fgColor:{argb:_optionalChain([a, 'optionalAccess', _20 => _20.bgColor])||"E8E5E5"}},R.getCell(l).font={color:{argb:_optionalChain([a, 'optionalAccess', _21 => _21.txtColor])||"000000"},bold:!0},R.getCell(l).alignment={horizontal:_optionalChain([o, 'access', _22 => _22.options, 'optionalAccess', _23 => _23.halign])||"center",vertical:_optionalChain([o, 'access', _24 => _24.options, 'optionalAccess', _25 => _25.valign])||"middle"},L&&x&&n.mergeCells(R.number,l,x.number,l)}});let h={};i.forEach(o=>{if(g.length>0){let l=A(r),$=g.map(c=>o[c]!==void 0?`${B(c)} : ${o[c]}`:"").filter(Boolean).join("  |  "),p=n.addRow([$]);n.mergeCells(`A${p.number}:${String.fromCharCode(64+l)}${p.number}`),p.getCell(1).alignment={horizontal:"left"},p.getCell(1).font={bold:!0};let s={};o.detail.forEach(c=>{let T=N(r).map(f=>{let y=_optionalChain([f, 'optionalAccess', _26 => _26.options, 'optionalAccess', _27 => _27.format])==="DATETIME"?I(c[f.key]):c[f.key],P={horizontal:_optionalChain([f, 'optionalAccess', _28 => _28.options, 'optionalAccess', _29 => _29.halign])?_optionalChain([f, 'optionalAccess', _30 => _30.options, 'optionalAccess', _31 => _31.halign]):_optionalChain([f, 'optionalAccess', _32 => _32.options, 'optionalAccess', _33 => _33.format])==="RP"||_optionalChain([f, 'optionalAccess', _34 => _34.options, 'optionalAccess', _35 => _35.format])==="GR"||_optionalChain([f, 'optionalAccess', _36 => _36.options, 'optionalAccess', _37 => _37.format])==="NUMBER"?"right":"left"},M=f.key;return h[M]=(h[M]||0)+Number(y),s[M]=(s[M]||0)+Number(y),{value:y,alignment:P,numFmt:_optionalChain([f, 'optionalAccess', _38 => _38.options, 'optionalAccess', _39 => _39.format])==="RP"?"#,##0":_optionalChain([f, 'optionalAccess', _40 => _40.options, 'optionalAccess', _41 => _41.format])==="GR"?"#,##0.000":void 0}}),G=n.addRow(T.map(f=>f.value));T.forEach((f,y)=>{let P=G.getCell(y+1);P.alignment=f.alignment,f.numFmt&&(P.numFmt=f.numFmt)})});let d=N(r),C=n.addRow(r.map(()=>null));d.forEach((c,w)=>{if(_optionalChain([c, 'optionalAccess', _42 => _42.options, 'optionalAccess', _43 => _43.format])==="RP"||_optionalChain([c, 'optionalAccess', _44 => _44.options, 'optionalAccess', _45 => _45.format])==="GR"||_optionalChain([c, 'optionalAccess', _46 => _46.options, 'optionalAccess', _47 => _47.format])==="NUMBER"){let G=i.length+4-1,f=`SUM(${String.fromCharCode(65+w)}4:${String.fromCharCode(65+w)}${G})`,y=C.getCell(w+1),P=_optionalChain([u, 'optionalAccess', _48 => _48.subTotal, 'optionalAccess', _49 => _49.enableCount])&&g.length>0?" : "+o.detail.length:"",M=_optionalChain([u, 'optionalAccess', _50 => _50.subTotal, 'optionalAccess', _51 => _51.captionItem])?_optionalChain([u, 'optionalAccess', _52 => _52.subTotal, 'optionalAccess', _53 => _53.captionItem]):"";C.getCell(1).value=`${_optionalChain([u, 'optionalAccess', _54 => _54.subTotal, 'optionalAccess', _55 => _55.caption])||"SUB TOTAL"} ${P} ${M}`,C.getCell(1).alignment={horizontal:"center"},y.numFmt=_optionalChain([c, 'optionalAccess', _56 => _56.options, 'optionalAccess', _57 => _57.format])==="GR"?"#,##0.000":"#,##0",y.value={formula:f},C.getCell(w+1).value=_optionalChain([c, 'optionalAccess', _58 => _58.options, 'access', _59 => _59.disabledFooter])?"":s[c.key]}else C.getCell(w+1).value=""}),_optionalChain([a, 'optionalAccess', _60 => _60.grandTotalSetting, 'optionalAccess', _61 => _61.colSpan])&&n.mergeCells(`A${C.number}:${String.fromCharCode(64+Number(_optionalChain([a, 'optionalAccess', _62 => _62.grandTotalSetting, 'optionalAccess', _63 => _63.colSpan])))}${C.number}`),C.eachCell(c=>{c.fill={type:"pattern",pattern:"solid",fgColor:{argb:_optionalChain([a, 'optionalAccess', _64 => _64.bgColor])||"#E8E5E5"},bgColor:{argb:_optionalChain([a, 'optionalAccess', _65 => _65.bgColor])||"#E8E5E5"}},c.font={color:{argb:_optionalChain([a, 'optionalAccess', _66 => _66.txtColor])},bold:!0}})}else{let $=N(r).map(s=>{let d=_optionalChain([s, 'optionalAccess', _67 => _67.options, 'optionalAccess', _68 => _68.format])==="DATETIME"?I(o[s.key]):o[s.key],C={vertical:"middle",horizontal:_optionalChain([s, 'optionalAccess', _69 => _69.options, 'optionalAccess', _70 => _70.halign])?_optionalChain([s, 'optionalAccess', _71 => _71.options, 'optionalAccess', _72 => _72.halign]):_optionalChain([s, 'optionalAccess', _73 => _73.options, 'optionalAccess', _74 => _74.format])==="RP"||_optionalChain([s, 'optionalAccess', _75 => _75.options, 'optionalAccess', _76 => _76.format])==="GR"||_optionalChain([s, 'optionalAccess', _77 => _77.options, 'optionalAccess', _78 => _78.format])==="NUMBER"?"right":"left"},c=s.key;return h[c]=(h[c]||0)+Number(d),{value:d,options:_optionalChain([s, 'optionalAccess', _79 => _79.options]),alignment:C,numFmt:_optionalChain([s, 'optionalAccess', _80 => _80.options, 'optionalAccess', _81 => _81.format])==="RP"?"#,##0":_optionalChain([s, 'optionalAccess', _82 => _82.options, 'optionalAccess', _83 => _83.format])==="GR"?"#,##0.000":void 0}}),p=n.addRow($.map(s=>s.value));$.forEach((s,d)=>{let C=p.getCell(d+1),c=s.alignment.vertical?String(s.alignment.vertical||"bottom"):"bottom",w="";(c==="middle"||c==="bottom"||c==="justify"||c==="distributed"||c==="top")&&(w=c),C.alignment={horizontal:s.alignment.horizontal,vertical:w},s.numFmt&&(C.numFmt=s.numFmt)})}});let E=n.addRow(r.map(()=>null));N(r).forEach((o,l)=>{if(_optionalChain([o, 'optionalAccess', _84 => _84.options, 'optionalAccess', _85 => _85.format])==="RP"||_optionalChain([o, 'optionalAccess', _86 => _86.options, 'optionalAccess', _87 => _87.format])==="GR"||_optionalChain([o, 'optionalAccess', _88 => _88.options, 'optionalAccess', _89 => _89.format])==="NUMBER"){let p=i.length+4-1,s=`SUM(${String.fromCharCode(65+l)}4:${String.fromCharCode(65+l)}${p})`,d=E.getCell(l+1),C=_optionalChain([u, 'optionalAccess', _90 => _90.grandTotal, 'optionalAccess', _91 => _91.enableCount])?g.length>0?" : "+i.map(T=>T.detail.length).reduce((T,G)=>T+G,0):" : "+i.length:"",c=_optionalChain([u, 'optionalAccess', _92 => _92.grandTotal, 'optionalAccess', _93 => _93.captionItem])?_optionalChain([u, 'optionalAccess', _94 => _94.grandTotal, 'optionalAccess', _95 => _95.captionItem]):"",w=`${_optionalChain([u, 'optionalAccess', _96 => _96.grandTotal, 'optionalAccess', _97 => _97.caption])||"GRAND TOTAL"} ${C} ${c}`;E.getCell(1).value=w,E.getCell(1).alignment={horizontal:"center"},d.numFmt=_optionalChain([o, 'optionalAccess', _98 => _98.options, 'optionalAccess', _99 => _99.format])==="GR"?"#,##0.000":"#,##0",d.value={formula:s},E.getCell(l+1).value=_optionalChain([o, 'optionalAccess', _100 => _100.options, 'access', _101 => _101.disabledFooter])?"":h[o.key]}else E.getCell(l+1).value=""}),_optionalChain([a, 'optionalAccess', _102 => _102.grandTotalSetting, 'optionalAccess', _103 => _103.colSpan])&&n.mergeCells(`A${E.number}:${String.fromCharCode(64+Number(_optionalChain([a, 'optionalAccess', _104 => _104.grandTotalSetting, 'optionalAccess', _105 => _105.colSpan])))}${E.number}`),E.eachCell(o=>{o.fill={type:"pattern",pattern:"solid",fgColor:{argb:_optionalChain([a, 'optionalAccess', _106 => _106.bgColor])||"#E8E5E5"},bgColor:{argb:_optionalChain([a, 'optionalAccess', _107 => _107.bgColor])||"#E8E5E5"}},o.font={color:{argb:_optionalChain([a, 'optionalAccess', _108 => _108.txtColor])},bold:!0}}),_optionalChain([a, 'optionalAccess', _109 => _109.customize])&&a.customize(n);let _=await m.xlsx.writeBuffer(),j=new Blob([_],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),e=document.createElement("a");e.href=URL.createObjectURL(j),e.download=`${_optionalChain([a, 'optionalAccess', _110 => _110.titleExcel])||b}.xlsx`,document.body.appendChild(e),e.click(),document.body.removeChild(e)},O=J;var _jspdf = require('jspdf'); var _jspdf2 = _interopRequireDefault(_jspdf);var _jspdfautotable = require('jspdf-autotable'); var _jspdfautotable2 = _interopRequireDefault(_jspdfautotable);var q=({columns:r,data:i,grouping:g,pdfSetting:t,date:a,title:b,footerSetting:u})=>{let m=new (0, _jspdf2.default)(_optionalChain([t, 'optionalAccess', _111 => _111.orientation]),_optionalChain([t, 'optionalAccess', _112 => _112.unit]),[_optionalChain([t, 'optionalAccess', _113 => _113.width])||297,_optionalChain([t, 'optionalAccess', _114 => _114.height])||210]),n=[],F=a?30:20;r=r.filter(e=>!_optionalChain([e, 'access', _115 => _115.options, 'optionalAccess', _116 => _116.disabledColumn])),m.setFontSize(10);let k=m.internal.pageSize.getWidth(),D=m.splitTextToSize(_optionalChain([t, 'optionalAccess', _117 => _117.textHeaderLeft])||"",110);m.text(D,15,18),m.text(`${b||_optionalChain([t, 'optionalAccess', _118 => _118.titlePdf])}`,k-15,18,{align:"right"}),a&&m.text(`${a.caption?a.caption:"TANGGAL "} : ${_optionalChain([a, 'optionalAccess', _119 => _119.start_date])} ${_optionalChain([a, 'optionalAccess', _120 => _120.end_date])?`s/d ${_optionalChain([a, 'optionalAccess', _121 => _121.end_date])}`:""}`,k-15,22,{align:"right"}),m.setProperties({title:b||_optionalChain([t, 'optionalAccess', _122 => _122.titlePdf])}),_optionalChain([t, 'optionalAccess', _123 => _123.finalY])&&(console.log(t.finalY),F=t.finalY);let v=[],L=[],R=r.some(e=>e.child&&e.child.length>0);r.forEach(e=>{let o={textColor:`#${_optionalChain([t, 'optionalAccess', _124 => _124.txtColor])||"000"}`,fillColor:`#${_optionalChain([t, 'optionalAccess', _125 => _125.bgColor])||"E8E5E5"}`,fontStyle:"bold",..._optionalChain([e, 'optionalAccess', _126 => _126.options, 'optionalAccess', _127 => _127.valign])?{valign:e.options.valign}:{},halign:_nullishCoalesce(_optionalChain([e, 'optionalAccess', _128 => _128.options, 'optionalAccess', _129 => _129.halign]), () => ((["RP","GR","NUMBER"].includes(_optionalChain([e, 'optionalAccess', _130 => _130.options, 'optionalAccess', _131 => _131.format])||"")?"right":"left")))};R?e.child&&e.child.length>0?(v.push({content:e.label,colSpan:e.child.length,styles:o}),e.child.forEach(l=>{L.push({content:l.label,key:l.key,options:l.options,styles:{...o,halign:_nullishCoalesce(_optionalChain([l, 'optionalAccess', _132 => _132.options, 'optionalAccess', _133 => _133.halign]), () => ((["RP","GR","NUMBER"].includes(_optionalChain([l, 'optionalAccess', _134 => _134.options, 'optionalAccess', _135 => _135.format])||"")?"right":"left")))}})})):v.push({content:e.label,rowSpan:2,key:e.key,options:e.options,styles:o}):v.push({content:e.label,key:e.key,options:e.options,styles:o})}),n.push(v),R&&L.length>0&&n.push(L);let x={};i.forEach(e=>{if(g.length>0){let o=A(r),$=[{content:g.map(T=>e[T]!==void 0?`${B(T)} : ${e[T]}`:"").filter(Boolean).join("  |  "),colSpan:o,styles:{fontStyle:"bold",halign:"left"}}];n.push($);let p={},s=N(r);e.detail.forEach(T=>{let G=s.map(f=>{let y=T[f.key],P=f.key;return x[P]=(x[P]||0)+Number(y||0),p[P]=(p[P]||0)+Number(y||0),{content:(()=>{switch(_optionalChain([f, 'optionalAccess', _136 => _136.options, 'optionalAccess', _137 => _137.format])){case"RP":return y!==void 0?Number(y||0).toLocaleString("kr-ko"):"";case"GR":return y!==void 0?Number(y||0).toFixed(3):"";case"NUMBER":return y!==void 0?Number(y||0):"";case"DATETIME":return y!==void 0?I(y||new Date):"";default:return y!==void 0?y.toString():""}})(),styles:{halign:_optionalChain([f, 'optionalAccess', _138 => _138.options, 'optionalAccess', _139 => _139.halign])?_optionalChain([f, 'optionalAccess', _140 => _140.options, 'optionalAccess', _141 => _141.halign]):_optionalChain([f, 'optionalAccess', _142 => _142.options, 'optionalAccess', _143 => _143.format])==="RP"||_optionalChain([f, 'optionalAccess', _144 => _144.options, 'optionalAccess', _145 => _145.format])==="GR"||_optionalChain([f, 'optionalAccess', _146 => _146.options, 'optionalAccess', _147 => _147.format])==="NUMBER"||typeof y=="number"?"right":"left"}}});n.push(G)});let d=[];s.forEach(T=>{let G=p[T.key];_optionalChain([T, 'optionalAccess', _148 => _148.options, 'optionalAccess', _149 => _149.format])==="RP"||_optionalChain([T, 'optionalAccess', _150 => _150.options, 'optionalAccess', _151 => _151.format])==="GR"||_optionalChain([T, 'optionalAccess', _152 => _152.options, 'optionalAccess', _153 => _153.format])==="NUMBER"?d.push({content:_optionalChain([T, 'optionalAccess', _154 => _154.options, 'optionalAccess', _155 => _155.disabledFooter])?"":(()=>{switch(_optionalChain([T, 'optionalAccess', _156 => _156.options, 'optionalAccess', _157 => _157.format])){case"RP":return G.toLocaleString("kr-ko");case"GR":return G.toFixed(3);case"NUMBER":return G;default:return G.toString()}})(),styles:{halign:_optionalChain([T, 'optionalAccess', _158 => _158.options, 'optionalAccess', _159 => _159.halign])||"right",textColor:`#${_optionalChain([t, 'optionalAccess', _160 => _160.txtColor])||"000"}`,fillColor:`#${_optionalChain([t, 'optionalAccess', _161 => _161.bgColor])||"E8E5E5"}`,fontStyle:"bold"}}):d.push({content:"",styles:{textColor:`#${_optionalChain([t, 'optionalAccess', _162 => _162.txtColor])||"000"}`,fillColor:`#${_optionalChain([t, 'optionalAccess', _163 => _163.bgColor])||"E8E5E5"}`,fontStyle:"bold"}})});let C=_optionalChain([t, 'optionalAccess', _164 => _164.grandTotalSetting, 'optionalAccess', _165 => _165.colSpan])?Number(_optionalChain([t, 'optionalAccess', _166 => _166.grandTotalSetting, 'optionalAccess', _167 => _167.colSpan])||0)+1:0,c=_optionalChain([u, 'optionalAccess', _168 => _168.subTotal, 'optionalAccess', _169 => _169.enableCount])&&g.length>0?" : "+e.detail.length:"",w=_optionalChain([u, 'optionalAccess', _170 => _170.subTotal, 'optionalAccess', _171 => _171.captionItem])?_optionalChain([u, 'optionalAccess', _172 => _172.subTotal, 'optionalAccess', _173 => _173.captionItem]):"";d[0]={content:`${_optionalChain([u, 'optionalAccess', _174 => _174.subTotal, 'optionalAccess', _175 => _175.caption])||"SUB TOTAL"}${c} ${w}`,colSpan:C,styles:{textColor:`#${_optionalChain([t, 'optionalAccess', _176 => _176.txtColor])||"000"}`,fillColor:`#${_optionalChain([t, 'optionalAccess', _177 => _177.bgColor])||"E8E5E5"}`,fontStyle:"bold",halign:"center"}},_optionalChain([t, 'optionalAccess', _178 => _178.grandTotalSetting, 'optionalAccess', _179 => _179.colSpan])&&d.splice(1,_optionalChain([t, 'optionalAccess', _180 => _180.grandTotalSetting, 'optionalAccess', _181 => _181.colSpan])),n.push(d)}else{let o=(p,s)=>{let d=s[p.key],C=p.key;_optionalChain([p, 'access', _182 => _182.options, 'optionalAccess', _183 => _183.disabledFooter])||(x[C]=(x[C]||0)+Number(d||0));let c=(()=>{switch(_optionalChain([p, 'optionalAccess', _184 => _184.options, 'optionalAccess', _185 => _185.format])){case"RP":return d!==void 0?Number(d||0).toLocaleString("kr-ko"):"";case"GR":return d!==void 0?Number(d||0).toFixed(3):"";case"NUMBER":return d!==void 0?Number(d||0):"";case"DATETIME":return d!==void 0?I(d||new Date):"";default:return d!==void 0?_optionalChain([d, 'optionalAccess', _186 => _186.toString, 'call', _187 => _187()]):""}})(),w=_optionalChain([p, 'optionalAccess', _188 => _188.options, 'optionalAccess', _189 => _189.halign])?_optionalChain([p, 'optionalAccess', _190 => _190.options, 'optionalAccess', _191 => _191.halign]):_optionalChain([p, 'optionalAccess', _192 => _192.options, 'optionalAccess', _193 => _193.format])==="RP"||_optionalChain([p, 'optionalAccess', _194 => _194.options, 'optionalAccess', _195 => _195.format])==="GR"||_optionalChain([p, 'optionalAccess', _196 => _196.options, 'optionalAccess', _197 => _197.format])==="NUMBER"||typeof d=="number"?"right":"left";return{options:_optionalChain([p, 'optionalAccess', _198 => _198.options]),content:c,styles:{halign:w}}},$=N(r).map(p=>o(p,e));n.push($)}});let h=N(r),E=[];if(h.forEach(e=>{let o=x[e.key],l=["RP","GR","NUMBER"].includes(_optionalChain([e, 'optionalAccess', _199 => _199.options, 'optionalAccess', _200 => _200.format])||""),$=_optionalChain([e, 'optionalAccess', _201 => _201.options, 'optionalAccess', _202 => _202.disabledFooter])?"":(()=>{if(!l)return"";switch(_optionalChain([e, 'access', _203 => _203.options, 'optionalAccess', _204 => _204.format])){case"RP":return Number(o||0).toLocaleString("kr-KO");case"GR":return Number(o||0).toFixed(3);case"NUMBER":return Number(o||0);default:return(o||0).toString()}})();E.push({options:_optionalChain([e, 'optionalAccess', _205 => _205.options]),content:$,styles:{halign:_optionalChain([e, 'optionalAccess', _206 => _206.options, 'optionalAccess', _207 => _207.halign])?e.options.halign:l?"right":"left",textColor:`#${_optionalChain([t, 'optionalAccess', _208 => _208.txtColor])||"000"}`,fillColor:`#${_optionalChain([t, 'optionalAccess', _209 => _209.bgColor])||"E8E5E5"}`,fontStyle:"bold"}})}),!_optionalChain([t, 'optionalAccess', _210 => _210.grandTotalSetting, 'optionalAccess', _211 => _211.disableGrandTotal])){let e=Number(_optionalChain([t, 'optionalAccess', _212 => _212.grandTotalSetting, 'optionalAccess', _213 => _213.colSpan])||0),o=Math.min(e+1,h.length),l=_optionalChain([u, 'optionalAccess', _214 => _214.grandTotal, 'optionalAccess', _215 => _215.enableCount])?g.length>0?i.reduce((s,d)=>s+d.detail.length,0):i.length:0,$=_optionalChain([u, 'optionalAccess', _216 => _216.grandTotal, 'optionalAccess', _217 => _217.captionItem])||"",p=`${_optionalChain([u, 'optionalAccess', _218 => _218.grandTotal, 'optionalAccess', _219 => _219.caption])||"GRAND TOTAL"}`+(l?` : ${l}`:"")+($?` ${$}`:"");for(E[0]={content:p,colSpan:o,styles:{textColor:`#${_optionalChain([t, 'optionalAccess', _220 => _220.txtColor])||"000"}`,fillColor:`#${_optionalChain([t, 'optionalAccess', _221 => _221.bgColor])||"E8E5E5"}`,fontStyle:"bold",halign:"center"}},E.splice(1,o-1);E.length<h.length;)E.push({content:"",styles:{textColor:`#${_optionalChain([t, 'optionalAccess', _222 => _222.txtColor])||"000"}`,fillColor:`#${_optionalChain([t, 'optionalAccess', _223 => _223.bgColor])||"E8E5E5"}`,fontStyle:"bold"}});n.push(E)}if(typeof _optionalChain([t, 'optionalAccess', _224 => _224.addRow])=="function"&&_optionalChain([t, 'optionalAccess', _225 => _225.addRow, 'call', _226 => _226(n)]),!_optionalChain([t, 'optionalAccess', _227 => _227.disablePrintDate])){let e=A(r);n.push([{content:`Print Date : ${I(`${new Date}`)}`,colSpan:e,styles:{textColor:`#${_optionalChain([t, 'optionalAccess', _228 => _228.txtColor])||"000"}`,fillColor:`#${_optionalChain([t, 'optionalAccess', _229 => _229.bgColor])||"E8E5E5"}`,fontStyle:"italic"}}])}_jspdfautotable2.default.call(void 0, m,{head:[],body:n,startY:F,theme:_optionalChain([t, 'optionalAccess', _230 => _230.theme])||"plain",rowPageBreak:"avoid",margin:{top:10},bodyStyles:{fontSize:_optionalChain([t, 'optionalAccess', _231 => _231.fontSIze])||8},headStyles:{fontSize:_optionalChain([t, 'optionalAccess', _232 => _232.fontSIze])||8,textColor:`#${_optionalChain([t, 'optionalAccess', _233 => _233.txtColor])||"000"}`,fillColor:`#${_optionalChain([t, 'optionalAccess', _234 => _234.bgColor])||"E8E5E5"}`},tableLineColor:[255,255,255]}),n=[],F=m.lastAutoTable.finalY;let z=m.internal.getNumberOfPages(),_=m.internal.pageSize.width,j=m.internal.pageSize.height;m.setFontSize(10);for(let e=1;e<z+1;e++){let o=_/2,l=j-10;m.setPage(e),m.text(`${e} of ${z}`,o,l,{align:"center"})}if(typeof _optionalChain([t, 'optionalAccess', _235 => _235.customize])=="function"&&t.customize(m,F,_jspdfautotable2.default),_optionalChain([t, 'optionalAccess', _236 => _236.openNewTab])){let e=m.output("bloburl");window.open(e)}else m.save(`${_optionalChain([t, 'optionalAccess', _237 => _237.titlePdf])||b}.pdf`)},S=q;var Q=r=>{let i=[],g=r.copy?2:1;for(let t=0;t<g;t++){let a=r.data.map(b=>{let u=r.template;for(;/\n!!LOOP\((.+)\)(\{\n(.*\n)+\})\n/gm.exec(u);)u=u.replace(/\n!!LOOP\((.+)\)(\{\n(.*\n)+\})\n/,(m,n,F)=>{let k=F.replace(/^\{/,"").replace(/\}$/,"");return(Array.isArray(b[n])?b[n]:[b[n]]).reduce((L,R)=>L+k.replace(/\{([a-z0-9_]+)\}/gm,x=>{let h=x.replace(/(\{|\})/g,"");if(h.match(/nama_barang/)){let E=h.match(/nama_barang/),z=h==="nama_barang2"?[20,40]:h==="nama_barang3"?[40,60]:[0,20];return _optionalChain([R, 'access', _238 => _238[E], 'optionalAccess', _239 => _239.slice, 'call', _240 => _240(...z), 'access', _241 => _241.trim, 'call', _242 => _242()])||""}if(h.match(/deskripsi_jual/)){let E=h.match(/deskripsi_jual/),z=h==="deskripsi_jual2"?[20,40]:h==="deskripsi_jual3"?[40,60]:[0,20];return _optionalChain([R, 'access', _243 => _243[E], 'optionalAccess', _244 => _244.slice, 'call', _245 => _245(...z), 'access', _246 => _246.trim, 'call', _247 => _247()])||""}if(h.match(/deskripsi/)){let E=h.match(/deskripsi/),z=h==="deskripsi2"?[20,40]:h==="deskripsi3"?[40,60]:[0,20];return _optionalChain([R, 'access', _248 => _248[E], 'optionalAccess', _249 => _249.slice, 'call', _250 => _250(...z), 'access', _251 => _251.trim, 'call', _252 => _252()])||""}return R[h]||""}),"").replace(/\n(\s)+\n/gm,`
`)});return u.replace(/\{([a-z0-9_]+)\}/gm,m=>{let n=m.replace(/(\{|\})/g,"");return n.match(/auto_cut/)?`
VA`:b[n]||""}).replace(/\n(\s)+\n/gm,`
`).replace(/~new_line~/gm,`
`).replace(/!!LOOP\(detail\)/g,"").replace(/[}{]/g,"")});for(let b in a)a[b]+=`

`;i.push(...a)}return i},Z=async(r,i)=>{let g=Q(r),t=new Blob([_optionalChain([g, 'optionalAccess', _253 => _253.join, 'call', _254 => _254(`
`)])||""],{type:"text/plain"}),a=document.createElement("a");a.href=URL.createObjectURL(t),a.download=i,document.body.appendChild(a),a.click(),document.body.removeChild(a)},X=Z;var Rt=({columns:r,data:i,grouping:g,date:t,type:a,txtSetting:b,pdfSetting:u,excelSetting:m,title:n,footerSetting:F})=>{let k={data:[_optionalChain([b, 'optionalAccess', _255 => _255.dataTxt])],template:_optionalChain([b, 'optionalAccess', _256 => _256.templateTxt]),copy:_optionalChain([b, 'optionalAccess', _257 => _257.copy])};if(i.length===0)throw new Error("Data is required");if(a.length===0)throw new Error("Type is required");if(!Y(a))throw new Error('Type Export must use ["EXCEL", "PDF", "TXT", "ALL"]');a.forEach(D=>{D==="PDF"?S({pdfSetting:u,date:t,data:i,type:a,columns:r,grouping:g,title:n,footerSetting:F}):D==="TXT"?X(k,_optionalChain([b, 'optionalAccess', _258 => _258.titleTxt])||""):D==="EXCEL"?O({date:t,data:i,type:a,columns:r,grouping:g,excelSetting:m,title:n,footerSetting:F}):(O({date:t,data:i,type:a,columns:r,grouping:g,excelSetting:m,title:n}),S({pdfSetting:u,date:t,data:i,type:a,columns:r,grouping:g,title:n}),X(k,_optionalChain([b, 'optionalAccess', _259 => _259.titleTxt])||""))})};exports.ExportData = Rt;
//# sourceMappingURL=index.js.map