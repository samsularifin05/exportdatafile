"use strict";Object.defineProperty(exports, "__esModule", {value: true}); function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; } function _nullishCoalesce(lhs, rhsFn) { if (lhs != null) { return lhs; } else { return rhsFn(); } } function _optionalChain(ops) { let lastAccessLHS = undefined; let value = ops[0]; let i = 1; while (i < ops.length) { const op = ops[i]; const fn = ops[i + 1]; i += 2; if ((op === 'optionalAccess' || op === 'optionalCall') && value == null) { return undefined; } if (op === 'access' || op === 'optionalAccess') { lastAccessLHS = value; value = fn(value); } else if (op === 'call' || op === 'optionalCall') { value = fn((...args) => value.call(lastAccessLHS, ...args)); lastAccessLHS = undefined; } } return value; }var V=["EXCEL","PDF","TXT","ALL"];function F(s,f=!1){let u=new Date(s),t=new Date(u.getTime()+7*60*60*1e3),n=t.getUTCFullYear(),h=String(t.getUTCMonth()+1).padStart(2,"0"),g=String(t.getUTCDate()).padStart(2,"0"),m=String(t.getUTCHours()).padStart(2,"0"),i=String(t.getUTCMinutes()).padStart(2,"0"),R=String(t.getUTCSeconds()).padStart(2,"0");return f?`${g}-${h}-${n} ${m}:${i}:${R}`:`${g}-${h}-${n}`}function J(s){return s.every(f=>V.includes(f))}function M(s){let f=0;return s.forEach(u=>{u.child&&u.child.length>0?f+=M(u.child):f+=1}),f}var P=s=>{let f=[];return s.forEach(u=>{u.child&&u.child.length>0?f.push(...P(u.child)):f.push(u)}),f},j=s=>s.split("_").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" ");async function S(s,f,u,t){for(let n=0;n<t.length;n++){let h=t[n];if(_optionalChain([h, 'optionalAccess', _2 => _2.isImage])&&_optionalChain([h, 'optionalAccess', _3 => _3.imageSrc])&&typeof h.imageSrc=="string"&&h.imageSrc.startsWith("data:image"))try{let{buffer:g,extension:m}=K(h.imageSrc),i=s.addImage({buffer:g,extension:m});f.addImage(i,{tl:{col:n,row:u.number-1},ext:{width:70,height:60},editAs:"oneCell"}),(!u.height||u.height<60)&&(u.height=35)}catch(g){console.error("\u274C Error adding image to row:",g),u.getCell(n+1).value="[Image]"}}}function K(s){let f=s.match(/^data:image\/(\w+);base64,(.*)$/);if(!f)throw new Error("Invalid base64 image format");let u=f[1]==="jpg"?"jpeg":f[1],t=f[2],n=atob(t),h=n.length,g=new Uint8Array(h);for(let m=0;m<h;m++)g[m]=n.charCodeAt(m);return{buffer:g,extension:u}}var _exceljs = require('exceljs'); var _exceljs2 = _interopRequireDefault(_exceljs);var Q=async({columns:s,data:f,grouping:u,date:t,excelSetting:n,title:h,footerSetting:g})=>{let m=new _exceljs2.default.Workbook;s=s.filter(e=>!_optionalChain([e, 'access', _4 => _4.options, 'optionalAccess', _5 => _5.disabledColumn]));let i=m.addWorksheet(h||_optionalChain([n, 'optionalAccess', _6 => _6.titleExcel])),R=M(s),$=i.addRow([]);$.getCell(1).value=h||_optionalChain([n, 'optionalAccess', _7 => _7.titleExcel]),$.getCell(1).alignment={horizontal:"center"};let z=i.getColumn(R).letter;if(i.mergeCells(`A${$.number}:${z}${$.number}`),$.eachCell(e=>{e.font={color:{argb:"000000"},bold:!0,size:12}}),t){let e=i.addRow([]);e.getCell(1).value=`${t.caption?t.caption:"Tanggal "} : ${_optionalChain([t, 'optionalAccess', _8 => _8.start_date])} ${_optionalChain([t, 'optionalAccess', _9 => _9.end_date])?`s/d ${_optionalChain([t, 'optionalAccess', _10 => _10.end_date])}`:""}`,e.getCell(1).alignment={horizontal:"center"},i.mergeCells(`A${e.number}:${z}${e.number}`),e.eachCell(d=>{d.font={color:{argb:"00000"},bold:!0,size:12}})}let v=i.addRow([]);v.getCell(1).value=_optionalChain([n, 'optionalAccess', _11 => _11.additionalTextHeader])||"",v.getCell(1).alignment={horizontal:"center"},i.mergeCells(`A${v.number}:${z}${v.number}`),v.eachCell(e=>{e.font={color:{argb:"000000"},bold:!0,size:12}}),_optionalChain([n, 'optionalAccess', _12 => _12.customHeader])&&n.customHeader(i,R);let L=_optionalChain([n, 'optionalAccess', _13 => _13.startY])&&n.startY>0?n.startY:1;if(L>1)for(let e=1;e<L;e++)i.addRow([]);let A=s.some(e=>e.child&&e.child.length>0),T=i.addRow([]),b=A?i.addRow([]):null;s.forEach(e=>{if(e.child&&e.child.length>0){let d=T.actualCellCount+1,a=e.child.length;T.getCell(d).value=e.label,a>1&&i.mergeCells(T.number,d,T.number,d+a-1);for(let l=d;l<d+a;l++){let o=T.getCell(l);o.fill={type:"pattern",pattern:"solid",fgColor:{argb:_optionalChain([n, 'optionalAccess', _14 => _14.bgColor])||"E8E5E5"}},o.font={color:{argb:_optionalChain([n, 'optionalAccess', _15 => _15.txtColor])||"000000"},bold:!0},o.alignment={horizontal:"center",vertical:"middle"}}e.child.forEach((l,o)=>{if(b){let p=b.getCell(d+o);p.value=l.label,p.fill={type:"pattern",pattern:"solid",fgColor:{argb:_optionalChain([n, 'optionalAccess', _16 => _16.bgColor])||"E8E5E5"}},p.font={color:{argb:_optionalChain([n, 'optionalAccess', _17 => _17.txtColor])||"000000"},bold:!0};let E=_optionalChain([l, 'access', _18 => _18.options, 'optionalAccess', _19 => _19.halign])||(["RP","GR","NUMBER"].includes(_optionalChain([l, 'optionalAccess', _20 => _20.options, 'optionalAccess', _21 => _21.format])||"")?"right":"left"),c=_optionalChain([l, 'access', _22 => _22.options, 'optionalAccess', _23 => _23.valign])||"middle";p.alignment={horizontal:E,vertical:c}}})}else{let d=T.actualCellCount+1;T.getCell(d).value=e.label,T.getCell(d).fill={type:"pattern",pattern:"solid",fgColor:{argb:_optionalChain([n, 'optionalAccess', _24 => _24.bgColor])||"E8E5E5"}},T.getCell(d).font={color:{argb:_optionalChain([n, 'optionalAccess', _25 => _25.txtColor])||"000000"},bold:!0},T.getCell(d).alignment={horizontal:_optionalChain([e, 'access', _26 => _26.options, 'optionalAccess', _27 => _27.halign])||"center",vertical:_optionalChain([e, 'access', _28 => _28.options, 'optionalAccess', _29 => _29.valign])||"middle"},A&&b&&i.mergeCells(T.number,d,b.number,d)}}),P(s).forEach((e,d)=>{let a=d+1,l=i.getColumn(a);if(_optionalChain([e, 'access', _30 => _30.options, 'optionalAccess', _31 => _31.width]))l.width=e.options.width;else{let o=_optionalChain([e, 'access', _32 => _32.options, 'optionalAccess', _33 => _33.format])==="IMAGE"?15:20;l.width=o}});let x={};f.forEach(async e=>{if(_optionalChain([e, 'access', _34 => _34.detail, 'optionalAccess', _35 => _35.length])>0){if(u.length>0){let l=M(s),o=u.map(E=>e[E]!==void 0||e[E]!==null?`${j(E)} : ${e[E]}`:"").filter(Boolean).join("  |  "),p=i.addRow([o]);i.mergeCells(`A${p.number}:${String.fromCharCode(64+l)}${p.number}`),p.getCell(1).alignment={horizontal:"left"},p.getCell(1).font={bold:!0}}let d={};e.detail.forEach(async l=>{let p=P(s).map(c=>{if(_optionalChain([c, 'optionalAccess', _36 => _36.options, 'optionalAccess', _37 => _37.format])==="IMAGE"&&l[c.key])return{value:"",alignment:{horizontal:"center",vertical:"middle"},isImage:!0,imageSrc:l[c.key]};let I=_optionalChain([c, 'optionalAccess', _38 => _38.options, 'optionalAccess', _39 => _39.format])==="DATETIME"?F(l[c.key],!0):_optionalChain([c, 'optionalAccess', _40 => _40.options, 'optionalAccess', _41 => _41.format])==="DATE"?F(l[c.key]):l[c.key],k={horizontal:_optionalChain([c, 'optionalAccess', _42 => _42.options, 'optionalAccess', _43 => _43.halign])?_optionalChain([c, 'optionalAccess', _44 => _44.options, 'optionalAccess', _45 => _45.halign]):_optionalChain([c, 'optionalAccess', _46 => _46.options, 'optionalAccess', _47 => _47.format])==="RP"||_optionalChain([c, 'optionalAccess', _48 => _48.options, 'optionalAccess', _49 => _49.format])==="GR"||_optionalChain([c, 'optionalAccess', _50 => _50.options, 'optionalAccess', _51 => _51.format])==="NUMBER"?"right":"left"},G=c.key;return x[G]=(x[G]||0)+Number(I),d[G]=(d[G]||0)+Number(I),{value:I,alignment:k,numFmt:_optionalChain([c, 'optionalAccess', _52 => _52.options, 'optionalAccess', _53 => _53.format])==="RP"?"#,##0":_optionalChain([c, 'optionalAccess', _54 => _54.options, 'optionalAccess', _55 => _55.format])==="GR"?"#,##0.000":void 0}}),E=i.addRow(p.map(c=>c.value));p.forEach((c,I)=>{let k=E.getCell(I+1),G=["center","right","left","fill","justify","centerContinuous","distributed"],B=["top","middle","bottom","distributed","justify"],_,H;c.alignment&&typeof c.alignment.horizontal=="string"&&G.includes(c.alignment.horizontal)&&(_=c.alignment.horizontal),c.alignment&&"vertical"in c.alignment&&typeof c.alignment.vertical=="string"&&B.includes(c.alignment.vertical)&&(H=c.alignment.vertical),k.alignment={..._?{horizontal:_}:{},...H?{vertical:H}:{}},c.numFmt&&typeof c.value=="number"&&!isNaN(c.value)&&(k.value=Number(c.value),k.numFmt=c.numFmt)}),await S(m,i,E,p)});let a=P(s);if(!_optionalChain([g, 'optionalAccess', _56 => _56.subTotal, 'optionalAccess', _57 => _57.disableSubtotal])){let l=i.addRow(s.map(()=>null));a.forEach((o,p)=>{if(_optionalChain([o, 'optionalAccess', _58 => _58.options, 'optionalAccess', _59 => _59.format])==="RP"||_optionalChain([o, 'optionalAccess', _60 => _60.options, 'optionalAccess', _61 => _61.format])==="GR"||_optionalChain([o, 'optionalAccess', _62 => _62.options, 'optionalAccess', _63 => _63.format])==="NUMBER"){let c=f.length+4-1,I=`SUM(${String.fromCharCode(65+p)}4:${String.fromCharCode(65+p)}${c})`,k=l.getCell(p+1),G=_optionalChain([g, 'optionalAccess', _64 => _64.subTotal, 'optionalAccess', _65 => _65.enableCount])&&u.length>0?" : "+e.detail.length:"",B=_optionalChain([g, 'optionalAccess', _66 => _66.subTotal, 'optionalAccess', _67 => _67.captionItem])?_optionalChain([g, 'optionalAccess', _68 => _68.subTotal, 'optionalAccess', _69 => _69.captionItem]):"";l.getCell(1).value=`${_optionalChain([g, 'optionalAccess', _70 => _70.subTotal, 'optionalAccess', _71 => _71.caption])||"SUB TOTAL"} ${G} ${B}`,l.getCell(1).alignment={horizontal:"center"},k.numFmt=_optionalChain([o, 'optionalAccess', _72 => _72.options, 'optionalAccess', _73 => _73.format])==="GR"?"#,##0.000":"#,##0",k.value={formula:I},l.getCell(p+1).value=_optionalChain([o, 'optionalAccess', _74 => _74.options, 'access', _75 => _75.disabledFooter])?"":d[o.key]}else l.getCell(p+1).value=""}),_optionalChain([n, 'optionalAccess', _76 => _76.grandTotalSetting, 'optionalAccess', _77 => _77.colSpan])&&i.mergeCells(`A${l.number}:${String.fromCharCode(64+Number(_optionalChain([n, 'optionalAccess', _78 => _78.grandTotalSetting, 'optionalAccess', _79 => _79.colSpan])))}${l.number}`),l.eachCell(o=>{o.fill={type:"pattern",pattern:"solid",fgColor:{argb:_optionalChain([n, 'optionalAccess', _80 => _80.bgColor])||"#E8E5E5"},bgColor:{argb:_optionalChain([n, 'optionalAccess', _81 => _81.bgColor])||"#E8E5E5"}},o.font={color:{argb:_optionalChain([n, 'optionalAccess', _82 => _82.txtColor])},bold:!0}})}}else{let a=P(s).map(o=>{if(_optionalChain([o, 'optionalAccess', _83 => _83.options, 'optionalAccess', _84 => _84.format])==="IMAGE"&&e[o.key])return{value:"",alignment:{horizontal:"center",vertical:"middle"},isImage:!0,imageSrc:e[o.key]};let p=_optionalChain([o, 'optionalAccess', _85 => _85.options, 'optionalAccess', _86 => _86.format])==="DATETIME"?F(e[o.key]):_optionalChain([o, 'optionalAccess', _87 => _87.options, 'optionalAccess', _88 => _88.format])==="DATE"?F(e[o.key]):e[o.key],E={horizontal:_optionalChain([o, 'optionalAccess', _89 => _89.options, 'optionalAccess', _90 => _90.halign])?_optionalChain([o, 'optionalAccess', _91 => _91.options, 'optionalAccess', _92 => _92.halign]):_optionalChain([o, 'optionalAccess', _93 => _93.options, 'optionalAccess', _94 => _94.format])==="RP"||_optionalChain([o, 'optionalAccess', _95 => _95.options, 'optionalAccess', _96 => _96.format])==="GR"||_optionalChain([o, 'optionalAccess', _97 => _97.options, 'optionalAccess', _98 => _98.format])==="NUMBER"?"right":"left"},c=o.key;return x[c]=(x[c]||0)+Number(p),{value:p,alignment:E,numFmt:_optionalChain([o, 'optionalAccess', _99 => _99.options, 'optionalAccess', _100 => _100.format])==="RP"?"#,##0":_optionalChain([o, 'optionalAccess', _101 => _101.options, 'optionalAccess', _102 => _102.format])==="GR"?"#,##0.000":void 0}}),l=i.addRow(a.map(o=>o.value));a.forEach((o,p)=>{let E=l.getCell(p+1),c=["center","right","left","fill","justify","centerContinuous","distributed"],I=["top","middle","bottom","distributed","justify"],k,G;o.alignment&&typeof o.alignment.horizontal=="string"&&c.includes(o.alignment.horizontal)&&(k=o.alignment.horizontal),o.alignment&&"vertical"in o.alignment&&typeof o.alignment.vertical=="string"&&I.includes(o.alignment.vertical)&&(G=o.alignment.vertical),E.alignment={...k?{horizontal:k}:{},...G?{vertical:G}:{}},o.numFmt&&typeof o.value=="number"&&!isNaN(o.value)&&(E.value=Number(o.value),E.numFmt=o.numFmt)}),await S(m,i,l,a)}});let N=i.addRow(s.map(()=>null)),r=P(s);_optionalChain([g, 'optionalAccess', _103 => _103.grandTotal, 'optionalAccess', _104 => _104.disableGrandTotal])||(r.forEach((e,d)=>{if(_optionalChain([e, 'optionalAccess', _105 => _105.options, 'optionalAccess', _106 => _106.format])==="RP"||_optionalChain([e, 'optionalAccess', _107 => _107.options, 'optionalAccess', _108 => _108.format])==="GR"||_optionalChain([e, 'optionalAccess', _109 => _109.options, 'optionalAccess', _110 => _110.format])==="NUMBER"){let l=f.length+4-1,o=`SUM(${String.fromCharCode(65+d)}4:${String.fromCharCode(65+d)}${l})`,p=N.getCell(d+1),E=_optionalChain([g, 'optionalAccess', _111 => _111.grandTotal, 'optionalAccess', _112 => _112.enableCount])?u.length>0?" : "+f.map(k=>k.detail.length).reduce((k,G)=>k+G,0):" : "+f.length:"",c=_optionalChain([g, 'optionalAccess', _113 => _113.grandTotal, 'optionalAccess', _114 => _114.captionItem])?_optionalChain([g, 'optionalAccess', _115 => _115.grandTotal, 'optionalAccess', _116 => _116.captionItem]):"",I=`${_optionalChain([g, 'optionalAccess', _117 => _117.grandTotal, 'optionalAccess', _118 => _118.caption])||"GRAND TOTAL"} ${E} ${c}`;N.getCell(1).value=I,N.getCell(1).alignment={horizontal:"center"},p.numFmt=_optionalChain([e, 'optionalAccess', _119 => _119.options, 'optionalAccess', _120 => _120.format])==="GR"?"#,##0.000":"#,##0",p.value={formula:o},N.getCell(d+1).value=_optionalChain([e, 'optionalAccess', _121 => _121.options, 'access', _122 => _122.disabledFooter])?"":x[e.key]}else N.getCell(d+1).value=""}),_optionalChain([n, 'optionalAccess', _123 => _123.grandTotalSetting, 'optionalAccess', _124 => _124.colSpan])&&i.mergeCells(`A${N.number}:${String.fromCharCode(64+Number(_optionalChain([n, 'optionalAccess', _125 => _125.grandTotalSetting, 'optionalAccess', _126 => _126.colSpan])))}${N.number}`),N.eachCell(e=>{e.fill={type:"pattern",pattern:"solid",fgColor:{argb:_optionalChain([n, 'optionalAccess', _127 => _127.bgColor])||"#E8E5E5"},bgColor:{argb:_optionalChain([n, 'optionalAccess', _128 => _128.bgColor])||"#E8E5E5"}},e.font={color:{argb:_optionalChain([n, 'optionalAccess', _129 => _129.txtColor])},bold:!0}})),_optionalChain([n, 'optionalAccess', _130 => _130.customFooter])&&n.customFooter(i,R);let y=await m.xlsx.writeBuffer(),w=new Blob([y],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),C=document.createElement("a");C.href=URL.createObjectURL(w),C.download=`${_optionalChain([n, 'optionalAccess', _131 => _131.titleExcel])||h}.xlsx`,document.body.appendChild(C),C.click(),document.body.removeChild(C)},O=Q;var _jspdf = require('jspdf'); var _jspdf2 = _interopRequireDefault(_jspdf);var _jspdfautotable = require('jspdf-autotable'); var _jspdfautotable2 = _interopRequireDefault(_jspdfautotable);var tt=({columns:s,data:f,grouping:u,pdfSetting:t,date:n,title:h,footerSetting:g})=>{let m=new (0, _jspdf2.default)(_optionalChain([t, 'optionalAccess', _132 => _132.orientation]),_optionalChain([t, 'optionalAccess', _133 => _133.unit]),[_optionalChain([t, 'optionalAccess', _134 => _134.width])||297,_optionalChain([t, 'optionalAccess', _135 => _135.height])||210]),i=[],R=n?30:20;s=s.filter(r=>!_optionalChain([r, 'access', _136 => _136.options, 'optionalAccess', _137 => _137.disabledColumn])),m.setFontSize(10);let $=m.internal.pageSize.getWidth(),z=m.splitTextToSize(_optionalChain([t, 'optionalAccess', _138 => _138.textHeaderLeft])||"",110);m.text(z,15,18),m.text(`${h||_optionalChain([t, 'optionalAccess', _139 => _139.titlePdf])}`,$-15,18,{align:"right"}),n&&m.text(`${n.caption?n.caption:"TANGGAL "} : ${_optionalChain([n, 'optionalAccess', _140 => _140.start_date])} ${_optionalChain([n, 'optionalAccess', _141 => _141.end_date])?`s/d ${_optionalChain([n, 'optionalAccess', _142 => _142.end_date])}`:""}`,$-15,22,{align:"right"}),typeof _optionalChain([t, 'optionalAccess', _143 => _143.customHeader])=="function"&&t.customHeader(m,R,_jspdfautotable2.default),m.setProperties({title:h||_optionalChain([t, 'optionalAccess', _144 => _144.titlePdf])}),_optionalChain([t, 'optionalAccess', _145 => _145.startY])&&(R=t.startY);let v=[],L=[],A=s.some(r=>r.child&&r.child.length>0);s.forEach(r=>{let y={textColor:`#${_optionalChain([t, 'optionalAccess', _146 => _146.txtColor])||"000"}`,fillColor:`#${_optionalChain([t, 'optionalAccess', _147 => _147.bgColor])||"E8E5E5"}`,..._optionalChain([r, 'optionalAccess', _148 => _148.options, 'optionalAccess', _149 => _149.width])&&{cellWidth:_optionalChain([r, 'optionalAccess', _150 => _150.options, 'optionalAccess', _151 => _151.width])},fontStyle:"bold",..._optionalChain([r, 'optionalAccess', _152 => _152.options, 'optionalAccess', _153 => _153.valign])?{valign:r.options.valign}:{},halign:_nullishCoalesce(_optionalChain([r, 'optionalAccess', _154 => _154.options, 'optionalAccess', _155 => _155.halign]), () => ((["RP","GR","NUMBER"].includes(_optionalChain([r, 'optionalAccess', _156 => _156.options, 'optionalAccess', _157 => _157.format])||"")?"right":"left")))};A?r.child&&r.child.length>0?(v.push({content:r.label,colSpan:r.child.length,styles:y}),r.child.forEach(w=>{L.push({content:w.label,key:w.key,options:w.options,styles:{...y,halign:_nullishCoalesce(_optionalChain([w, 'optionalAccess', _158 => _158.options, 'optionalAccess', _159 => _159.halign]), () => ((["RP","GR","NUMBER"].includes(_optionalChain([w, 'optionalAccess', _160 => _160.options, 'optionalAccess', _161 => _161.format])||"")?"right":"left")))}})})):v.push({content:r.label,rowSpan:2,key:r.key,options:r.options,styles:y}):v.push({content:r.label,key:r.key,options:r.options,styles:y})}),i.push(v),A&&L.length>0&&i.push(L);let T={};f.forEach(r=>{if(_optionalChain([r, 'access', _162 => _162.detail, 'optionalAccess', _163 => _163.length])>0){if(u.length>0){let C=M(s),d=[{content:u.map(a=>r[a]!==void 0||r[a]!==null?`${j(a)} : ${r[a]}`:"").filter(Boolean).join("  |  "),colSpan:C,styles:{fontStyle:"bold",halign:"left"}}];i.push(d)}let y={},w=P(s);if(r.detail.forEach(C=>{let e=w.map(d=>{let a=C[d.key],l=d.key;T[l]=(T[l]||0)+Number(a||0),y[l]=(y[l]||0)+Number(a||0);let o=_optionalChain([d, 'access', _164 => _164.options, 'optionalAccess', _165 => _165.format])==="IMAGE";return{content:(()=>{switch(_optionalChain([d, 'optionalAccess', _166 => _166.options, 'optionalAccess', _167 => _167.format])){case"RP":return a!==void 0?Number(a||0).toLocaleString("kr-ko"):"";case"GR":return a!==void 0?Number(a||0).toFixed(3):"";case"NUMBER":return a!==void 0?Number(a||0):"";case"IMAGE":return"";case"DATETIME":return a!==void 0?F(a||new Date,!0):"";case"DATE":return a!==void 0?F(a||new Date):"";default:return a!==void 0?a.toString():""}})(),foto:o?a:null,styles:{halign:_optionalChain([d, 'optionalAccess', _168 => _168.options, 'optionalAccess', _169 => _169.halign])?_optionalChain([d, 'optionalAccess', _170 => _170.options, 'optionalAccess', _171 => _171.halign]):_optionalChain([d, 'optionalAccess', _172 => _172.options, 'optionalAccess', _173 => _173.format])==="RP"||_optionalChain([d, 'optionalAccess', _174 => _174.options, 'optionalAccess', _175 => _175.format])==="GR"||_optionalChain([d, 'optionalAccess', _176 => _176.options, 'optionalAccess', _177 => _177.format])==="NUMBER"||typeof a=="number"?"right":"left"}}});i.push(e)}),!_optionalChain([g, 'optionalAccess', _178 => _178.subTotal, 'optionalAccess', _179 => _179.disableSubtotal])){let C=[];w.forEach(l=>{let o=y[l.key];_optionalChain([l, 'optionalAccess', _180 => _180.options, 'optionalAccess', _181 => _181.format])==="RP"||_optionalChain([l, 'optionalAccess', _182 => _182.options, 'optionalAccess', _183 => _183.format])==="GR"||_optionalChain([l, 'optionalAccess', _184 => _184.options, 'optionalAccess', _185 => _185.format])==="NUMBER"?C.push({content:_optionalChain([l, 'optionalAccess', _186 => _186.options, 'optionalAccess', _187 => _187.disabledFooter])?"":(()=>{switch(_optionalChain([l, 'optionalAccess', _188 => _188.options, 'optionalAccess', _189 => _189.format])){case"RP":return o.toLocaleString("kr-ko");case"GR":return o.toFixed(3);case"NUMBER":return o;default:return o.toString()}})(),styles:{halign:_optionalChain([l, 'optionalAccess', _190 => _190.options, 'optionalAccess', _191 => _191.halign])||"right",textColor:`#${_optionalChain([t, 'optionalAccess', _192 => _192.txtColor])||"000"}`,fillColor:`#${_optionalChain([t, 'optionalAccess', _193 => _193.bgColor])||"E8E5E5"}`,fontStyle:"bold"}}):C.push({content:"",styles:{textColor:`#${_optionalChain([t, 'optionalAccess', _194 => _194.txtColor])||"000"}`,fillColor:`#${_optionalChain([t, 'optionalAccess', _195 => _195.bgColor])||"E8E5E5"}`,fontStyle:"bold"}})});let e=_optionalChain([t, 'optionalAccess', _196 => _196.grandTotalSetting, 'optionalAccess', _197 => _197.colSpan])?Number(_optionalChain([t, 'optionalAccess', _198 => _198.grandTotalSetting, 'optionalAccess', _199 => _199.colSpan])||0)+1:0,d=_optionalChain([g, 'optionalAccess', _200 => _200.subTotal, 'optionalAccess', _201 => _201.enableCount])&&u.length>0?" : "+r.detail.length:"",a=_optionalChain([g, 'optionalAccess', _202 => _202.subTotal, 'optionalAccess', _203 => _203.captionItem])?_optionalChain([g, 'optionalAccess', _204 => _204.subTotal, 'optionalAccess', _205 => _205.captionItem]):"";C[0]={content:`${_optionalChain([g, 'optionalAccess', _206 => _206.subTotal, 'optionalAccess', _207 => _207.caption])||"SUB TOTAL"}${d} ${a}`,colSpan:e,styles:{textColor:`#${_optionalChain([t, 'optionalAccess', _208 => _208.txtColor])||"000"}`,fillColor:`#${_optionalChain([t, 'optionalAccess', _209 => _209.bgColor])||"E8E5E5"}`,fontStyle:"bold",halign:"center"}},_optionalChain([t, 'optionalAccess', _210 => _210.grandTotalSetting, 'optionalAccess', _211 => _211.colSpan])&&C.splice(1,_optionalChain([t, 'optionalAccess', _212 => _212.grandTotalSetting, 'optionalAccess', _213 => _213.colSpan])),i.push(C)}}else{let y=(e,d)=>{let a=d[e.key],l=e.key;_optionalChain([e, 'access', _214 => _214.options, 'optionalAccess', _215 => _215.disabledFooter])||(T[l]=(T[l]||0)+Number(a||0));let o=(()=>{switch(_optionalChain([e, 'optionalAccess', _216 => _216.options, 'optionalAccess', _217 => _217.format])){case"RP":return a!==void 0?Number(a||0).toLocaleString("kr-ko"):"";case"GR":return a!==void 0?Number(a||0).toFixed(3):"";case"NUMBER":return a!==void 0?Number(a||0):"";case"IMAGE":return"";case"DATETIME":return a!==void 0?F(a||new Date,!0):"";case"DATE":return a!==void 0?F(a||new Date):"";default:return a!==void 0?_optionalChain([a, 'optionalAccess', _218 => _218.toString, 'call', _219 => _219()]):""}})(),p=_optionalChain([e, 'optionalAccess', _220 => _220.options, 'optionalAccess', _221 => _221.halign])?_optionalChain([e, 'optionalAccess', _222 => _222.options, 'optionalAccess', _223 => _223.halign]):_optionalChain([e, 'optionalAccess', _224 => _224.options, 'optionalAccess', _225 => _225.format])==="RP"||_optionalChain([e, 'optionalAccess', _226 => _226.options, 'optionalAccess', _227 => _227.format])==="GR"||_optionalChain([e, 'optionalAccess', _228 => _228.options, 'optionalAccess', _229 => _229.format])==="NUMBER"||typeof a=="number"?"right":"left",E=_optionalChain([e, 'access', _230 => _230.options, 'optionalAccess', _231 => _231.format])==="IMAGE";return{options:_optionalChain([e, 'optionalAccess', _232 => _232.options]),content:o,foto:E?a:null,styles:{halign:p}}},C=P(s).map(e=>y(e,r));i.push(C)}});let b=P(s);if(!_optionalChain([g, 'optionalAccess', _233 => _233.grandTotal, 'optionalAccess', _234 => _234.disableGrandTotal])){let r=[];b.forEach(a=>{let l=T[a.key],o=["RP","GR","NUMBER"].includes(_optionalChain([a, 'optionalAccess', _235 => _235.options, 'optionalAccess', _236 => _236.format])||""),p=_optionalChain([a, 'optionalAccess', _237 => _237.options, 'optionalAccess', _238 => _238.disabledFooter])?"":(()=>{if(!o)return"";switch(_optionalChain([a, 'access', _239 => _239.options, 'optionalAccess', _240 => _240.format])){case"RP":return Number(l||0).toLocaleString("kr-KO");case"GR":return Number(l||0).toFixed(3);case"NUMBER":return Number(l||0);default:return(l||0).toString()}})();r.push({options:_optionalChain([a, 'optionalAccess', _241 => _241.options]),content:p,styles:{halign:_optionalChain([a, 'optionalAccess', _242 => _242.options, 'optionalAccess', _243 => _243.halign])?a.options.halign:o?"right":"left",textColor:`#${_optionalChain([t, 'optionalAccess', _244 => _244.txtColor])||"000"}`,fillColor:`#${_optionalChain([t, 'optionalAccess', _245 => _245.bgColor])||"E8E5E5"}`,fontStyle:"bold"}})});let y=Number(_optionalChain([t, 'optionalAccess', _246 => _246.grandTotalSetting, 'optionalAccess', _247 => _247.colSpan])||0),w=Math.min(y+1,b.length),C=_optionalChain([g, 'optionalAccess', _248 => _248.grandTotal, 'optionalAccess', _249 => _249.enableCount])?u.length>0?f.reduce((a,l)=>a+l.detail.length,0):f.length:0,e=_optionalChain([g, 'optionalAccess', _250 => _250.grandTotal, 'optionalAccess', _251 => _251.captionItem])||"",d=`${_optionalChain([g, 'optionalAccess', _252 => _252.grandTotal, 'optionalAccess', _253 => _253.caption])||"GRAND TOTAL"}`+(C?` : ${C}`:"")+(e?` ${e}`:"");for(r[0]={content:d,colSpan:w,styles:{textColor:`#${_optionalChain([t, 'optionalAccess', _254 => _254.txtColor])||"000"}`,fillColor:`#${_optionalChain([t, 'optionalAccess', _255 => _255.bgColor])||"E8E5E5"}`,fontStyle:"bold",halign:"center"}},r.splice(1,w-1);r.length<b.length;)r.push({content:"",styles:{textColor:`#${_optionalChain([t, 'optionalAccess', _256 => _256.txtColor])||"000"}`,fillColor:`#${_optionalChain([t, 'optionalAccess', _257 => _257.bgColor])||"E8E5E5"}`,fontStyle:"bold"}});i.push(r)}if(typeof _optionalChain([t, 'optionalAccess', _258 => _258.addRow])=="function"&&_optionalChain([t, 'optionalAccess', _259 => _259.addRow, 'call', _260 => _260(i)]),!_optionalChain([t, 'optionalAccess', _261 => _261.disablePrintDate])){let r=M(s);i.push([{content:`Print Date : ${F(`${new Date}`)}`,colSpan:r,styles:{textColor:`#${_optionalChain([t, 'optionalAccess', _262 => _262.txtColor])||"000"}`,fillColor:`#${_optionalChain([t, 'optionalAccess', _263 => _263.bgColor])||"E8E5E5"}`,fontStyle:"italic"}}])}_jspdfautotable2.default.call(void 0, m,{head:[],body:i,startY:R,theme:_optionalChain([t, 'optionalAccess', _264 => _264.theme])||"plain",rowPageBreak:"avoid",margin:{top:10},bodyStyles:{fontSize:_optionalChain([t, 'optionalAccess', _265 => _265.fontSIze])||8},headStyles:{fontSize:_optionalChain([t, 'optionalAccess', _266 => _266.fontSIze])||8,textColor:`#${_optionalChain([t, 'optionalAccess', _267 => _267.txtColor])||"000"}`,fillColor:`#${_optionalChain([t, 'optionalAccess', _268 => _268.bgColor])||"E8E5E5"}`},tableLineColor:[255,255,255],didParseCell:function(r){let y=r.column.index;_optionalChain([b, 'access', _269 => _269[y], 'optionalAccess', _270 => _270.options, 'optionalAccess', _271 => _271.format])==="IMAGE"&&r.cell.raw&&r.cell.raw.foto&&(r.row.height=20,r.cell.styles.valign="middle",r.cell.styles.halign="center")},didDrawCell:function(r){let{cell:y}=r,C=(y.raw||{}).foto,e=r.column.index;if(_optionalChain([b, 'access', _272 => _272[e], 'optionalAccess', _273 => _273.options, 'optionalAccess', _274 => _274.format])==="IMAGE"&&C){let l=y.x+(y.width-15)/2,o=y.y+(y.height-15)/2;try{m.addImage(C,"JPG",l,o,15,15)}catch(p){console.warn("\u274C Gagal render gambar:",p)}}}}),i=[],R=m.lastAutoTable.finalY;let D=m.internal.getNumberOfPages(),x=m.internal.pageSize.width,N=m.internal.pageSize.height;m.setFontSize(10);for(let r=1;r<D+1;r++){let y=x/2,w=N-10;m.setPage(r),m.text(`${r} of ${D}`,y,w,{align:"center"})}if(typeof _optionalChain([t, 'optionalAccess', _275 => _275.customFooter])=="function"&&t.customFooter(m,R,_jspdfautotable2.default),_optionalChain([t, 'optionalAccess', _276 => _276.openNewTab])){let r=m.output("bloburl");window.open(r)}else m.save(`${_optionalChain([t, 'optionalAccess', _277 => _277.titlePdf])||h}.pdf`)},W=tt;var et=s=>{let f=[],u=s.copy?2:1;for(let t=0;t<u;t++){let n=s.data.map(h=>{let g=s.template;for(;/\n!!LOOP\((.+)\)(\{\n(.*\n)+\})\n/gm.exec(g);)g=g.replace(/\n!!LOOP\((.+)\)(\{\n(.*\n)+\})\n/,(m,i,R)=>{let $=R.replace(/^\{/,"").replace(/\}$/,"");return(Array.isArray(h[i])?h[i]:[h[i]]).reduce((L,A)=>L+$.replace(/\{([a-z0-9_]+)\}/gm,T=>{let b=T.replace(/(\{|\})/g,"");if(b.match(/nama_barang/)){let D=b.match(/nama_barang/),x=b==="nama_barang2"?[20,40]:b==="nama_barang3"?[40,60]:[0,20];return _optionalChain([A, 'access', _278 => _278[D], 'optionalAccess', _279 => _279.slice, 'call', _280 => _280(...x), 'access', _281 => _281.trim, 'call', _282 => _282()])||""}if(b.match(/deskripsi_jual/)){let D=b.match(/deskripsi_jual/),x=b==="deskripsi_jual2"?[20,40]:b==="deskripsi_jual3"?[40,60]:[0,20];return _optionalChain([A, 'access', _283 => _283[D], 'optionalAccess', _284 => _284.slice, 'call', _285 => _285(...x), 'access', _286 => _286.trim, 'call', _287 => _287()])||""}if(b.match(/deskripsi/)){let D=b.match(/deskripsi/),x=b==="deskripsi2"?[20,40]:b==="deskripsi3"?[40,60]:[0,20];return _optionalChain([A, 'access', _288 => _288[D], 'optionalAccess', _289 => _289.slice, 'call', _290 => _290(...x), 'access', _291 => _291.trim, 'call', _292 => _292()])||""}return A[b]||""}),"").replace(/\n(\s)+\n/gm,`
`)});return g.replace(/\{([a-z0-9_]+)\}/gm,m=>{let i=m.replace(/(\{|\})/g,"");return i.match(/auto_cut/)?`
VA`:h[i]||""}).replace(/\n(\s)+\n/gm,`
`).replace(/~new_line~/gm,`
`).replace(/!!LOOP\(detail\)/g,"").replace(/[}{]/g,"")});for(let h in n)n[h]+=`

`;f.push(...n)}return f},ot=async(s,f)=>{let u=et(s),t=new Blob([_optionalChain([u, 'optionalAccess', _293 => _293.join, 'call', _294 => _294(`
`)])||""],{type:"text/plain"}),n=document.createElement("a");n.href=URL.createObjectURL(t),n.download=f,document.body.appendChild(n),n.click(),document.body.removeChild(n)},X=ot;var Gt=({columns:s,data:f,grouping:u,date:t,type:n,txtSetting:h,pdfSetting:g,excelSetting:m,title:i,footerSetting:R})=>{let $={data:[_optionalChain([h, 'optionalAccess', _295 => _295.dataTxt])],template:_optionalChain([h, 'optionalAccess', _296 => _296.templateTxt]),copy:_optionalChain([h, 'optionalAccess', _297 => _297.copy])};if(f.length===0)throw new Error("Data is required");if(n.length===0)throw new Error("Type is required");if(!J(n))throw new Error('Type Export must use ["EXCEL", "PDF", "TXT", "ALL"]');n.forEach(z=>{z==="PDF"?W({pdfSetting:g,date:t,data:f,type:n,columns:s,grouping:u,title:i,footerSetting:R}):z==="TXT"?X($,_optionalChain([h, 'optionalAccess', _298 => _298.titleTxt])||""):z==="EXCEL"?O({date:t,data:f,type:n,columns:s,grouping:u,excelSetting:m,title:i,footerSetting:R}):(O({date:t,data:f,type:n,columns:s,grouping:u,excelSetting:m,title:i}),W({pdfSetting:g,date:t,data:f,type:n,columns:s,grouping:u,title:i}),X($,_optionalChain([h, 'optionalAccess', _299 => _299.titleTxt])||""))})};exports.ExportData = Gt;
//# sourceMappingURL=index.js.map