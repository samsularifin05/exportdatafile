var q=["EXCEL","PDF","TXT","ALL"];function z(s,f=!1){let c=new Date(s),e=new Date(c.getTime()+420*60*1e3),n=e.getUTCFullYear(),b=String(e.getUTCMonth()+1).padStart(2,"0"),m=String(e.getUTCDate()).padStart(2,"0"),w=String(e.getUTCHours()).padStart(2,"0"),d=String(e.getUTCMinutes()).padStart(2,"0"),g=String(e.getUTCSeconds()).padStart(2,"0");return f?`${m}-${b}-${n} ${w}:${d}:${g}`:`${m}-${b}-${n}`}function Q(s){return s.every(f=>q.includes(f))}function U(s){let f=0;return s.forEach(c=>{c.child&&c.child.length>0?f+=U(c.child):f+=1}),f}var A=s=>{let f=[];return s.forEach(c=>{c.child&&c.child.length>0?f.push(...A(c.child)):f.push(c)}),f},H=s=>s.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ");async function Y(s,f,c,e){for(let n=0;n<e.length;n++){let b=e[n];if(b?.isImage&&b?.imageSrc&&typeof b.imageSrc=="string"&&b.imageSrc.startsWith("data:image"))try{let{buffer:m,extension:w}=Z(b.imageSrc),d=s.addImage({buffer:m,extension:w});f.addImage(d,{tl:{col:n,row:c.number-1},ext:{width:70,height:60},editAs:"oneCell"}),(!c.height||c.height<60)&&(c.height=35)}catch(m){console.error("\u274C Error adding image to row:",m),c.getCell(n+1).value="[Image]"}}}function Z(s){let f=s.match(/^data:image\/(\w+);base64,(.*)$/);if(!f)throw new Error("Invalid base64 image format");let c=f[1]==="jpg"?"jpeg":f[1],e=f[2],n=atob(e),b=n.length,m=new Uint8Array(b);for(let w=0;w<b;w++)m[w]=n.charCodeAt(w);return{buffer:m,extension:c}}var E=s=>{if(!s)return s;let f=s.replace(/^#/,"");return f.length===8?f.substring(2):f};import tt from"exceljs";var ot=async({columns:s,data:f,grouping:c,date:e,excelSetting:n,title:b,footerSetting:m,groupingSetting:w})=>{let d=new tt.Workbook;s=s.filter(r=>!r.options?.disabledColumn);let g=d.addWorksheet(b||n?.titleExcel),x=U(s),F=g.addRow([]);F.getCell(1).value=b||n?.titleExcel,F.getCell(1).alignment={horizontal:"center"};let P=g.getColumn(x).letter;if(g.mergeCells(`A${F.number}:${P}${F.number}`),F.eachCell(r=>{r.font={color:{argb:"000000"},bold:!0,size:12}}),e){let r=g.addRow([]);r.getCell(1).value=`${e.caption?e.caption:"Tanggal "} : ${e?.start_date} ${e?.end_date?`s/d ${e?.end_date}`:""}`,r.getCell(1).alignment={horizontal:"center"},g.mergeCells(`A${r.number}:${P}${r.number}`),r.eachCell(i=>{i.font={color:{argb:"00000"},bold:!0,size:12}})}let v=g.addRow([]);v.getCell(1).value=n?.additionalTextHeader||"",v.getCell(1).alignment={horizontal:"center"},g.mergeCells(`A${v.number}:${P}${v.number}`),v.eachCell(r=>{r.font={color:{argb:"000000"},bold:!0,size:12}}),n?.customHeader&&n.customHeader(g,x);let I=n?.startY&&n.startY>0?n.startY:1;if(I>1)for(let r=1;r<I;r++)g.addRow([]);let D=s.some(r=>r.child&&r.child.length>0),h=g.addRow([]),G=D?g.addRow([]):null;s.forEach(r=>{if(r.child&&r.child.length>0){let i=h.actualCellCount+1,u=r.child.length;h.getCell(i).value=r.label,u>1&&g.mergeCells(h.number,i,h.number,i+u-1);for(let o=i;o<i+u;o++){let t=h.getCell(o);t.fill={type:"pattern",pattern:"solid",fgColor:{argb:n?.bgColor||"E8E5E5"}},t.font={color:{argb:n?.txtColor||"000000"},bold:!0},t.alignment={horizontal:"center",vertical:"middle"}}r.child.forEach((o,t)=>{if(G){let p=G.getCell(i+t);p.value=o.label,p.fill={type:"pattern",pattern:"solid",fgColor:{argb:n?.bgColor||"E8E5E5"}},p.font={color:{argb:n?.txtColor||"000000"},bold:!0};let C=o.options?.halign||(["RP","GR","NUMBER"].includes(o?.options?.format||"")?"right":"left"),l=o.options?.valign||"middle";p.alignment={horizontal:C,vertical:l}}})}else{let i=h.actualCellCount+1;h.getCell(i).value=r.label,h.getCell(i).fill={type:"pattern",pattern:"solid",fgColor:{argb:n?.bgColor||"E8E5E5"}},h.getCell(i).font={color:{argb:n?.txtColor||"000000"},bold:!0},h.getCell(i).alignment={horizontal:r.options?.halign||"center",vertical:r.options?.valign||"middle"},D&&G&&g.mergeCells(h.number,i,G.number,i)}}),A(s).forEach((r,i)=>{let u=i+1,o=g.getColumn(u);if(r.options?.width)o.width=r.options.width;else{let t=r.options?.format==="IMAGE"?15:20;o.width=t}});let M={};f.forEach(async r=>{if(r.detail?.length>0){if(c.length>0){let o=U(s),t=c.map(l=>r[l]!==void 0||r[l]!==null?`${H(l)} : ${r[l]}`:"").filter(Boolean).join("  |  "),p=typeof w=="function"?w(r):w||{},C=g.addRow([t]);g.mergeCells(`A${C.number}:${String.fromCharCode(64+o)}${C.number}`),C.getCell(1).alignment={horizontal:p?.halign||"left"},p?.txtColor&&(C.getCell(1).font={bold:!0,color:{argb:p?.txtColor||"000000"}}),p?.bgColor&&(C.getCell(1).fill={type:"pattern",pattern:"solid",fgColor:{argb:p?.bgColor}})}let i={};r.detail.forEach(async o=>{let p=A(s).map(l=>{if(l?.options?.format==="IMAGE"&&o[l.key])return{value:"",alignment:{horizontal:"center",vertical:"middle"},isImage:!0,imageSrc:o[l.key]};let R=l?.options?.format==="DATETIME"?z(o[l.key],!0):l?.options?.format==="DATE"?z(o[l.key]):o[l.key];l.formatter&&(R=l.formatter(R,o));let k={horizontal:l?.options?.halign?l?.options?.halign:l?.options?.format==="RP"||l?.options?.format==="GR"||l?.options?.format==="NUMBER"?"right":"left"},$=l.key,B=o[l.key];return M[$]=(M[$]||0)+Number(B),i[$]=(i[$]||0)+Number(B),{value:R,alignment:k,...l?.options?.bgColor&&{fgColor:{argb:l.options.bgColor}},...l?.options?.txtColor&&{color:{argb:l.options.txtColor}},numFmt:l?.options?.format==="RP"?"#,##0":l?.options?.format==="GR"?"#,##0.000":void 0}}),C=g.addRow(p.map(l=>l.value));p.forEach((l,R)=>{let k=C.getCell(R+1),$=["center","right","left","fill","justify","centerContinuous","distributed"],B=["top","middle","bottom","distributed","justify"],O,V;l.alignment&&typeof l.alignment.horizontal=="string"&&$.includes(l.alignment.horizontal)&&(O=l.alignment.horizontal),l.alignment&&"vertical"in l.alignment&&typeof l.alignment.vertical=="string"&&B.includes(l.alignment.vertical)&&(V=l.alignment.vertical),k.alignment={...O?{horizontal:O}:{},...V?{vertical:V}:{}},!l.isImage&&"numFmt"in l&&l.numFmt&&typeof l.value=="number"&&!isNaN(l.value)&&(k.value=Number(l.value),k.numFmt=l.numFmt)}),await Y(d,g,C,p)});let u=A(s);if(!m?.subTotal?.disableSubtotal){let o=g.addRow(s.map(()=>null));u.forEach((t,p)=>{if(t?.options?.format==="RP"||t?.options?.format==="GR"||t?.options?.format==="NUMBER"){let l=f.length+4-1,R=`SUM(${String.fromCharCode(65+p)}4:${String.fromCharCode(65+p)}${l})`,k=o.getCell(p+1),$=m?.subTotal?.enableCount&&c.length>0?" : "+r.detail.length:"",B=m?.subTotal?.captionItem?m?.subTotal?.captionItem:"";o.getCell(1).value=`${m?.subTotal?.caption||"SUB TOTAL"} ${$} ${B}`,o.getCell(1).alignment={horizontal:"center"},k.numFmt=t?.options?.format==="GR"?"#,##0.000":"#,##0",k.value={formula:R},o.getCell(p+1).value=t?.options.disabledFooter?"":i[t.key]}else o.getCell(p+1).value=""}),n?.grandTotalSetting?.colSpan&&g.mergeCells(`A${o.number}:${String.fromCharCode(64+Number(n?.grandTotalSetting?.colSpan))}${o.number}`),o.eachCell(t=>{t.fill={type:"pattern",pattern:"solid",fgColor:{argb:n?.bgColor||"#E8E5E5"},bgColor:{argb:n?.bgColor||"#E8E5E5"}},t.font={color:{argb:n?.txtColor},bold:!0}})}}else{let u=A(s).map(t=>{if(t?.options?.format==="IMAGE"&&r[t.key])return{value:"",alignment:{horizontal:"center",vertical:"middle"},isImage:!0,imageSrc:r[t.key]};let p=t?.options?.format==="DATETIME"?z(r[t.key]):t?.options?.format==="DATE"?z(r[t.key]):r[t.key];t.formatter&&(p=t.formatter(p,r));let C={horizontal:t?.options?.halign?t?.options?.halign:t?.options?.format==="RP"||t?.options?.format==="GR"||t?.options?.format==="NUMBER"?"right":"left"},l=t.key,R=r[t.key];return M[l]=(M[l]||0)+Number(R),{value:p,alignment:C,...t?.options?.bgColor&&{fgColor:{argb:t.options.bgColor}},...t?.options?.txtColor&&{color:{argb:t.options.txtColor}},numFmt:t?.options?.format==="RP"?"#,##0":t?.options?.format==="GR"?"#,##0.000":void 0}}),o=g.addRow(u.map(t=>t.value));u.forEach((t,p)=>{let C=o.getCell(p+1),l=["center","right","left","fill","justify","centerContinuous","distributed"],R=["top","middle","bottom","distributed","justify"],k,$;t.alignment&&typeof t.alignment.horizontal=="string"&&l.includes(t.alignment.horizontal)&&(k=t.alignment.horizontal),t.alignment&&"vertical"in t.alignment&&typeof t.alignment.vertical=="string"&&R.includes(t.alignment.vertical)&&($=t.alignment.vertical),C.alignment={...k?{horizontal:k}:{},...$?{vertical:$}:{}},!t.isImage&&"numFmt"in t&&t.numFmt&&typeof t.value=="number"&&!isNaN(t.value)&&(C.value=Number(t.value),C.numFmt=t.numFmt),!t.isImage&&"fgColor"in t&&t.fgColor&&(C.fill={type:"pattern",pattern:"solid",fgColor:t.fgColor}),!t.isImage&&"color"in t&&t.color&&(C.font={color:t.color})}),await Y(d,g,o,u)}});let L=g.addRow(s.map(()=>null)),S=A(s);m?.grandTotal?.disableGrandTotal||(S.forEach((r,i)=>{if(r?.options?.format==="RP"||r?.options?.format==="GR"||r?.options?.format==="NUMBER"){let o=f.length+4-1,t=`SUM(${String.fromCharCode(65+i)}4:${String.fromCharCode(65+i)}${o})`,p=L.getCell(i+1),C=m?.grandTotal?.enableCount?c.length>0?" : "+f.map(k=>k.detail.length).reduce((k,$)=>k+$,0):" : "+f.length:"",l=m?.grandTotal?.captionItem?m?.grandTotal?.captionItem:"",R=`${m?.grandTotal?.caption||"GRAND TOTAL"} ${C} ${l}`;L.getCell(1).value=R,L.getCell(1).alignment={horizontal:"center"},p.numFmt=r?.options?.format==="GR"?"#,##0.000":"#,##0",p.value={formula:t},L.getCell(i+1).value=r?.options.disabledFooter?"":M[r.key]}else L.getCell(i+1).value=""}),n?.grandTotalSetting?.colSpan&&g.mergeCells(`A${L.number}:${String.fromCharCode(64+Number(n?.grandTotalSetting?.colSpan))}${L.number}`),L.eachCell(r=>{r.fill={type:"pattern",pattern:"solid",fgColor:{argb:n?.bgColor||"#E8E5E5"},bgColor:{argb:n?.bgColor||"#E8E5E5"}},r.font={color:{argb:n?.txtColor},bold:!0}})),n?.customFooter&&n.customFooter(g,x);let a=await d.xlsx.writeBuffer();if(n?.returnBuffer)return a;let y=new Blob([a],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),T=document.createElement("a");T.href=URL.createObjectURL(y),T.download=`${n?.titleExcel||b}.xlsx`,document.body.appendChild(T),T.click(),document.body.removeChild(T)},W=ot;import et from"jspdf";import J from"jspdf-autotable";var rt=({columns:s,data:f,grouping:c,pdfSetting:e,date:n,title:b,footerSetting:m,groupingSetting:w})=>{let d=new et(e?.orientation,e?.unit,[e?.width||297,e?.height||210]),g=[],x=n?30:20;s=s.filter(a=>!a.options?.disabledColumn),d.setFontSize(10);let F=d.internal.pageSize.getWidth(),P=d.splitTextToSize(e?.textHeaderLeft||"",110);d.text(P,15,18),d.text(`${b||e?.titlePdf}`,F-15,18,{align:"right"}),n&&d.text(`${n.caption?n.caption:"TANGGAL "} : ${n?.start_date} ${n?.end_date?`s/d ${n?.end_date}`:""}`,F-15,22,{align:"right"}),typeof e?.customHeader=="function"&&e.customHeader(d,x,J),d.setProperties({title:b||e?.titlePdf}),e?.startY&&(x=e.startY);let v=[],I=[],D=s.some(a=>a.child&&a.child.length>0);s.forEach(a=>{let y={textColor:`#${E(e?.txtColor||"000")}`,fillColor:`#${E(e?.bgColor||"E8E5E5")}`,...a?.options?.width&&{cellWidth:a?.options?.width},fontStyle:"bold",...a?.options?.valign?{valign:a.options.valign}:{},halign:a?.options?.halign??(["RP","GR","NUMBER"].includes(a?.options?.format||"")?"right":"left")};D?a.child&&a.child.length>0?(v.push({content:a.label,colSpan:a.child.length,styles:y}),a.child.forEach(T=>{I.push({content:T.label,key:T.key,options:T.options,styles:{...y,halign:T?.options?.halign??(["RP","GR","NUMBER"].includes(T?.options?.format||"")?"right":"left")}})})):v.push({content:a.label,rowSpan:2,key:a.key,options:a.options,styles:y}):v.push({content:a.label,key:a.key,options:a.options,styles:y})}),e?.header?.column||(g.push(v),D&&I.length>0&&g.push(I));let h={};f.forEach(a=>{if(a.detail?.length>0){if(c.length>0){let r=U(s),i=c.map(t=>a[t]!==void 0||a[t]!==null?`${H(t)} : ${a[t]}`:"").filter(Boolean).join("  |  "),u=typeof w=="function"?w(a):w||{},o=[{content:i,colSpan:r,styles:{fontStyle:"bold",halign:u?.halign||"left",textColor:`#${E(u?.txtColor||"000")}`,fillColor:`#${E(u?.bgColor||"FFF")}`}}];g.push(o)}let y={},T=A(s);if(a.detail.forEach(r=>{let i=T.map(u=>{let o=r[u.key],t=u.key;u.formatter&&(o=u.formatter(o,r));let p=r[u.key];h[t]=(h[t]||0)+Number(p||0),y[t]=(y[t]||0)+Number(p||0);let C=u.options?.format==="IMAGE";return{content:(()=>{switch(u?.options?.format){case"RP":return o!==void 0?Number(o||0).toLocaleString("kr-ko"):"";case"GR":return o!==void 0?Number(o||0).toFixed(3):"";case"NUMBER":return o!==void 0?Number(o||0):"";case"IMAGE":return"";case"DATETIME":return o!==void 0?z(o||new Date,!0):"";case"DATE":return o!==void 0?z(o||new Date):"";default:return o!==void 0?o.toString():""}})(),foto:C?o:null,styles:{textColor:u?.options?.txtColor?`#${E(u?.options?.txtColor)}`:"#000",fillColor:u?.options?.bgColor?`#${E(u?.options?.bgColor)}`:void 0,halign:u?.options?.halign?u?.options?.halign:u?.options?.format==="RP"||u?.options?.format==="GR"||u?.options?.format==="NUMBER"||typeof o=="number"?"right":"left"}}});g.push(i)}),!m?.subTotal?.disableSubtotal){let r=[];T.forEach(t=>{let p=y[t.key];t?.options?.format==="RP"||t?.options?.format==="GR"||t?.options?.format==="NUMBER"?r.push({content:t?.options?.disabledFooter?"":(()=>{switch(t?.options?.format){case"RP":return p.toLocaleString("kr-ko");case"GR":return p.toFixed(3);case"NUMBER":return p;default:return p.toString()}})(),styles:{halign:t?.options?.halign||"right",textColor:`#${E(e?.txtColor||"000")}`,fillColor:`#${E(e?.bgColor||"E8E5E5")}`,fontStyle:"bold"}}):r.push({content:"",styles:{textColor:`#${E(e?.txtColor||"000")}`,fillColor:`#${E(e?.bgColor||"E8E5E5")}`,fontStyle:"bold"}})});let i=e?.grandTotalSetting?.colSpan?Number(e?.grandTotalSetting?.colSpan||0)+1:0,u=m?.subTotal?.enableCount&&c.length>0?" : "+a.detail.length:"",o=m?.subTotal?.captionItem?m?.subTotal?.captionItem:"";r[0]={content:`${m?.subTotal?.caption||"SUB TOTAL"}${u} ${o}`,colSpan:i,styles:{textColor:`#${E(e?.txtColor||"000")}`,fillColor:`#${E(e?.bgColor||"E8E5E5")}`,fontStyle:"bold",halign:"center"}},e?.grandTotalSetting?.colSpan&&r.splice(1,e?.grandTotalSetting?.colSpan),g.push(r)}}else{let y=(i,u)=>{let o=u[i.key],t=i.key;if(i.formatter&&(o=i.formatter(o,u)),!i.options?.disabledFooter){let R=u[i.key];h[t]=(h[t]||0)+Number(R||0)}let p=(()=>{switch(i?.options?.format){case"RP":return o!==void 0?Number(o||0).toLocaleString("kr-ko"):"";case"GR":return o!==void 0?Number(o||0).toFixed(3):"";case"NUMBER":return o!==void 0?Number(o||0):"";case"IMAGE":return"";case"DATETIME":return o!==void 0?z(o||new Date,!0):"";case"DATE":return o!==void 0?z(o||new Date):"";default:return o!==void 0?o?.toString():""}})(),C=i?.options?.halign?i?.options?.halign:i?.options?.format==="RP"||i?.options?.format==="GR"||i?.options?.format==="NUMBER"||typeof o=="number"?"right":"left",l=i.options?.format==="IMAGE";return{options:i?.options,content:p,foto:l?o:null,styles:{halign:C,textColor:i?.options?.txtColor?`#${E(i?.options?.txtColor)}`:"#000",fillColor:i?.options?.bgColor?`#${E(i?.options?.bgColor)}`:void 0}}},r=A(s).map(i=>y(i,a));g.push(r)}});let G=A(s);if(!m?.grandTotal?.disableGrandTotal){let a=[];G.forEach(o=>{let t=h[o.key],p=["RP","GR","NUMBER"].includes(o?.options?.format||""),C=o?.options?.disabledFooter?"":(()=>{if(!p)return"";switch(o.options?.format){case"RP":return Number(t||0).toLocaleString("kr-KO");case"GR":return Number(t||0).toFixed(3);case"NUMBER":return Number(t||0);default:return(t||0).toString()}})();a.push({options:o?.options,content:C,styles:{halign:o?.options?.halign?o.options.halign:p?"right":"left",textColor:`#${E(e?.txtColor||"000")}`,fillColor:`#${E(e?.bgColor||"E8E5E5")}`,fontStyle:"bold"}})});let y=Number(e?.grandTotalSetting?.colSpan||0),T=Math.min(y+1,G.length),r=m?.grandTotal?.enableCount?c.length>0?f.reduce((o,t)=>o+t.detail.length,0):f.length:0,i=m?.grandTotal?.captionItem||"",u=`${m?.grandTotal?.caption||"GRAND TOTAL"}`+(r?` : ${r}`:"")+(i?` ${i}`:"");for(a[0]={content:u,colSpan:T,styles:{textColor:`#${E(e?.txtColor||"000")}`,fillColor:`#${E(e?.bgColor||"E8E5E5")}`,fontStyle:"bold",halign:"center"}},a.splice(1,T-1);a.length<G.length;)a.push({content:"",styles:{textColor:`#${E(e?.txtColor||"000")}`,fillColor:`#${E(e?.bgColor||"E8E5E5")}`,fontStyle:"bold"}});g.push(a)}if(typeof e?.addRow=="function"&&e?.addRow(g),!e?.disablePrintDate){let a=U(s);g.push([{content:`Print Date : ${z(`${new Date}`)}`,colSpan:a,styles:{textColor:`#${E(e?.txtColor||"000")}`,fillColor:`#${E(e?.bgColor||"E8E5E5")}`,fontStyle:"italic"}}])}let N=[];e?.header?.column&&(N.push(v),D&&I.length>0&&N.push(I)),J(d,{head:N,body:g,startY:x,theme:e?.theme||"plain",rowPageBreak:"avoid",margin:{top:e?.header?.information?30:10},bodyStyles:{fontSize:e?.fontSIze||8},headStyles:{fontSize:e?.fontSIze||8,textColor:`#${E(e?.txtColor||"000")}`,fillColor:`#${E(e?.bgColor||"E8E5E5")}`},tableLineColor:[255,255,255],didParseCell:function(a){let y=a.column.index;G[y]?.options?.format==="IMAGE"&&a.cell.raw&&a.cell.raw.foto&&(a.row.height=20,a.cell.styles.valign="middle",a.cell.styles.halign="center")},didDrawPage:function(a){if(e?.header?.information&&a.pageNumber>1){d.setFontSize(10);let y=d.internal.pageSize.getWidth(),T=d.splitTextToSize(e?.textHeaderLeft||"",110);d.text(T,15,18),d.text(`${b||e?.titlePdf}`,y-15,18,{align:"right"}),n&&d.text(`${n.caption?n.caption:"TANGGAL "} : ${n?.start_date} ${n?.end_date?`s/d ${n?.end_date}`:""}`,y-15,22,{align:"right"})}},didDrawCell:function(a){let{cell:y}=a,r=(y.raw||{}).foto,i=a.column.index;if(G[i]?.options?.format==="IMAGE"&&r){let t=y.x+(y.width-15)/2,p=y.y+(y.height-15)/2;try{d.addImage(r,"JPG",t,p,15,15)}catch(C){console.warn("\u274C Gagal render gambar:",C)}}}}),g=[],x=d.lastAutoTable.finalY;let M=d.internal.getNumberOfPages(),L=d.internal.pageSize.width,S=d.internal.pageSize.height;d.setFontSize(10);for(let a=1;a<M+1;a++){let y=L/2,T=S-10;d.setPage(a),d.text(`${a} of ${M}`,y,T,{align:"center"})}if(typeof e?.customFooter=="function"&&e.customFooter(d,x,J),e?.returnDataUri)return d.output("datauristring");if(e?.openNewTab){let a=d.output("bloburl");window.open(a)}else d.save(`${e?.titlePdf||b}.pdf`)},X=rt;var nt=s=>{let f=[],c=s.copy?2:1;for(let e=0;e<c;e++){let n=s.data.map(b=>{let m=s.template;for(;/\n!!LOOP\((.+)\)(\{\n(.*\n)+\})\n/gm.exec(m);)m=m.replace(/\n!!LOOP\((.+)\)(\{\n(.*\n)+\})\n/,(w,d,g)=>{let x=g.replace(/^\{/,"").replace(/\}$/,"");return(Array.isArray(b[d])?b[d]:[b[d]]).reduce((v,I)=>v+x.replace(/\{([a-z0-9_]+)\}/gm,D=>{let h=D.replace(/(\{|\})/g,"");if(h.match(/nama_barang/)){let G=h.match(/nama_barang/),N=h==="nama_barang2"?[20,40]:h==="nama_barang3"?[40,60]:[0,20];return I[G]?.slice(...N).trim()||""}if(h.match(/deskripsi_jual/)){let G=h.match(/deskripsi_jual/),N=h==="deskripsi_jual2"?[20,40]:h==="deskripsi_jual3"?[40,60]:[0,20];return I[G]?.slice(...N).trim()||""}if(h.match(/deskripsi/)){let G=h.match(/deskripsi/),N=h==="deskripsi2"?[20,40]:h==="deskripsi3"?[40,60]:[0,20];return I[G]?.slice(...N).trim()||""}return I[h]||""}),"").replace(/\n(\s)+\n/gm,`
`)});return m.replace(/\{([a-z0-9_]+)\}/gm,w=>{let d=w.replace(/(\{|\})/g,"");return d.match(/auto_cut/)?`
VA`:b[d]||""}).replace(/\n(\s)+\n/gm,`
`).replace(/~new_line~/gm,`
`).replace(/!!LOOP\(detail\)/g,"").replace(/[}{]/g,"")});for(let b in n)n[b]+=`

`;f.push(...n)}return f},at=async(s,f)=>{let c=nt(s),e=new Blob([c?.join(`
`)||""],{type:"text/plain"}),n=document.createElement("a");n.href=URL.createObjectURL(e),n.download=f,document.body.appendChild(n),n.click(),document.body.removeChild(n)},K=at;var vt=({columns:s,data:f,grouping:c,date:e,type:n,txtSetting:b,pdfSetting:m,excelSetting:w,title:d,footerSetting:g,groupingSetting:x})=>{let F={data:[b?.dataTxt],template:b?.templateTxt,copy:b?.copy};if(f.length===0)throw new Error("Data is required");if(n.length===0)throw new Error("Type is required");if(!Q(n))throw new Error('Type Export must use ["EXCEL", "PDF", "TXT", "ALL"]');n.forEach(P=>{P==="PDF"?X({pdfSetting:m,date:e,data:f,type:n,columns:s,grouping:c,title:d,footerSetting:g,groupingSetting:x}):P==="TXT"?K(F,b?.titleTxt||""):P==="EXCEL"?W({date:e,data:f,type:n,columns:s,grouping:c,excelSetting:w,title:d,footerSetting:g,groupingSetting:x}):(W({date:e,data:f,type:n,columns:s,grouping:c,excelSetting:w,title:d,groupingSetting:x}),X({pdfSetting:m,date:e,data:f,type:n,columns:s,grouping:c,title:d,groupingSetting:x}),K(F,b?.titleTxt||""))})};export{vt as ExportData};
//# sourceMappingURL=index.mjs.map