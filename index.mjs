var K=["EXCEL","PDF","TXT","ALL"];function z(d,g=!1){let m=new Date(d),e=new Date(m.getTime()+420*60*1e3),r=e.getUTCFullYear(),b=String(e.getUTCMonth()+1).padStart(2,"0"),u=String(e.getUTCDate()).padStart(2,"0"),f=String(e.getUTCHours()).padStart(2,"0"),s=String(e.getUTCMinutes()).padStart(2,"0"),k=String(e.getUTCSeconds()).padStart(2,"0");return g?`${u}-${b}-${r} ${f}:${s}:${k}`:`${u}-${b}-${r}`}function q(d){return d.every(g=>K.includes(g))}function M(d){let g=0;return d.forEach(m=>{m.child&&m.child.length>0?g+=M(m.child):g+=1}),g}var P=d=>{let g=[];return d.forEach(m=>{m.child&&m.child.length>0?g.push(...P(m.child)):g.push(m)}),g},_=d=>d.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ");async function V(d,g,m,e){for(let r=0;r<e.length;r++){let b=e[r];if(b?.isImage&&b?.imageSrc&&typeof b.imageSrc=="string"&&b.imageSrc.startsWith("data:image"))try{let{buffer:u,extension:f}=Q(b.imageSrc),s=d.addImage({buffer:u,extension:f});g.addImage(s,{tl:{col:r,row:m.number-1},ext:{width:70,height:60},editAs:"oneCell"}),(!m.height||m.height<60)&&(m.height=35)}catch(u){console.error("\u274C Error adding image to row:",u),m.getCell(r+1).value="[Image]"}}}function Q(d){let g=d.match(/^data:image\/(\w+);base64,(.*)$/);if(!g)throw new Error("Invalid base64 image format");let m=g[1]==="jpg"?"jpeg":g[1],e=g[2],r=atob(e),b=r.length,u=new Uint8Array(b);for(let f=0;f<b;f++)u[f]=r.charCodeAt(f);return{buffer:u,extension:m}}var T=d=>{if(!d)return d;let g=d.replace(/^#/,"");return g.length===8?g.substring(2):g};import Z from"exceljs";var tt=async({columns:d,data:g,grouping:m,date:e,excelSetting:r,title:b,footerSetting:u})=>{let f=new Z.Workbook;d=d.filter(n=>!n.options?.disabledColumn);let s=f.addWorksheet(b||r?.titleExcel),k=M(d),v=s.addRow([]);v.getCell(1).value=b||r?.titleExcel,v.getCell(1).alignment={horizontal:"center"};let A=s.getColumn(k).letter;if(s.mergeCells(`A${v.number}:${A}${v.number}`),v.eachCell(n=>{n.font={color:{argb:"000000"},bold:!0,size:12}}),e){let n=s.addRow([]);n.getCell(1).value=`${e.caption?e.caption:"Tanggal "} : ${e?.start_date} ${e?.end_date?`s/d ${e?.end_date}`:""}`,n.getCell(1).alignment={horizontal:"center"},s.mergeCells(`A${n.number}:${A}${n.number}`),n.eachCell(i=>{i.font={color:{argb:"00000"},bold:!0,size:12}})}let I=s.addRow([]);I.getCell(1).value=r?.additionalTextHeader||"",I.getCell(1).alignment={horizontal:"center"},s.mergeCells(`A${I.number}:${A}${I.number}`),I.eachCell(n=>{n.font={color:{argb:"000000"},bold:!0,size:12}}),r?.customHeader&&r.customHeader(s,k);let N=r?.startY&&r.startY>0?r.startY:1;if(N>1)for(let n=1;n<N;n++)s.addRow([]);let F=d.some(n=>n.child&&n.child.length>0),w=s.addRow([]),y=F?s.addRow([]):null;d.forEach(n=>{if(n.child&&n.child.length>0){let i=w.actualCellCount+1,c=n.child.length;w.getCell(i).value=n.label,c>1&&s.mergeCells(w.number,i,w.number,i+c-1);for(let o=i;o<i+c;o++){let t=w.getCell(o);t.fill={type:"pattern",pattern:"solid",fgColor:{argb:r?.bgColor||"E8E5E5"}},t.font={color:{argb:r?.txtColor||"000000"},bold:!0},t.alignment={horizontal:"center",vertical:"middle"}}n.child.forEach((o,t)=>{if(y){let p=y.getCell(i+t);p.value=o.label,p.fill={type:"pattern",pattern:"solid",fgColor:{argb:r?.bgColor||"E8E5E5"}},p.font={color:{argb:r?.txtColor||"000000"},bold:!0};let h=o.options?.halign||(["RP","GR","NUMBER"].includes(o?.options?.format||"")?"right":"left"),l=o.options?.valign||"middle";p.alignment={horizontal:h,vertical:l}}})}else{let i=w.actualCellCount+1;w.getCell(i).value=n.label,w.getCell(i).fill={type:"pattern",pattern:"solid",fgColor:{argb:r?.bgColor||"E8E5E5"}},w.getCell(i).font={color:{argb:r?.txtColor||"000000"},bold:!0},w.getCell(i).alignment={horizontal:n.options?.halign||"center",vertical:n.options?.valign||"middle"},F&&y&&s.mergeCells(w.number,i,y.number,i)}}),P(d).forEach((n,i)=>{let c=i+1,o=s.getColumn(c);if(n.options?.width)o.width=n.options.width;else{let t=n.options?.format==="IMAGE"?15:20;o.width=t}});let G={};g.forEach(async n=>{if(n.detail?.length>0){if(m.length>0){let o=M(d),t=m.map(h=>n[h]!==void 0||n[h]!==null?`${_(h)} : ${n[h]}`:"").filter(Boolean).join("  |  "),p=s.addRow([t]);s.mergeCells(`A${p.number}:${String.fromCharCode(64+o)}${p.number}`),p.getCell(1).alignment={horizontal:"left"},p.getCell(1).font={bold:!0}}let i={};n.detail.forEach(async o=>{let p=P(d).map(l=>{if(l?.options?.format==="IMAGE"&&o[l.key])return{value:"",alignment:{horizontal:"center",vertical:"middle"},isImage:!0,imageSrc:o[l.key]};let R=l?.options?.format==="DATETIME"?z(o[l.key],!0):l?.options?.format==="DATE"?z(o[l.key]):o[l.key];l.formatter&&(R=l.formatter(R,o));let x={horizontal:l?.options?.halign?l?.options?.halign:l?.options?.format==="RP"||l?.options?.format==="GR"||l?.options?.format==="NUMBER"?"right":"left"},$=l.key,U=o[l.key];return G[$]=(G[$]||0)+Number(U),i[$]=(i[$]||0)+Number(U),{value:R,alignment:x,...l?.options?.bgColor&&{fgColor:{argb:l.options.bgColor}},...l?.options?.txtColor&&{color:{argb:l.options.txtColor}},numFmt:l?.options?.format==="RP"?"#,##0":l?.options?.format==="GR"?"#,##0.000":void 0}}),h=s.addRow(p.map(l=>l.value));p.forEach((l,R)=>{let x=h.getCell(R+1),$=["center","right","left","fill","justify","centerContinuous","distributed"],U=["top","middle","bottom","distributed","justify"],S,O;l.alignment&&typeof l.alignment.horizontal=="string"&&$.includes(l.alignment.horizontal)&&(S=l.alignment.horizontal),l.alignment&&"vertical"in l.alignment&&typeof l.alignment.vertical=="string"&&U.includes(l.alignment.vertical)&&(O=l.alignment.vertical),x.alignment={...S?{horizontal:S}:{},...O?{vertical:O}:{}},!l.isImage&&"numFmt"in l&&l.numFmt&&typeof l.value=="number"&&!isNaN(l.value)&&(x.value=Number(l.value),x.numFmt=l.numFmt)}),await V(f,s,h,p)});let c=P(d);if(!u?.subTotal?.disableSubtotal){let o=s.addRow(d.map(()=>null));c.forEach((t,p)=>{if(t?.options?.format==="RP"||t?.options?.format==="GR"||t?.options?.format==="NUMBER"){let l=g.length+4-1,R=`SUM(${String.fromCharCode(65+p)}4:${String.fromCharCode(65+p)}${l})`,x=o.getCell(p+1),$=u?.subTotal?.enableCount&&m.length>0?" : "+n.detail.length:"",U=u?.subTotal?.captionItem?u?.subTotal?.captionItem:"";o.getCell(1).value=`${u?.subTotal?.caption||"SUB TOTAL"} ${$} ${U}`,o.getCell(1).alignment={horizontal:"center"},x.numFmt=t?.options?.format==="GR"?"#,##0.000":"#,##0",x.value={formula:R},o.getCell(p+1).value=t?.options.disabledFooter?"":i[t.key]}else o.getCell(p+1).value=""}),r?.grandTotalSetting?.colSpan&&s.mergeCells(`A${o.number}:${String.fromCharCode(64+Number(r?.grandTotalSetting?.colSpan))}${o.number}`),o.eachCell(t=>{t.fill={type:"pattern",pattern:"solid",fgColor:{argb:r?.bgColor||"#E8E5E5"},bgColor:{argb:r?.bgColor||"#E8E5E5"}},t.font={color:{argb:r?.txtColor},bold:!0}})}}else{let c=P(d).map(t=>{if(t?.options?.format==="IMAGE"&&n[t.key])return{value:"",alignment:{horizontal:"center",vertical:"middle"},isImage:!0,imageSrc:n[t.key]};let p=t?.options?.format==="DATETIME"?z(n[t.key]):t?.options?.format==="DATE"?z(n[t.key]):n[t.key];t.formatter&&(p=t.formatter(p,n));let h={horizontal:t?.options?.halign?t?.options?.halign:t?.options?.format==="RP"||t?.options?.format==="GR"||t?.options?.format==="NUMBER"?"right":"left"},l=t.key,R=n[t.key];return G[l]=(G[l]||0)+Number(R),{value:p,alignment:h,...t?.options?.bgColor&&{fgColor:{argb:t.options.bgColor}},...t?.options?.txtColor&&{color:{argb:t.options.txtColor}},numFmt:t?.options?.format==="RP"?"#,##0":t?.options?.format==="GR"?"#,##0.000":void 0}}),o=s.addRow(c.map(t=>t.value));c.forEach((t,p)=>{let h=o.getCell(p+1),l=["center","right","left","fill","justify","centerContinuous","distributed"],R=["top","middle","bottom","distributed","justify"],x,$;t.alignment&&typeof t.alignment.horizontal=="string"&&l.includes(t.alignment.horizontal)&&(x=t.alignment.horizontal),t.alignment&&"vertical"in t.alignment&&typeof t.alignment.vertical=="string"&&R.includes(t.alignment.vertical)&&($=t.alignment.vertical),h.alignment={...x?{horizontal:x}:{},...$?{vertical:$}:{}},!t.isImage&&"numFmt"in t&&t.numFmt&&typeof t.value=="number"&&!isNaN(t.value)&&(h.value=Number(t.value),h.numFmt=t.numFmt),!t.isImage&&"fgColor"in t&&t.fgColor&&(h.fill={type:"pattern",pattern:"solid",fgColor:t.fgColor}),!t.isImage&&"color"in t&&t.color&&(h.font={color:t.color})}),await V(f,s,o,c)}});let D=s.addRow(d.map(()=>null)),H=P(d);u?.grandTotal?.disableGrandTotal||(H.forEach((n,i)=>{if(n?.options?.format==="RP"||n?.options?.format==="GR"||n?.options?.format==="NUMBER"){let o=g.length+4-1,t=`SUM(${String.fromCharCode(65+i)}4:${String.fromCharCode(65+i)}${o})`,p=D.getCell(i+1),h=u?.grandTotal?.enableCount?m.length>0?" : "+g.map(x=>x.detail.length).reduce((x,$)=>x+$,0):" : "+g.length:"",l=u?.grandTotal?.captionItem?u?.grandTotal?.captionItem:"",R=`${u?.grandTotal?.caption||"GRAND TOTAL"} ${h} ${l}`;D.getCell(1).value=R,D.getCell(1).alignment={horizontal:"center"},p.numFmt=n?.options?.format==="GR"?"#,##0.000":"#,##0",p.value={formula:t},D.getCell(i+1).value=n?.options.disabledFooter?"":G[n.key]}else D.getCell(i+1).value=""}),r?.grandTotalSetting?.colSpan&&s.mergeCells(`A${D.number}:${String.fromCharCode(64+Number(r?.grandTotalSetting?.colSpan))}${D.number}`),D.eachCell(n=>{n.fill={type:"pattern",pattern:"solid",fgColor:{argb:r?.bgColor||"#E8E5E5"},bgColor:{argb:r?.bgColor||"#E8E5E5"}},n.font={color:{argb:r?.txtColor},bold:!0}})),r?.customFooter&&r.customFooter(s,k);let a=await f.xlsx.writeBuffer(),C=new Blob([a],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),E=document.createElement("a");E.href=URL.createObjectURL(C),E.download=`${r?.titleExcel||b}.xlsx`,document.body.appendChild(E),E.click(),document.body.removeChild(E)},Y=tt;import ot from"jspdf";import W from"jspdf-autotable";var et=({columns:d,data:g,grouping:m,pdfSetting:e,date:r,title:b,footerSetting:u})=>{let f=new ot(e?.orientation,e?.unit,[e?.width||297,e?.height||210]),s=[],k=r?30:20;d=d.filter(a=>!a.options?.disabledColumn),f.setFontSize(10);let v=f.internal.pageSize.getWidth(),A=f.splitTextToSize(e?.textHeaderLeft||"",110);f.text(A,15,18),f.text(`${b||e?.titlePdf}`,v-15,18,{align:"right"}),r&&f.text(`${r.caption?r.caption:"TANGGAL "} : ${r?.start_date} ${r?.end_date?`s/d ${r?.end_date}`:""}`,v-15,22,{align:"right"}),typeof e?.customHeader=="function"&&e.customHeader(f,k,W),f.setProperties({title:b||e?.titlePdf}),e?.startY&&(k=e.startY);let I=[],N=[],F=d.some(a=>a.child&&a.child.length>0);d.forEach(a=>{let C={textColor:`#${T(e?.txtColor||"000")}`,fillColor:`#${T(e?.bgColor||"E8E5E5")}`,...a?.options?.width&&{cellWidth:a?.options?.width},fontStyle:"bold",...a?.options?.valign?{valign:a.options.valign}:{},halign:a?.options?.halign??(["RP","GR","NUMBER"].includes(a?.options?.format||"")?"right":"left")};F?a.child&&a.child.length>0?(I.push({content:a.label,colSpan:a.child.length,styles:C}),a.child.forEach(E=>{N.push({content:E.label,key:E.key,options:E.options,styles:{...C,halign:E?.options?.halign??(["RP","GR","NUMBER"].includes(E?.options?.format||"")?"right":"left")}})})):I.push({content:a.label,rowSpan:2,key:a.key,options:a.options,styles:C}):I.push({content:a.label,key:a.key,options:a.options,styles:C})}),s.push(I),F&&N.length>0&&s.push(N);let w={};g.forEach(a=>{if(a.detail?.length>0){if(m.length>0){let n=M(d),c=[{content:m.map(o=>a[o]!==void 0||a[o]!==null?`${_(o)} : ${a[o]}`:"").filter(Boolean).join("  |  "),colSpan:n,styles:{fontStyle:"bold",halign:"left"}}];s.push(c)}let C={},E=P(d);if(a.detail.forEach(n=>{let i=E.map(c=>{let o=n[c.key],t=c.key;c.formatter&&(o=c.formatter(o,n));let p=n[c.key];w[t]=(w[t]||0)+Number(p||0),C[t]=(C[t]||0)+Number(p||0);let h=c.options?.format==="IMAGE";return{content:(()=>{switch(c?.options?.format){case"RP":return o!==void 0?Number(o||0).toLocaleString("kr-ko"):"";case"GR":return o!==void 0?Number(o||0).toFixed(3):"";case"NUMBER":return o!==void 0?Number(o||0):"";case"IMAGE":return"";case"DATETIME":return o!==void 0?z(o||new Date,!0):"";case"DATE":return o!==void 0?z(o||new Date):"";default:return o!==void 0?o.toString():""}})(),foto:h?o:null,styles:{textColor:c?.options?.txtColor?`#${T(c?.options?.txtColor)}`:void 0,fillColor:c?.options?.bgColor?`#${T(c?.options?.bgColor)}`:void 0,halign:c?.options?.halign?c?.options?.halign:c?.options?.format==="RP"||c?.options?.format==="GR"||c?.options?.format==="NUMBER"||typeof o=="number"?"right":"left"}}});s.push(i)}),!u?.subTotal?.disableSubtotal){let n=[];E.forEach(t=>{let p=C[t.key];t?.options?.format==="RP"||t?.options?.format==="GR"||t?.options?.format==="NUMBER"?n.push({content:t?.options?.disabledFooter?"":(()=>{switch(t?.options?.format){case"RP":return p.toLocaleString("kr-ko");case"GR":return p.toFixed(3);case"NUMBER":return p;default:return p.toString()}})(),styles:{halign:t?.options?.halign||"right",textColor:`#${T(e?.txtColor||"000")}`,fillColor:`#${T(e?.bgColor||"E8E5E5")}`,fontStyle:"bold"}}):n.push({content:"",styles:{textColor:`#${T(e?.txtColor||"000")}`,fillColor:`#${T(e?.bgColor||"E8E5E5")}`,fontStyle:"bold"}})});let i=e?.grandTotalSetting?.colSpan?Number(e?.grandTotalSetting?.colSpan||0)+1:0,c=u?.subTotal?.enableCount&&m.length>0?" : "+a.detail.length:"",o=u?.subTotal?.captionItem?u?.subTotal?.captionItem:"";n[0]={content:`${u?.subTotal?.caption||"SUB TOTAL"}${c} ${o}`,colSpan:i,styles:{textColor:`#${T(e?.txtColor||"000")}`,fillColor:`#${T(e?.bgColor||"E8E5E5")}`,fontStyle:"bold",halign:"center"}},e?.grandTotalSetting?.colSpan&&n.splice(1,e?.grandTotalSetting?.colSpan),s.push(n)}}else{let C=(i,c)=>{let o=c[i.key],t=i.key;if(i.formatter&&(o=i.formatter(o,c)),!i.options?.disabledFooter){let R=c[i.key];w[t]=(w[t]||0)+Number(R||0)}let p=(()=>{switch(i?.options?.format){case"RP":return o!==void 0?Number(o||0).toLocaleString("kr-ko"):"";case"GR":return o!==void 0?Number(o||0).toFixed(3):"";case"NUMBER":return o!==void 0?Number(o||0):"";case"IMAGE":return"";case"DATETIME":return o!==void 0?z(o||new Date,!0):"";case"DATE":return o!==void 0?z(o||new Date):"";default:return o!==void 0?o?.toString():""}})(),h=i?.options?.halign?i?.options?.halign:i?.options?.format==="RP"||i?.options?.format==="GR"||i?.options?.format==="NUMBER"||typeof o=="number"?"right":"left",l=i.options?.format==="IMAGE";return{options:i?.options,content:p,foto:l?o:null,styles:{halign:h,textColor:i?.options?.txtColor?`#${T(i?.options?.txtColor)}`:"#000",fillColor:i?.options?.bgColor?`#${T(i?.options?.bgColor)}`:void 0}}},n=P(d).map(i=>C(i,a));s.push(n)}});let y=P(d);if(!u?.grandTotal?.disableGrandTotal){let a=[];y.forEach(o=>{let t=w[o.key],p=["RP","GR","NUMBER"].includes(o?.options?.format||""),h=o?.options?.disabledFooter?"":(()=>{if(!p)return"";switch(o.options?.format){case"RP":return Number(t||0).toLocaleString("kr-KO");case"GR":return Number(t||0).toFixed(3);case"NUMBER":return Number(t||0);default:return(t||0).toString()}})();a.push({options:o?.options,content:h,styles:{halign:o?.options?.halign?o.options.halign:p?"right":"left",textColor:`#${T(e?.txtColor||"000")}`,fillColor:`#${T(e?.bgColor||"E8E5E5")}`,fontStyle:"bold"}})});let C=Number(e?.grandTotalSetting?.colSpan||0),E=Math.min(C+1,y.length),n=u?.grandTotal?.enableCount?m.length>0?g.reduce((o,t)=>o+t.detail.length,0):g.length:0,i=u?.grandTotal?.captionItem||"",c=`${u?.grandTotal?.caption||"GRAND TOTAL"}`+(n?` : ${n}`:"")+(i?` ${i}`:"");for(a[0]={content:c,colSpan:E,styles:{textColor:`#${T(e?.txtColor||"000")}`,fillColor:`#${T(e?.bgColor||"E8E5E5")}`,fontStyle:"bold",halign:"center"}},a.splice(1,E-1);a.length<y.length;)a.push({content:"",styles:{textColor:`#${T(e?.txtColor||"000")}`,fillColor:`#${T(e?.bgColor||"E8E5E5")}`,fontStyle:"bold"}});s.push(a)}if(typeof e?.addRow=="function"&&e?.addRow(s),!e?.disablePrintDate){let a=M(d);s.push([{content:`Print Date : ${z(`${new Date}`)}`,colSpan:a,styles:{textColor:`#${T(e?.txtColor||"000")}`,fillColor:`#${T(e?.bgColor||"E8E5E5")}`,fontStyle:"italic"}}])}let L=[];e?.header?.column&&(L.push(I),F&&N.length>0&&L.push(N)),W(f,{head:L,body:s,startY:k,theme:e?.theme||"plain",rowPageBreak:"avoid",margin:{top:e?.header?.information?30:10},bodyStyles:{fontSize:e?.fontSIze||8},headStyles:{fontSize:e?.fontSIze||8,textColor:`#${T(e?.txtColor||"000")}`,fillColor:`#${T(e?.bgColor||"E8E5E5")}`},tableLineColor:[255,255,255],didParseCell:function(a){let C=a.column.index;y[C]?.options?.format==="IMAGE"&&a.cell.raw&&a.cell.raw.foto&&(a.row.height=20,a.cell.styles.valign="middle",a.cell.styles.halign="center")},didDrawPage:function(a){if(e?.header?.information&&a.pageNumber>1){f.setFontSize(10);let C=f.internal.pageSize.getWidth(),E=f.splitTextToSize(e?.textHeaderLeft||"",110);f.text(E,15,18),f.text(`${b||e?.titlePdf}`,C-15,18,{align:"right"}),r&&f.text(`${r.caption?r.caption:"TANGGAL "} : ${r?.start_date} ${r?.end_date?`s/d ${r?.end_date}`:""}`,C-15,22,{align:"right"})}},didDrawCell:function(a){let{cell:C}=a,n=(C.raw||{}).foto,i=a.column.index;if(y[i]?.options?.format==="IMAGE"&&n){let t=C.x+(C.width-15)/2,p=C.y+(C.height-15)/2;try{f.addImage(n,"JPG",t,p,15,15)}catch(h){console.warn("\u274C Gagal render gambar:",h)}}}}),s=[],k=f.lastAutoTable.finalY;let G=f.internal.getNumberOfPages(),D=f.internal.pageSize.width,H=f.internal.pageSize.height;f.setFontSize(10);for(let a=1;a<G+1;a++){let C=D/2,E=H-10;f.setPage(a),f.text(`${a} of ${G}`,C,E,{align:"center"})}if(typeof e?.customFooter=="function"&&e.customFooter(f,k,W),e?.openNewTab){let a=f.output("bloburl");window.open(a)}else f.save(`${e?.titlePdf||b}.pdf`)},J=et;var nt=d=>{let g=[],m=d.copy?2:1;for(let e=0;e<m;e++){let r=d.data.map(b=>{let u=d.template;for(;/\n!!LOOP\((.+)\)(\{\n(.*\n)+\})\n/gm.exec(u);)u=u.replace(/\n!!LOOP\((.+)\)(\{\n(.*\n)+\})\n/,(f,s,k)=>{let v=k.replace(/^\{/,"").replace(/\}$/,"");return(Array.isArray(b[s])?b[s]:[b[s]]).reduce((N,F)=>N+v.replace(/\{([a-z0-9_]+)\}/gm,w=>{let y=w.replace(/(\{|\})/g,"");if(y.match(/nama_barang/)){let L=y.match(/nama_barang/),G=y==="nama_barang2"?[20,40]:y==="nama_barang3"?[40,60]:[0,20];return F[L]?.slice(...G).trim()||""}if(y.match(/deskripsi_jual/)){let L=y.match(/deskripsi_jual/),G=y==="deskripsi_jual2"?[20,40]:y==="deskripsi_jual3"?[40,60]:[0,20];return F[L]?.slice(...G).trim()||""}if(y.match(/deskripsi/)){let L=y.match(/deskripsi/),G=y==="deskripsi2"?[20,40]:y==="deskripsi3"?[40,60]:[0,20];return F[L]?.slice(...G).trim()||""}return F[y]||""}),"").replace(/\n(\s)+\n/gm,`
`)});return u.replace(/\{([a-z0-9_]+)\}/gm,f=>{let s=f.replace(/(\{|\})/g,"");return s.match(/auto_cut/)?`
VA`:b[s]||""}).replace(/\n(\s)+\n/gm,`
`).replace(/~new_line~/gm,`
`).replace(/!!LOOP\(detail\)/g,"").replace(/[}{]/g,"")});for(let b in r)r[b]+=`

`;g.push(...r)}return g},rt=async(d,g)=>{let m=nt(d),e=new Blob([m?.join(`
`)||""],{type:"text/plain"}),r=document.createElement("a");r.href=URL.createObjectURL(e),r.download=g,document.body.appendChild(r),r.click(),document.body.removeChild(r)},X=rt;var $t=({columns:d,data:g,grouping:m,date:e,type:r,txtSetting:b,pdfSetting:u,excelSetting:f,title:s,footerSetting:k})=>{let v={data:[b?.dataTxt],template:b?.templateTxt,copy:b?.copy};if(g.length===0)throw new Error("Data is required");if(r.length===0)throw new Error("Type is required");if(!q(r))throw new Error('Type Export must use ["EXCEL", "PDF", "TXT", "ALL"]');r.forEach(A=>{A==="PDF"?J({pdfSetting:u,date:e,data:g,type:r,columns:d,grouping:m,title:s,footerSetting:k}):A==="TXT"?X(v,b?.titleTxt||""):A==="EXCEL"?Y({date:e,data:g,type:r,columns:d,grouping:m,excelSetting:f,title:s,footerSetting:k}):(Y({date:e,data:g,type:r,columns:d,grouping:m,excelSetting:f,title:s}),J({pdfSetting:u,date:e,data:g,type:r,columns:d,grouping:m,title:s}),X(v,b?.titleTxt||""))})};export{$t as ExportData};
//# sourceMappingURL=index.mjs.map