var q=["EXCEL","PDF","TXT","ALL"];function z(s,f=!1){let c=new Date(s),o=new Date(c.getTime()+420*60*1e3),a=o.getUTCFullYear(),b=String(o.getUTCMonth()+1).padStart(2,"0"),m=String(o.getUTCDate()).padStart(2,"0"),w=String(o.getUTCHours()).padStart(2,"0"),d=String(o.getUTCMinutes()).padStart(2,"0"),g=String(o.getUTCSeconds()).padStart(2,"0");return f?`${m}-${b}-${a} ${w}:${d}:${g}`:`${m}-${b}-${a}`}function Q(s){return s.every(f=>q.includes(f))}function M(s){let f=0;return s.forEach(c=>{c.child&&c.child.length>0?f+=M(c.child):f+=1}),f}var A=s=>{let f=[];return s.forEach(c=>{c.child&&c.child.length>0?f.push(...A(c.child)):f.push(c)}),f},H=s=>s.split("_").map(o=>o.charAt(0).toUpperCase()+o.slice(1)).join(" ");async function Y(s,f,c,o){for(let a=0;a<o.length;a++){let b=o[a];if(b?.isImage&&b?.imageSrc&&typeof b.imageSrc=="string"&&b.imageSrc.startsWith("data:image"))try{let{buffer:m,extension:w}=Z(b.imageSrc),d=s.addImage({buffer:m,extension:w});f.addImage(d,{tl:{col:a,row:c.number-1},ext:{width:70,height:60},editAs:"oneCell"}),(!c.height||c.height<60)&&(c.height=35)}catch(m){console.error("\u274C Error adding image to row:",m),c.getCell(a+1).value="[Image]"}}}function Z(s){let f=s.match(/^data:image\/(\w+);base64,(.*)$/);if(!f)throw new Error("Invalid base64 image format");let c=f[1]==="jpg"?"jpeg":f[1],o=f[2],a=atob(o),b=a.length,m=new Uint8Array(b);for(let w=0;w<b;w++)m[w]=a.charCodeAt(w);return{buffer:m,extension:c}}var E=s=>{if(!s)return s;let f=s.replace(/^#/,"");return f.length===8?f.substring(2):f};import tt from"exceljs";var ot=async({columns:s,data:f,grouping:c,date:o,excelSetting:a,title:b,footerSetting:m,groupingSetting:w})=>{let d=new tt.Workbook;s=s.filter(r=>!r.options?.disabledColumn);let g=d.addWorksheet(b||a?.titleExcel),x=M(s),F=g.addRow([]);F.getCell(1).value=b||a?.titleExcel,F.getCell(1).alignment={horizontal:"center"};let P=g.getColumn(x).letter;if(g.mergeCells(`A${F.number}:${P}${F.number}`),F.eachCell(r=>{r.font={color:{argb:"000000"},bold:!0,size:12}}),o){let r=g.addRow([]);r.getCell(1).value=`${o.caption?o.caption:"Tanggal "} : ${o?.start_date} ${o?.end_date?`s/d ${o?.end_date}`:""}`,r.getCell(1).alignment={horizontal:"center"},g.mergeCells(`A${r.number}:${P}${r.number}`),r.eachCell(i=>{i.font={color:{argb:"00000"},bold:!0,size:12}})}let v=g.addRow([]);v.getCell(1).value=a?.additionalTextHeader||"",v.getCell(1).alignment={horizontal:"center"},g.mergeCells(`A${v.number}:${P}${v.number}`),v.eachCell(r=>{r.font={color:{argb:"000000"},bold:!0,size:12}}),a?.customHeader&&a.customHeader(g,x);let I=a?.startY&&a.startY>0?a.startY:1;if(I>1)for(let r=1;r<I;r++)g.addRow([]);let L=s.some(r=>r.child&&r.child.length>0),h=g.addRow([]),G=L?g.addRow([]):null;s.forEach(r=>{if(r.child&&r.child.length>0){let i=h.actualCellCount+1,u=r.child.length;h.getCell(i).value=r.label,u>1&&g.mergeCells(h.number,i,h.number,i+u-1);for(let e=i;e<i+u;e++){let t=h.getCell(e);t.fill={type:"pattern",pattern:"solid",fgColor:{argb:a?.bgColor||"E8E5E5"}},t.font={color:{argb:a?.txtColor||"000000"},bold:!0},t.alignment={horizontal:"center",vertical:"middle"}}r.child.forEach((e,t)=>{if(G){let p=G.getCell(i+t);p.value=e.label,p.fill={type:"pattern",pattern:"solid",fgColor:{argb:a?.bgColor||"E8E5E5"}},p.font={color:{argb:a?.txtColor||"000000"},bold:!0};let C=e.options?.halign||(["RP","GR","NUMBER"].includes(e?.options?.format||"")?"right":"left"),l=e.options?.valign||"middle";p.alignment={horizontal:C,vertical:l}}})}else{let i=h.actualCellCount+1;h.getCell(i).value=r.label,h.getCell(i).fill={type:"pattern",pattern:"solid",fgColor:{argb:a?.bgColor||"E8E5E5"}},h.getCell(i).font={color:{argb:a?.txtColor||"000000"},bold:!0},h.getCell(i).alignment={horizontal:r.options?.halign||"center",vertical:r.options?.valign||"middle"},L&&G&&g.mergeCells(h.number,i,G.number,i)}}),A(s).forEach((r,i)=>{let u=i+1,e=g.getColumn(u);if(r.options?.width)e.width=r.options.width;else{let t=r.options?.format==="IMAGE"?15:20;e.width=t}});let U={};f.forEach(async r=>{if(r.detail?.length>0){if(c.length>0){let e=M(s),t=c.map(l=>r[l]!==void 0||r[l]!==null?`${H(l)} : ${r[l]}`:"").filter(Boolean).join("  |  "),p=typeof w=="function"?w(r):w||{},C=g.addRow([t]);g.mergeCells(`A${C.number}:${String.fromCharCode(64+e)}${C.number}`),C.getCell(1).alignment={horizontal:p?.halign||"left"},p?.txtColor&&(C.getCell(1).font={bold:!0,color:{argb:p?.txtColor||"000000"}}),p?.bgColor&&(C.getCell(1).fill={type:"pattern",pattern:"solid",fgColor:{argb:p?.bgColor}})}let i={};r.detail.forEach(async e=>{let p=A(s).map(l=>{if(l?.options?.format==="IMAGE"&&e[l.key])return{value:"",alignment:{horizontal:"center",vertical:"middle"},isImage:!0,imageSrc:e[l.key]};let R=l?.options?.format==="DATETIME"?z(e[l.key],!0):l?.options?.format==="DATE"?z(e[l.key]):e[l.key];l.formatter&&(R=l.formatter(R,e));let k={horizontal:l?.options?.halign?l?.options?.halign:l?.options?.format==="RP"||l?.options?.format==="GR"||l?.options?.format==="NUMBER"?"right":"left"},$=l.key,B=e[l.key];return U[$]=(U[$]||0)+Number(B),i[$]=(i[$]||0)+Number(B),{value:R,alignment:k,...l?.options?.bgColor&&{fgColor:{argb:l.options.bgColor}},...l?.options?.txtColor&&{color:{argb:l.options.txtColor}},numFmt:l?.options?.format==="RP"?"#,##0":l?.options?.format==="GR"?"#,##0.000":void 0}}),C=g.addRow(p.map(l=>l.value));p.forEach((l,R)=>{let k=C.getCell(R+1),$=["center","right","left","fill","justify","centerContinuous","distributed"],B=["top","middle","bottom","distributed","justify"],V,S;l.alignment&&typeof l.alignment.horizontal=="string"&&$.includes(l.alignment.horizontal)&&(V=l.alignment.horizontal),l.alignment&&"vertical"in l.alignment&&typeof l.alignment.vertical=="string"&&B.includes(l.alignment.vertical)&&(S=l.alignment.vertical),k.alignment={...V?{horizontal:V}:{},...S?{vertical:S}:{}},!l.isImage&&"numFmt"in l&&l.numFmt&&typeof l.value=="number"&&!isNaN(l.value)&&(k.value=Number(l.value),k.numFmt=l.numFmt)}),await Y(d,g,C,p)});let u=A(s);if(!m?.subTotal?.disableSubtotal){let e=g.addRow(s.map(()=>null));u.forEach((t,p)=>{if(t?.options?.format==="RP"||t?.options?.format==="GR"||t?.options?.format==="NUMBER"){let l=f.length+4-1,R=`SUM(${String.fromCharCode(65+p)}4:${String.fromCharCode(65+p)}${l})`,k=e.getCell(p+1),$=m?.subTotal?.enableCount&&c.length>0?" : "+r.detail.length:"",B=m?.subTotal?.captionItem?m?.subTotal?.captionItem:"";e.getCell(1).value=`${m?.subTotal?.caption||"SUB TOTAL"} ${$} ${B}`,e.getCell(1).alignment={horizontal:"center"},k.numFmt=t?.options?.format==="GR"?"#,##0.000":"#,##0",k.value={formula:R},e.getCell(p+1).value=t?.options.disabledFooter?"":i[t.key]}else e.getCell(p+1).value=""}),a?.grandTotalSetting?.colSpan&&g.mergeCells(`A${e.number}:${String.fromCharCode(64+Number(a?.grandTotalSetting?.colSpan))}${e.number}`),e.eachCell(t=>{t.fill={type:"pattern",pattern:"solid",fgColor:{argb:a?.bgColor||"#E8E5E5"},bgColor:{argb:a?.bgColor||"#E8E5E5"}},t.font={color:{argb:a?.txtColor},bold:!0}})}}else{let u=A(s).map(t=>{if(t?.options?.format==="IMAGE"&&r[t.key])return{value:"",alignment:{horizontal:"center",vertical:"middle"},isImage:!0,imageSrc:r[t.key]};let p=t?.options?.format==="DATETIME"?z(r[t.key]):t?.options?.format==="DATE"?z(r[t.key]):r[t.key];t.formatter&&(p=t.formatter(p,r));let C={horizontal:t?.options?.halign?t?.options?.halign:t?.options?.format==="RP"||t?.options?.format==="GR"||t?.options?.format==="NUMBER"?"right":"left"},l=t.key,R=r[t.key];return U[l]=(U[l]||0)+Number(R),{value:p,alignment:C,...t?.options?.bgColor&&{fgColor:{argb:t.options.bgColor}},...t?.options?.txtColor&&{color:{argb:t.options.txtColor}},numFmt:t?.options?.format==="RP"?"#,##0":t?.options?.format==="GR"?"#,##0.000":void 0}}),e=g.addRow(u.map(t=>t.value));u.forEach((t,p)=>{let C=e.getCell(p+1),l=["center","right","left","fill","justify","centerContinuous","distributed"],R=["top","middle","bottom","distributed","justify"],k,$;t.alignment&&typeof t.alignment.horizontal=="string"&&l.includes(t.alignment.horizontal)&&(k=t.alignment.horizontal),t.alignment&&"vertical"in t.alignment&&typeof t.alignment.vertical=="string"&&R.includes(t.alignment.vertical)&&($=t.alignment.vertical),C.alignment={...k?{horizontal:k}:{},...$?{vertical:$}:{}},!t.isImage&&"numFmt"in t&&t.numFmt&&typeof t.value=="number"&&!isNaN(t.value)&&(C.value=Number(t.value),C.numFmt=t.numFmt),!t.isImage&&"fgColor"in t&&t.fgColor&&(C.fill={type:"pattern",pattern:"solid",fgColor:t.fgColor}),!t.isImage&&"color"in t&&t.color&&(C.font={color:t.color})}),await Y(d,g,e,u)}});let D=g.addRow(s.map(()=>null)),O=A(s);m?.grandTotal?.disableGrandTotal||(O.forEach((r,i)=>{if(r?.options?.format==="RP"||r?.options?.format==="GR"||r?.options?.format==="NUMBER"){let e=f.length+4-1,t=`SUM(${String.fromCharCode(65+i)}4:${String.fromCharCode(65+i)}${e})`,p=D.getCell(i+1),C=m?.grandTotal?.enableCount?c.length>0?" : "+f.map(k=>k.detail.length).reduce((k,$)=>k+$,0):" : "+f.length:"",l=m?.grandTotal?.captionItem?m?.grandTotal?.captionItem:"",R=`${m?.grandTotal?.caption||"GRAND TOTAL"} ${C} ${l}`;D.getCell(1).value=R,D.getCell(1).alignment={horizontal:"center"},p.numFmt=r?.options?.format==="GR"?"#,##0.000":"#,##0",p.value={formula:t},D.getCell(i+1).value=r?.options.disabledFooter?"":U[r.key]}else D.getCell(i+1).value=""}),a?.grandTotalSetting?.colSpan&&g.mergeCells(`A${D.number}:${String.fromCharCode(64+Number(a?.grandTotalSetting?.colSpan))}${D.number}`),D.eachCell(r=>{r.fill={type:"pattern",pattern:"solid",fgColor:{argb:a?.bgColor||"#E8E5E5"},bgColor:{argb:a?.bgColor||"#E8E5E5"}},r.font={color:{argb:a?.txtColor},bold:!0}})),a?.customFooter&&a.customFooter(g,x);let n=await d.xlsx.writeBuffer();a?.returnBuffer&&a.returnBuffer(n);let y=new Blob([n],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),T=document.createElement("a");T.href=URL.createObjectURL(y),T.download=`${a?.titleExcel||b}.xlsx`,document.body.appendChild(T),T.click(),document.body.removeChild(T)},W=ot;import et from"jspdf";import J from"jspdf-autotable";var rt=({columns:s,data:f,grouping:c,pdfSetting:o,date:a,title:b,footerSetting:m,groupingSetting:w})=>{let d=new et(o?.orientation,o?.unit,[o?.width||297,o?.height||210]),g=[],x=a?30:20;s=s.filter(n=>!n.options?.disabledColumn),d.setFontSize(10);let F=d.internal.pageSize.getWidth(),P=d.splitTextToSize(o?.textHeaderLeft||"",110);d.text(P,15,18),d.text(`${b||o?.titlePdf}`,F-15,18,{align:"right"}),a&&d.text(`${a.caption?a.caption:"TANGGAL "} : ${a?.start_date} ${a?.end_date?`s/d ${a?.end_date}`:""}`,F-15,22,{align:"right"}),typeof o?.customHeader=="function"&&o.customHeader(d,x,J),d.setProperties({title:b||o?.titlePdf}),o?.startY&&(x=o.startY);let v=[],I=[],L=s.some(n=>n.child&&n.child.length>0);s.forEach(n=>{let y={textColor:`#${E(o?.txtColor||"000")}`,fillColor:`#${E(o?.bgColor||"E8E5E5")}`,...n?.options?.width&&{cellWidth:n?.options?.width},fontStyle:"bold",...n?.options?.valign?{valign:n.options.valign}:{},halign:n?.options?.halign??(["RP","GR","NUMBER"].includes(n?.options?.format||"")?"right":"left")};L?n.child&&n.child.length>0?(v.push({content:n.label,colSpan:n.child.length,styles:y}),n.child.forEach(T=>{I.push({content:T.label,key:T.key,options:T.options,styles:{...y,halign:T?.options?.halign??(["RP","GR","NUMBER"].includes(T?.options?.format||"")?"right":"left")}})})):v.push({content:n.label,rowSpan:2,key:n.key,options:n.options,styles:y}):v.push({content:n.label,key:n.key,options:n.options,styles:y})}),o?.header?.column||(g.push(v),L&&I.length>0&&g.push(I));let h={};f.forEach(n=>{if(n.detail?.length>0){if(c.length>0){let r=M(s),i=c.map(t=>n[t]!==void 0||n[t]!==null?`${H(t)} : ${n[t]}`:"").filter(Boolean).join("  |  "),u=typeof w=="function"?w(n):w||{},e=[{content:i,colSpan:r,styles:{fontStyle:"bold",halign:u?.halign||"left",textColor:`#${E(u?.txtColor||"000")}`,fillColor:`#${E(u?.bgColor||"FFF")}`}}];g.push(e)}let y={},T=A(s);if(n.detail.forEach(r=>{let i=T.map(u=>{let e=r[u.key],t=u.key;u.formatter&&(e=u.formatter(e,r));let p=r[u.key];h[t]=(h[t]||0)+Number(p||0),y[t]=(y[t]||0)+Number(p||0);let C=u.options?.format==="IMAGE";return{content:(()=>{switch(u?.options?.format){case"RP":return e!==void 0?Number(e||0).toLocaleString("kr-ko"):"";case"GR":return e!==void 0?Number(e||0).toFixed(3):"";case"NUMBER":return e!==void 0?Number(e||0):"";case"IMAGE":return"";case"DATETIME":return e!==void 0?z(e||new Date,!0):"";case"DATE":return e!==void 0?z(e||new Date):"";default:return e!==void 0?e.toString():""}})(),foto:C?e:null,styles:{textColor:u?.options?.txtColor?`#${E(u?.options?.txtColor)}`:"#000",fillColor:u?.options?.bgColor?`#${E(u?.options?.bgColor)}`:void 0,halign:u?.options?.halign?u?.options?.halign:u?.options?.format==="RP"||u?.options?.format==="GR"||u?.options?.format==="NUMBER"||typeof e=="number"?"right":"left"}}});g.push(i)}),!m?.subTotal?.disableSubtotal){let r=[];T.forEach(t=>{let p=y[t.key];t?.options?.format==="RP"||t?.options?.format==="GR"||t?.options?.format==="NUMBER"?r.push({content:t?.options?.disabledFooter?"":(()=>{switch(t?.options?.format){case"RP":return p.toLocaleString("kr-ko");case"GR":return p.toFixed(3);case"NUMBER":return p;default:return p.toString()}})(),styles:{halign:t?.options?.halign||"right",textColor:`#${E(o?.txtColor||"000")}`,fillColor:`#${E(o?.bgColor||"E8E5E5")}`,fontStyle:"bold"}}):r.push({content:"",styles:{textColor:`#${E(o?.txtColor||"000")}`,fillColor:`#${E(o?.bgColor||"E8E5E5")}`,fontStyle:"bold"}})});let i=o?.grandTotalSetting?.colSpan?Number(o?.grandTotalSetting?.colSpan||0)+1:0,u=m?.subTotal?.enableCount&&c.length>0?" : "+n.detail.length:"",e=m?.subTotal?.captionItem?m?.subTotal?.captionItem:"";r[0]={content:`${m?.subTotal?.caption||"SUB TOTAL"}${u} ${e}`,colSpan:i,styles:{textColor:`#${E(o?.txtColor||"000")}`,fillColor:`#${E(o?.bgColor||"E8E5E5")}`,fontStyle:"bold",halign:"center"}},o?.grandTotalSetting?.colSpan&&r.splice(1,o?.grandTotalSetting?.colSpan),g.push(r)}}else{let y=(i,u)=>{let e=u[i.key],t=i.key;if(i.formatter&&(e=i.formatter(e,u)),!i.options?.disabledFooter){let R=u[i.key];h[t]=(h[t]||0)+Number(R||0)}let p=(()=>{switch(i?.options?.format){case"RP":return e!==void 0?Number(e||0).toLocaleString("kr-ko"):"";case"GR":return e!==void 0?Number(e||0).toFixed(3):"";case"NUMBER":return e!==void 0?Number(e||0):"";case"IMAGE":return"";case"DATETIME":return e!==void 0?z(e||new Date,!0):"";case"DATE":return e!==void 0?z(e||new Date):"";default:return e!==void 0?e?.toString():""}})(),C=i?.options?.halign?i?.options?.halign:i?.options?.format==="RP"||i?.options?.format==="GR"||i?.options?.format==="NUMBER"||typeof e=="number"?"right":"left",l=i.options?.format==="IMAGE";return{options:i?.options,content:p,foto:l?e:null,styles:{halign:C,textColor:i?.options?.txtColor?`#${E(i?.options?.txtColor)}`:"#000",fillColor:i?.options?.bgColor?`#${E(i?.options?.bgColor)}`:void 0}}},r=A(s).map(i=>y(i,n));g.push(r)}});let G=A(s);if(!m?.grandTotal?.disableGrandTotal){let n=[];G.forEach(e=>{let t=h[e.key],p=["RP","GR","NUMBER"].includes(e?.options?.format||""),C=e?.options?.disabledFooter?"":(()=>{if(!p)return"";switch(e.options?.format){case"RP":return Number(t||0).toLocaleString("kr-KO");case"GR":return Number(t||0).toFixed(3);case"NUMBER":return Number(t||0);default:return(t||0).toString()}})();n.push({options:e?.options,content:C,styles:{halign:e?.options?.halign?e.options.halign:p?"right":"left",textColor:`#${E(o?.txtColor||"000")}`,fillColor:`#${E(o?.bgColor||"E8E5E5")}`,fontStyle:"bold"}})});let y=Number(o?.grandTotalSetting?.colSpan||0),T=Math.min(y+1,G.length),r=m?.grandTotal?.enableCount?c.length>0?f.reduce((e,t)=>e+t.detail.length,0):f.length:0,i=m?.grandTotal?.captionItem||"",u=`${m?.grandTotal?.caption||"GRAND TOTAL"}`+(r?` : ${r}`:"")+(i?` ${i}`:"");for(n[0]={content:u,colSpan:T,styles:{textColor:`#${E(o?.txtColor||"000")}`,fillColor:`#${E(o?.bgColor||"E8E5E5")}`,fontStyle:"bold",halign:"center"}},n.splice(1,T-1);n.length<G.length;)n.push({content:"",styles:{textColor:`#${E(o?.txtColor||"000")}`,fillColor:`#${E(o?.bgColor||"E8E5E5")}`,fontStyle:"bold"}});g.push(n)}if(typeof o?.addRow=="function"&&o?.addRow(g),!o?.disablePrintDate){let n=M(s);g.push([{content:`Print Date : ${z(`${new Date}`)}`,colSpan:n,styles:{textColor:`#${E(o?.txtColor||"000")}`,fillColor:`#${E(o?.bgColor||"E8E5E5")}`,fontStyle:"italic"}}])}let N=[];o?.header?.column&&(N.push(v),L&&I.length>0&&N.push(I)),J(d,{head:N,body:g,startY:x,theme:o?.theme||"plain",rowPageBreak:"avoid",margin:{top:o?.header?.information?30:10},bodyStyles:{fontSize:o?.fontSIze||8},headStyles:{fontSize:o?.fontSIze||8,textColor:`#${E(o?.txtColor||"000")}`,fillColor:`#${E(o?.bgColor||"E8E5E5")}`},tableLineColor:[255,255,255],didParseCell:function(n){let y=n.column.index;G[y]?.options?.format==="IMAGE"&&n.cell.raw&&n.cell.raw.foto&&(n.row.height=20,n.cell.styles.valign="middle",n.cell.styles.halign="center")},didDrawPage:function(n){if(o?.header?.information&&n.pageNumber>1){d.setFontSize(10);let y=d.internal.pageSize.getWidth(),T=d.splitTextToSize(o?.textHeaderLeft||"",110);d.text(T,15,18),d.text(`${b||o?.titlePdf}`,y-15,18,{align:"right"}),a&&d.text(`${a.caption?a.caption:"TANGGAL "} : ${a?.start_date} ${a?.end_date?`s/d ${a?.end_date}`:""}`,y-15,22,{align:"right"})}},didDrawCell:function(n){let{cell:y}=n,r=(y.raw||{}).foto,i=n.column.index;if(G[i]?.options?.format==="IMAGE"&&r){let t=y.x+(y.width-15)/2,p=y.y+(y.height-15)/2;try{d.addImage(r,"JPG",t,p,15,15)}catch(C){console.warn("\u274C Gagal render gambar:",C)}}}}),g=[],x=d.lastAutoTable.finalY;let U=d.internal.getNumberOfPages(),D=d.internal.pageSize.width,O=d.internal.pageSize.height;d.setFontSize(10);for(let n=1;n<U+1;n++){let y=D/2,T=O-10;d.setPage(n),d.text(`${n} of ${U}`,y,T,{align:"center"})}if(typeof o?.customFooter=="function"&&o.customFooter(d,x,J),o?.returnDataUri){let n=d.output("datauristring");o.returnDataUri(n)}if(o?.openNewTab){let n=d.output("bloburl");window.open(n)}else d.save(`${o?.titlePdf||b}.pdf`)},X=rt;var at=s=>{let f=[],c=s.copy?2:1;for(let o=0;o<c;o++){let a=s.data.map(b=>{let m=s.template;for(;/\n!!LOOP\((.+)\)(\{\n(.*\n)+\})\n/gm.exec(m);)m=m.replace(/\n!!LOOP\((.+)\)(\{\n(.*\n)+\})\n/,(w,d,g)=>{let x=g.replace(/^\{/,"").replace(/\}$/,"");return(Array.isArray(b[d])?b[d]:[b[d]]).reduce((v,I)=>v+x.replace(/\{([a-z0-9_]+)\}/gm,L=>{let h=L.replace(/(\{|\})/g,"");if(h.match(/nama_barang/)){let G=h.match(/nama_barang/),N=h==="nama_barang2"?[20,40]:h==="nama_barang3"?[40,60]:[0,20];return I[G]?.slice(...N).trim()||""}if(h.match(/deskripsi_jual/)){let G=h.match(/deskripsi_jual/),N=h==="deskripsi_jual2"?[20,40]:h==="deskripsi_jual3"?[40,60]:[0,20];return I[G]?.slice(...N).trim()||""}if(h.match(/deskripsi/)){let G=h.match(/deskripsi/),N=h==="deskripsi2"?[20,40]:h==="deskripsi3"?[40,60]:[0,20];return I[G]?.slice(...N).trim()||""}return I[h]||""}),"").replace(/\n(\s)+\n/gm,`
`)});return m.replace(/\{([a-z0-9_]+)\}/gm,w=>{let d=w.replace(/(\{|\})/g,"");return d.match(/auto_cut/)?`
VA`:b[d]||""}).replace(/\n(\s)+\n/gm,`
`).replace(/~new_line~/gm,`
`).replace(/!!LOOP\(detail\)/g,"").replace(/[}{]/g,"")});for(let b in a)a[b]+=`

`;f.push(...a)}return f},nt=async(s,f)=>{let c=at(s),o=new Blob([c?.join(`
`)||""],{type:"text/plain"}),a=document.createElement("a");a.href=URL.createObjectURL(o),a.download=f,document.body.appendChild(a),a.click(),document.body.removeChild(a)},K=nt;var vt=({columns:s,data:f,grouping:c,date:o,type:a,txtSetting:b,pdfSetting:m,excelSetting:w,title:d,footerSetting:g,groupingSetting:x})=>{let F={data:[b?.dataTxt],template:b?.templateTxt,copy:b?.copy};if(f.length===0)throw new Error("Data is required");if(a.length===0)throw new Error("Type is required");if(!Q(a))throw new Error('Type Export must use ["EXCEL", "PDF", "TXT", "ALL"]');a.forEach(P=>{P==="PDF"?X({pdfSetting:m,date:o,data:f,type:a,columns:s,grouping:c,title:d,footerSetting:g,groupingSetting:x}):P==="TXT"?K(F,b?.titleTxt||""):P==="EXCEL"?W({date:o,data:f,type:a,columns:s,grouping:c,excelSetting:w,title:d,footerSetting:g,groupingSetting:x}):(W({date:o,data:f,type:a,columns:s,grouping:c,excelSetting:w,title:d,groupingSetting:x}),X({pdfSetting:m,date:o,data:f,type:a,columns:s,grouping:c,title:d,groupingSetting:x}),K(F,b?.titleTxt||""))})};export{vt as ExportData};
//# sourceMappingURL=index.mjs.map