{"version":3,"sources":["../src/interface.ts","../src/helpers.ts","../src/exportExcel.ts","../src/exportPdf.ts","../src/exportTextFile.tsx","../src/index.ts"],"sourcesContent":["import jsPDF from \"jspdf\";\nimport ExcelJS from \"exceljs\";\n\ntype FormatType = \"RP\" | \"GR\" | \"DATETIME\" | \"DATE\" | \"NUMBER\" | \"IMAGE\" | \"\";\ntype HalignType = \"center\" | \"right\" | \"left\" | \"\";\ntype ValignType = \"top\" | \"middle\" | \"bottom\" | undefined;\n\nexport interface ColumnGenarator<T> {\n  key: keyof T;\n  label?: string;\n  options?: {\n    format?: FormatType;\n    halign?: HalignType;\n    valign?: ValignType;\n    txtColor?: string;\n    bgColor?: string;\n    width?: number;\n    disabledColumn?: boolean;\n    disabledFooter?: boolean;\n  };\n  child?: ColumnGenarator<T>[];\n  formatter?: (cellValue: any, rowData: any) => any;\n}\n\nexport interface DataItemGenerator {\n  [key: string]: any;\n}\n\nexport type FileType = \"EXCEL\" | \"PDF\" | \"TXT\" | \"ALL\";\ntype GroupingStyle = {\n  txtColor?: string;\n  bgColor?: string;\n  halign?: \"left\" | \"right\" | \"center\";\n};\nexport const validFileTypes: FileType[] = [\"EXCEL\", \"PDF\", \"TXT\", \"ALL\"];\ntype CustomizePdfFunction = (\n  doc: jsPDF,\n  finalY: number,\n  autoTable?: any\n) => void;\ntype addRowPdfPdfFunction = (tableRows?: any) => void;\ntype CustomizeFunctionExcel = (\n  worksheet: ExcelJS.Worksheet,\n  lastIndex: number\n) => void;\ntype GroupingSettingType =\n  | GroupingStyle\n  | ((item: DataItemGenerator) => GroupingStyle);\nexport interface GenaratorExport<T> {\n  columns: ColumnGenarator<T>[];\n  data: DataItemGenerator[];\n  type: FileType[];\n  title?: string;\n  groupingSetting?: GroupingSettingType;\n  pdfSetting?: {\n    orientation?: \"p\" | \"portrait\" | \"l\" | \"landscape\";\n    unit?: \"pt\" | \"px\" | \"in\" | \"mm\" | \"cm\" | \"ex\" | \"em\" | \"pc\";\n    width?: number;\n    height?: number;\n    fontSIze?: number;\n    bgColor?: string;\n    titlePdf?: string;\n    txtColor?: string;\n    startY?: number;\n    header?: {\n      column?: boolean;\n      information?: boolean;\n    };\n    textHeaderRight?: string;\n    textHeaderLeft?: string;\n    theme?: \"grid\" | \"striped\" | \"plain\";\n    grandTotalSetting?: {\n      disableGrandTotal?: boolean;\n      colSpan?: number;\n    };\n    openNewTab?: boolean;\n    disablePrintDate?: boolean;\n    returnDataUri?(dataUri: string): void;\n    addRow?: addRowPdfPdfFunction;\n    // customize?: CustomizePdfFunction;\n    customHeader?: CustomizePdfFunction;\n    customFooter?: CustomizePdfFunction;\n  };\n  date?: {\n    start_date?: string;\n    end_date?: string;\n    caption?: string;\n  };\n  txtSetting?: {\n    dataTxt?: DataItemGenerator | DataItemGenerator[];\n    titleTxt: string;\n    templateTxt?: string;\n    copy?: boolean;\n  };\n  excelSetting?: {\n    titleExcel?: string;\n    bgColor?: string;\n    startY?: number;\n    txtColor?: string;\n    additionalTextHeader?: string;\n    grandTotalSetting?: {\n      disableGrandTotal?: boolean;\n      colSpan?: number;\n    };\n    subTotal?: {\n      disableGrandTotal?: boolean;\n    };\n    returnBuffer?(buffer: ArrayBuffer): void;\n    customHeader?: CustomizeFunctionExcel;\n    customFooter?: CustomizeFunctionExcel;\n  };\n  grouping: string[];\n  footerSetting?: {\n    subTotal?: {\n      caption?: string;\n      disableSubtotal?: boolean;\n      enableCount?: boolean;\n      captionItem?: string;\n    };\n    grandTotal?: {\n      caption?: string;\n      disableGrandTotal?: boolean;\n      captionItem?: string;\n      enableCount?: boolean;\n    };\n  };\n}\n","import ExcelJS from \"exceljs\";\nimport { ColumnGenarator, FileType, validFileTypes } from \"./interface\";\n\nexport function convertDateTime(tgl: string, isDateTime: boolean = false) {\n  const date = new Date(tgl);\n\n  // Tambahkan offset 7 jam (WIB)\n  const jakartaDate = new Date(date.getTime() + 7 * 60 * 60 * 1000);\n\n  const year = jakartaDate.getUTCFullYear();\n  const month = String(jakartaDate.getUTCMonth() + 1).padStart(2, \"0\");\n  const day = String(jakartaDate.getUTCDate()).padStart(2, \"0\");\n  const hours = String(jakartaDate.getUTCHours()).padStart(2, \"0\");\n  const minutes = String(jakartaDate.getUTCMinutes()).padStart(2, \"0\");\n  const seconds = String(jakartaDate.getUTCSeconds()).padStart(2, \"0\");\n\n  return isDateTime\n    ? `${day}-${month}-${year} ${hours}:${minutes}:${seconds}`\n    : `${day}-${month}-${year}`;\n}\n\nexport function validateFileTypes(fileTypes: FileType[]): boolean {\n  return fileTypes.every((fileType) => validFileTypes.includes(fileType));\n}\n\nexport function countColumns(columns: ColumnGenarator<any>[]): number {\n  let count = 0;\n  columns.forEach((col) => {\n    if (col.child && col.child.length > 0) {\n      count += countColumns(col.child);\n    } else {\n      count += 1;\n    }\n  });\n  return count;\n}\n\nexport const getFlattenColumns = (\n  columns: ColumnGenarator<any>[]\n): ColumnGenarator<any>[] => {\n  const flat: ColumnGenarator<any>[] = [];\n\n  columns.forEach((col) => {\n    if (col.child && col.child.length > 0) {\n      flat.push(...getFlattenColumns(col.child)); // panggil rekursif\n    } else {\n      flat.push(col);\n    }\n  });\n\n  return flat;\n};\n\nexport const formatingTitle = (title: string): string => {\n  // Pisahkan kata-kata menggunakan underscore sebagai pemisah\n  const words = title.split(\"_\");\n\n  // Ubah setiap kata menjadi huruf kapital dan gabungkan kembali dengan spasi di antara mereka\n  const formattedtitle = words\n    .map((word) => word.charAt(0).toUpperCase() + word.slice(1))\n    .join(\" \");\n\n  return formattedtitle;\n};\n\n/**\n * Menambahkan gambar ke baris Excel menggunakan ExcelJS di browser, dari base64 string\n */\nexport async function addImagesToRow(\n  workbook: ExcelJS.Workbook,\n  worksheet: ExcelJS.Worksheet,\n  row: ExcelJS.Row,\n  rowData: any[]\n) {\n  for (let index = 0; index < rowData.length; index++) {\n    const cellData = rowData[index];\n\n    // Proses jika imageSrc adalah base64 string\n    if (\n      cellData?.isImage &&\n      cellData?.imageSrc &&\n      typeof cellData.imageSrc === \"string\" &&\n      cellData.imageSrc.startsWith(\"data:image\")\n    ) {\n      try {\n        const { buffer, extension } = base64ToBufferAndExtension(\n          cellData.imageSrc\n        );\n\n        const imageId = workbook.addImage({\n          buffer: buffer as any,\n          extension,\n        });\n\n        worksheet.addImage(imageId, {\n          tl: { col: index, row: row.number - 1 },\n          ext: { width: 70, height: 60 },\n          editAs: \"oneCell\",\n        });\n\n        if (!row.height || row.height < 60) {\n          row.height = 35;\n        }\n      } catch (error) {\n        console.error(\"âŒ Error adding image to row:\", error);\n        row.getCell(index + 1).value = \"[Image]\";\n      }\n    }\n  }\n}\n\n/**\n * Mengubah base64 image string ke buffer dan extension\n */\nfunction base64ToBufferAndExtension(base64: string): {\n  buffer: Uint8Array;\n  extension: any;\n} {\n  const match = base64.match(/^data:image\\/(\\w+);base64,(.*)$/);\n  if (!match) throw new Error(\"Invalid base64 image format\");\n  const extension = match[1] === \"jpg\" ? \"jpeg\" : (match[1] as any);\n  const base64Data = match[2];\n  const binaryString = atob(base64Data);\n  const len = binaryString.length;\n  const bytes = new Uint8Array(len);\n  for (let i = 0; i < len; i++) {\n    bytes[i] = binaryString.charCodeAt(i);\n  }\n  return { buffer: bytes, extension };\n}\n\nexport const convertArgbToRgb = (color: string): string => {\n  if (!color) return color;\n\n  // Remove # if present\n  const cleanColor = color.replace(/^#/, \"\");\n\n  // If 8 characters (ARGB), strip first 2 characters (alpha channel)\n  if (cleanColor.length === 8) {\n    return cleanColor.substring(2);\n  }\n\n  // If already 6 characters (RGB) or 3 characters (short RGB), return as is\n  return cleanColor;\n};\n","import {\n  addImagesToRow,\n  convertDateTime,\n  countColumns,\n  formatingTitle,\n  getFlattenColumns,\n} from \"./helpers\";\nimport { DataItemGenerator, GenaratorExport } from \"./interface\";\nimport ExcelJS from \"exceljs\";\nconst ExportExcel = async <T>({\n  columns,\n  data,\n  grouping,\n  date,\n  excelSetting,\n  title,\n  footerSetting,\n  groupingSetting,\n}: GenaratorExport<T>): Promise<void> => {\n  const workbook = new ExcelJS.Workbook();\n  columns = columns.filter((item) => !item.options?.disabledColumn);\n  const worksheet = workbook.addWorksheet(title || excelSetting?.titleExcel);\n\n  const lastUsedColumnIndex = countColumns(columns);\n\n  const judul = worksheet.addRow([]);\n  judul.getCell(1).value = title || excelSetting?.titleExcel;\n  judul.getCell(1).alignment = { horizontal: \"center\" };\n\n  const lastColumnLetter = worksheet.getColumn(lastUsedColumnIndex).letter;\n\n  worksheet.mergeCells(`A${judul.number}:${lastColumnLetter}${judul.number}`);\n\n  judul.eachCell((cell) => {\n    cell.font = {\n      color: { argb: \"000000\" },\n      bold: true,\n      size: 12,\n    };\n  });\n\n  // Tanggal\n  if (date) {\n    const tanggalRow = worksheet.addRow([]);\n    tanggalRow.getCell(1).value = `${\n      date.caption ? date.caption : \"Tanggal \"\n    } : ${date?.start_date} ${date?.end_date ? `s/d ${date?.end_date}` : \"\"}`;\n    tanggalRow.getCell(1).alignment = { horizontal: \"center\" };\n    worksheet.mergeCells(\n      `A${tanggalRow.number}:${lastColumnLetter}${tanggalRow.number}`\n    );\n\n    tanggalRow.eachCell((cell) => {\n      cell.font = {\n        color: { argb: \"00000\" },\n        bold: true,\n        size: 12,\n      };\n    });\n  }\n\n  // additional\n  const additionalText = worksheet.addRow([]);\n  additionalText.getCell(1).value = excelSetting?.additionalTextHeader || \"\";\n  additionalText.getCell(1).alignment = { horizontal: \"center\" };\n  worksheet.mergeCells(\n    `A${additionalText.number}:${lastColumnLetter}${additionalText.number}`\n  );\n\n  additionalText.eachCell((cell) => {\n    cell.font = { color: { argb: \"000000\" }, bold: true, size: 12 };\n  });\n\n  if (excelSetting?.customHeader) {\n    excelSetting.customHeader(worksheet, lastUsedColumnIndex);\n  }\n\n  const startY =\n    excelSetting?.startY && excelSetting.startY > 0 ? excelSetting.startY : 1;\n\n  if (startY > 1) {\n    for (let i = 1; i < startY; i++) {\n      worksheet.addRow([]);\n    }\n  }\n\n  const hasChild = columns.some((col) => col.child && col.child.length > 0);\n  const headerColumn1 = worksheet.addRow([]);\n  const headerColumn2 = hasChild ? worksheet.addRow([]) : null;\n\n  columns.forEach((col) => {\n    if (col.child && col.child.length > 0) {\n      // Parent dengan child: di headerColumn1 ditulis parent-nya dan di headerColumn2 tulis child-nya\n      // Merge parent cell di headerColumn1 sesuai jumlah child\n      const startCol = headerColumn1.actualCellCount + 1;\n\n      const childCount = col.child.length;\n\n      // Isi parent di headerColumn1, merge sesuai childCount\n      headerColumn1.getCell(startCol).value = col.label;\n      if (childCount > 1) {\n        worksheet.mergeCells(\n          headerColumn1.number,\n          startCol,\n          headerColumn1.number,\n          startCol + childCount - 1\n        );\n      }\n\n      // Styling dan alignment parent headerColumn1\n      for (let i = startCol; i < startCol + childCount; i++) {\n        const cell = headerColumn1.getCell(i);\n        cell.fill = {\n          type: \"pattern\",\n          pattern: \"solid\",\n          fgColor: { argb: excelSetting?.bgColor || \"E8E5E5\" },\n        };\n        cell.font = {\n          color: { argb: excelSetting?.txtColor || \"000000\" },\n          bold: true,\n        };\n        cell.alignment = { horizontal: \"center\", vertical: \"middle\" };\n      }\n\n      // Isi child di headerColumn2\n      col.child.forEach((childCol, index) => {\n        if (headerColumn2) {\n          const cell = headerColumn2.getCell(startCol + index);\n          cell.value = childCol.label;\n          cell.fill = {\n            type: \"pattern\",\n            pattern: \"solid\",\n            fgColor: { argb: excelSetting?.bgColor || \"E8E5E5\" },\n          };\n          cell.font = {\n            color: { argb: excelSetting?.txtColor || \"000000\" },\n            bold: true,\n          };\n\n          const halign =\n            childCol.options?.halign ||\n            ([\"RP\", \"GR\", \"NUMBER\"].includes(childCol?.options?.format || \"\")\n              ? \"right\"\n              : \"left\");\n          const valign = childCol.options?.valign || \"middle\";\n          cell.alignment = { horizontal: halign, vertical: valign };\n        }\n      });\n    } else {\n      // Parent tanpa child: tulis di headerColumn1 dan merge di headerColumn2 agar melebar ke bawah\n      const colIndex = headerColumn1.actualCellCount + 1;\n\n      // Isi headerColumn1\n      headerColumn1.getCell(colIndex).value = col.label;\n      headerColumn1.getCell(colIndex).fill = {\n        type: \"pattern\",\n        pattern: \"solid\",\n        fgColor: { argb: excelSetting?.bgColor || \"E8E5E5\" },\n      };\n      headerColumn1.getCell(colIndex).font = {\n        color: { argb: excelSetting?.txtColor || \"000000\" },\n        bold: true,\n      };\n      headerColumn1.getCell(colIndex).alignment = {\n        horizontal: col.options?.halign || \"center\",\n        vertical: col.options?.valign || \"middle\",\n      };\n      if (hasChild && headerColumn2) {\n        worksheet.mergeCells(\n          headerColumn1.number,\n          colIndex,\n          headerColumn2.number,\n          colIndex\n        );\n      }\n    }\n  });\n\n  // Set column widths based on col.options?.width\n  // This implementation supports both parent and child columns\n  // Usage example:\n  // {\n  //   label: \"Column Name\",\n  //   key: \"column_key\",\n  //   options: {\n  //     width: 25, // Set column width in Excel units (approximate character count)\n  //     halign: \"center\"\n  //   }\n  // }\n  const flatColumns = getFlattenColumns(columns);\n  flatColumns.forEach((col, index) => {\n    const columnIndex = index + 1; // ExcelJS uses 1-based indexing\n    const column = worksheet.getColumn(columnIndex);\n\n    if (col.options?.width) {\n      // Use specified width from column options\n      column.width = col.options.width;\n    } else {\n      // Set default width based on column type for better readability\n      const defaultWidth = col.options?.format === \"IMAGE\" ? 15 : 20;\n      column.width = defaultWidth;\n    }\n  });\n\n  const totals: { [key: string]: number } = {};\n\n  data.forEach(async (item) => {\n    if (item.detail?.length > 0) {\n      if (grouping.length > 0) {\n        const totalColumns = countColumns(columns); // sudah kamu punya\n        const groupContent = grouping\n          .map((column) =>\n            item[column] !== undefined || item[column] !== null\n              ? `${formatingTitle(column)} : ${item[column]}`\n              : \"\"\n          )\n          .filter(Boolean)\n          .join(\"  |  \");\n\n        // Support groupingSetting sebagai function atau object\n        const groupingStyle =\n          typeof groupingSetting === \"function\"\n            ? groupingSetting(item)\n            : groupingSetting || {};\n\n        const groupRow = worksheet.addRow([groupContent]); // hanya isi satu sel (di kolom A)\n        worksheet.mergeCells(\n          `A${groupRow.number}:${String.fromCharCode(64 + totalColumns)}${\n            groupRow.number\n          }`\n        );\n        // Styling\n        groupRow.getCell(1).alignment = {\n          horizontal: groupingStyle?.halign || \"left\",\n        };\n\n        if (groupingStyle?.txtColor) {\n          groupRow.getCell(1).font = {\n            bold: true,\n            color: {\n              argb: groupingStyle?.txtColor || \"000000\",\n            },\n          };\n        }\n\n        if (groupingStyle?.bgColor) {\n          groupRow.getCell(1).fill = {\n            type: \"pattern\",\n            pattern: \"solid\",\n            fgColor: {\n              argb: groupingStyle?.bgColor,\n            },\n          };\n        }\n      }\n\n      const subtotal: { [key: string]: number } = {};\n\n      item.detail.forEach(async (itemDetail: any) => {\n        const flatColumns = getFlattenColumns(columns);\n\n        const rowData = flatColumns.map((column) => {\n          if (\n            column?.options?.format === \"IMAGE\" &&\n            itemDetail[column.key as keyof DataItemGenerator]\n          ) {\n            return {\n              value: \"\", // Kosongkan value untuk cell gambar\n              alignment: { horizontal: \"center\", vertical: \"middle\" },\n              isImage: true,\n              imageSrc: itemDetail[column.key as keyof DataItemGenerator], // base64 sudah didukung oleh fetchImageAsBuffer\n            };\n          }\n\n          let value =\n            column?.options?.format === \"DATETIME\"\n              ? convertDateTime(\n                  itemDetail[column.key as keyof DataItemGenerator],\n                  true\n                )\n              : column?.options?.format === \"DATE\"\n              ? convertDateTime(\n                  itemDetail[column.key as keyof DataItemGenerator]\n                )\n              : itemDetail[column.key as keyof DataItemGenerator];\n\n          // Apply formatter if exists\n          if (column.formatter) {\n            value = column.formatter(value, itemDetail);\n          }\n\n          const alignment = {\n            horizontal: column?.options?.halign\n              ? column?.options?.halign\n              : column?.options?.format === \"RP\" ||\n                column?.options?.format === \"GR\" ||\n                column?.options?.format === \"NUMBER\"\n              ? \"right\"\n              : \"left\",\n          };\n          const columnKey = column.key as keyof DataItemGenerator;\n\n          // Hitung totals dan subtotals menggunakan nilai original (sebelum formatter)\n          const originalValue =\n            itemDetail[column.key as keyof DataItemGenerator];\n          totals[columnKey] = (totals[columnKey] || 0) + Number(originalValue);\n          subtotal[columnKey] =\n            (subtotal[columnKey] || 0) + Number(originalValue);\n\n          return {\n            value,\n            alignment,\n            ...(column?.options?.bgColor && {\n              fgColor: { argb: column.options.bgColor },\n            }),\n            ...(column?.options?.txtColor && {\n              color: { argb: column.options.txtColor },\n            }),\n            numFmt:\n              column?.options?.format === \"RP\"\n                ? \"#,##0\"\n                : column?.options?.format === \"GR\"\n                ? \"#,##0.000\"\n                : undefined,\n          };\n        });\n\n        const row = worksheet.addRow(rowData.map((cellData) => cellData.value));\n\n        rowData.forEach((cellData, index) => {\n          const cell = row.getCell(index + 1);\n          // Only assign allowed values for horizontal and vertical alignment\n          const allowedHorizontal: Array<\n            | \"center\"\n            | \"right\"\n            | \"left\"\n            | \"fill\"\n            | \"justify\"\n            | \"centerContinuous\"\n            | \"distributed\"\n          > = [\n            \"center\",\n            \"right\",\n            \"left\",\n            \"fill\",\n            \"justify\",\n            \"centerContinuous\",\n            \"distributed\",\n          ];\n          const allowedVertical: Array<\n            \"top\" | \"middle\" | \"bottom\" | \"distributed\" | \"justify\"\n          > = [\"top\", \"middle\", \"bottom\", \"distributed\", \"justify\"];\n\n          let horizontal: (typeof allowedHorizontal)[number] | undefined =\n            undefined;\n          let vertical: (typeof allowedVertical)[number] | undefined =\n            undefined;\n\n          if (\n            cellData.alignment &&\n            typeof cellData.alignment.horizontal === \"string\" &&\n            allowedHorizontal.includes(cellData.alignment.horizontal as any)\n          ) {\n            horizontal = cellData.alignment\n              .horizontal as (typeof allowedHorizontal)[number];\n          }\n          if (\n            cellData.alignment &&\n            \"vertical\" in cellData.alignment &&\n            typeof (cellData.alignment as any).vertical === \"string\" &&\n            allowedVertical.includes((cellData.alignment as any).vertical)\n          ) {\n            vertical = (cellData.alignment as any)\n              .vertical as (typeof allowedVertical)[number];\n          }\n\n          cell.alignment = {\n            ...(horizontal ? { horizontal } : {}),\n            ...(vertical ? { vertical } : {}),\n          };\n\n          // Set numFmt only for number cells\n          if (\n            !cellData.isImage &&\n            \"numFmt\" in cellData &&\n            cellData.numFmt &&\n            typeof cellData.value === \"number\" &&\n            !isNaN(cellData.value)\n          ) {\n            // Ensure the cell value is a number before setting numFmt\n            cell.value = Number(cellData.value);\n            cell.numFmt = cellData.numFmt;\n          }\n        });\n\n        // Add images after all cell formatting is complete\n        await addImagesToRow(workbook, worksheet, row, rowData);\n      });\n      const flatColumnsSubTott = getFlattenColumns(columns);\n\n      if (!footerSetting?.subTotal?.disableSubtotal) {\n        const subtotalRow = worksheet.addRow(columns.map(() => null)); // Create a row with null values\n\n        flatColumnsSubTott.forEach((column, columnIndex) => {\n          if (\n            column?.options?.format === \"RP\" ||\n            column?.options?.format === \"GR\" ||\n            column?.options?.format === \"NUMBER\"\n          ) {\n            const startRow = 4; // Adjust this based on the starting row for your data\n            const endRow = data.length + startRow - 1;\n            const totalFormula = `SUM(${String.fromCharCode(\n              65 + columnIndex\n            )}${startRow}:${String.fromCharCode(65 + columnIndex)}${endRow})`;\n            const grandTotalCell = subtotalRow.getCell(columnIndex + 1);\n            const subtotalCount = footerSetting?.subTotal?.enableCount\n              ? grouping.length > 0\n                ? \" : \" + item.detail.length\n                : \"\"\n              : \"\";\n\n            const captionSub = footerSetting?.subTotal?.captionItem\n              ? footerSetting?.subTotal?.captionItem\n              : \"\";\n            (subtotalRow.getCell(1).value = `${\n              footerSetting?.subTotal?.caption || \"SUB TOTAL\"\n            } ${subtotalCount} ${captionSub}`),\n              (subtotalRow.getCell(1).alignment = { horizontal: \"center\" });\n\n            // Explicitly cast the cell to CellValue to set numFmt\n            (grandTotalCell as any).numFmt =\n              column?.options?.format === \"GR\" ? \"#,##0.000\" : \"#,##0\";\n            grandTotalCell.value = { formula: totalFormula };\n            subtotalRow.getCell(columnIndex + 1).value = column?.options\n              .disabledFooter\n              ? \"\"\n              : subtotal[column.key as keyof DataItemGenerator];\n          } else {\n            subtotalRow.getCell(columnIndex + 1).value = \"\";\n          }\n        });\n\n        if (excelSetting?.grandTotalSetting?.colSpan) {\n          worksheet.mergeCells(\n            `A${subtotalRow.number}:${String.fromCharCode(\n              64 + Number(excelSetting?.grandTotalSetting?.colSpan)\n            )}${subtotalRow.number}`\n          );\n        }\n        subtotalRow.eachCell((cell) => {\n          cell.fill = {\n            type: \"pattern\",\n            pattern: \"solid\",\n            fgColor: { argb: excelSetting?.bgColor || \"#E8E5E5\" }, // Warna hijau yang diinginkan\n            bgColor: { argb: excelSetting?.bgColor || \"#E8E5E5\" },\n          };\n          cell.font = {\n            color: { argb: excelSetting?.txtColor },\n            bold: true,\n          };\n        });\n      }\n    } else {\n      const flatColumns = getFlattenColumns(columns);\n\n      const rowData = flatColumns.map((column) => {\n        if (\n          column?.options?.format === \"IMAGE\" &&\n          item[column.key as keyof DataItemGenerator]\n        ) {\n          return {\n            value: \"\", // Kosongkan value untuk cell gambar\n            alignment: { horizontal: \"center\", vertical: \"middle\" },\n            isImage: true,\n            imageSrc: item[column.key as keyof DataItemGenerator], // base64 sudah didukung oleh fetchImageAsBuffer\n          };\n        }\n        let value =\n          column?.options?.format === \"DATETIME\"\n            ? convertDateTime(item[column.key as keyof DataItemGenerator])\n            : column?.options?.format === \"DATE\"\n            ? convertDateTime(item[column.key as keyof DataItemGenerator])\n            : item[column.key as keyof DataItemGenerator];\n\n        // Apply formatter if exists\n        if (column.formatter) {\n          value = column.formatter(value, item);\n        }\n\n        const alignment = {\n          horizontal: column?.options?.halign\n            ? column?.options?.halign\n            : column?.options?.format === \"RP\" ||\n              column?.options?.format === \"GR\" ||\n              column?.options?.format === \"NUMBER\"\n            ? \"right\"\n            : \"left\",\n        };\n        const columnKey = column.key as keyof DataItemGenerator;\n\n        // Hitung totals menggunakan nilai original (sebelum formatter)\n        const originalValue = item[column.key as keyof DataItemGenerator];\n        totals[columnKey] = (totals[columnKey] || 0) + Number(originalValue);\n\n        return {\n          value,\n          alignment,\n          ...(column?.options?.bgColor && {\n            fgColor: { argb: column.options.bgColor },\n          }),\n          ...(column?.options?.txtColor && {\n            color: { argb: column.options.txtColor },\n          }),\n          numFmt:\n            column?.options?.format === \"RP\"\n              ? \"#,##0\"\n              : column?.options?.format === \"GR\"\n              ? \"#,##0.000\"\n              : undefined,\n        };\n      });\n\n      // BUG: rowData.map(async (cellData) => cellData.value) menghasilkan array Promise, bukan array value!\n      // Seharusnya: rowData.map(cellData => cellData.value)\n      const row = worksheet.addRow(rowData.map((cellData) => cellData.value));\n\n      rowData.forEach((cellData, index) => {\n        const cell = row.getCell(index + 1);\n        // Only assign allowed values for horizontal and vertical alignment\n        const allowedHorizontal: Array<\n          | \"center\"\n          | \"right\"\n          | \"left\"\n          | \"fill\"\n          | \"justify\"\n          | \"centerContinuous\"\n          | \"distributed\"\n        > = [\n          \"center\",\n          \"right\",\n          \"left\",\n          \"fill\",\n          \"justify\",\n          \"centerContinuous\",\n          \"distributed\",\n        ];\n        const allowedVertical: Array<\n          \"top\" | \"middle\" | \"bottom\" | \"distributed\" | \"justify\"\n        > = [\"top\", \"middle\", \"bottom\", \"distributed\", \"justify\"];\n\n        let horizontal: (typeof allowedHorizontal)[number] | undefined =\n          undefined;\n        let vertical: (typeof allowedVertical)[number] | undefined = undefined;\n\n        if (\n          cellData.alignment &&\n          typeof cellData.alignment.horizontal === \"string\" &&\n          allowedHorizontal.includes(cellData.alignment.horizontal as any)\n        ) {\n          horizontal = cellData.alignment\n            .horizontal as (typeof allowedHorizontal)[number];\n        }\n        if (\n          cellData.alignment &&\n          \"vertical\" in cellData.alignment &&\n          typeof (cellData.alignment as any).vertical === \"string\" &&\n          allowedVertical.includes((cellData.alignment as any).vertical)\n        ) {\n          vertical = (cellData.alignment as any)\n            .vertical as (typeof allowedVertical)[number];\n        }\n\n        cell.alignment = {\n          ...(horizontal ? { horizontal } : {}),\n          ...(vertical ? { vertical } : {}),\n        };\n\n        if (\n          !cellData.isImage &&\n          \"numFmt\" in cellData &&\n          cellData.numFmt &&\n          typeof cellData.value === \"number\" &&\n          !isNaN(cellData.value)\n        ) {\n          // Ensure the cell value is a number before setting numFmt\n          cell.value = Number(cellData.value);\n          cell.numFmt = cellData.numFmt;\n        }\n\n        if (!cellData.isImage && \"fgColor\" in cellData && cellData.fgColor) {\n          cell.fill = {\n            type: \"pattern\",\n            pattern: \"solid\",\n            fgColor: cellData.fgColor,\n          };\n        }\n        if (!cellData.isImage && \"color\" in cellData && cellData.color) {\n          cell.font = {\n            color: cellData.color,\n          };\n        }\n      });\n\n      // Add images after all cell formatting is complete\n      await addImagesToRow(workbook, worksheet, row, rowData);\n    }\n  });\n\n  const grandTotalRow = worksheet.addRow(columns.map(() => null)); // Create a row with null values\n\n  const flatColumnsTott = getFlattenColumns(columns);\n\n  if (!footerSetting?.grandTotal?.disableGrandTotal) {\n    flatColumnsTott.forEach((column, columnIndex) => {\n      if (\n        column?.options?.format === \"RP\" ||\n        column?.options?.format === \"GR\" ||\n        column?.options?.format === \"NUMBER\"\n      ) {\n        const startRow = 4; // Adjust this based on the starting row for your data\n        const endRow = data.length + startRow - 1;\n        const totalFormula = `SUM(${String.fromCharCode(\n          65 + columnIndex\n        )}${startRow}:${String.fromCharCode(65 + columnIndex)}${endRow})`;\n        const grandTotalCell = grandTotalRow.getCell(columnIndex + 1);\n        // content: ,\n        const GrandTotal = footerSetting?.grandTotal?.enableCount\n          ? grouping.length > 0\n            ? \" : \" +\n              data.map((list) => list.detail.length).reduce((a, b) => a + b, 0)\n            : \" : \" + data.length\n          : \"\";\n\n        const caption = footerSetting?.grandTotal?.captionItem\n          ? footerSetting?.grandTotal?.captionItem\n          : \"\";\n\n        const footerGrandtotal = `${\n          footerSetting?.grandTotal?.caption || \"GRAND TOTAL\"\n        } ${GrandTotal} ${caption}`;\n        grandTotalRow.getCell(1).value = footerGrandtotal;\n        grandTotalRow.getCell(1).alignment = { horizontal: \"center\" };\n\n        (grandTotalCell as any).numFmt =\n          column?.options?.format === \"GR\" ? \"#,##0.000\" : \"#,##0\";\n        grandTotalCell.value = { formula: totalFormula };\n        grandTotalRow.getCell(columnIndex + 1).value = column?.options\n          .disabledFooter\n          ? \"\"\n          : totals[column.key as keyof DataItemGenerator];\n      } else {\n        grandTotalRow.getCell(columnIndex + 1).value = \"\";\n      }\n    });\n\n    if (excelSetting?.grandTotalSetting?.colSpan) {\n      worksheet.mergeCells(\n        `A${grandTotalRow.number}:${String.fromCharCode(\n          64 + Number(excelSetting?.grandTotalSetting?.colSpan)\n        )}${grandTotalRow.number}`\n      );\n    }\n    grandTotalRow.eachCell((cell) => {\n      cell.fill = {\n        type: \"pattern\",\n        pattern: \"solid\",\n        fgColor: { argb: excelSetting?.bgColor || \"#E8E5E5\" }, // Warna hijau yang diinginkan\n        bgColor: { argb: excelSetting?.bgColor || \"#E8E5E5\" },\n      };\n      cell.font = {\n        color: { argb: excelSetting?.txtColor },\n        bold: true,\n      };\n    });\n  }\n\n  if (excelSetting?.customFooter) {\n    excelSetting.customFooter(worksheet, lastUsedColumnIndex);\n  }\n\n  const buffer = await workbook.xlsx.writeBuffer();\n\n  if (excelSetting?.returnBuffer) {\n    excelSetting.returnBuffer(buffer);\n  }\n\n  const blob = new Blob([buffer], {\n    type: \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\",\n  });\n  const link = document.createElement(\"a\");\n  link.href = URL.createObjectURL(blob);\n  link.download = `${excelSetting?.titleExcel || title}.xlsx`;\n  document.body.appendChild(link);\n  link.click();\n  document.body.removeChild(link);\n};\nexport default ExportExcel;\n","import {\n  ColumnGenarator,\n  DataItemGenerator,\n  GenaratorExport,\n} from \"./interface\";\nimport {\n  convertArgbToRgb,\n  convertDateTime,\n  countColumns,\n  formatingTitle,\n  getFlattenColumns,\n} from \"./helpers\";\nimport jsPDF from \"jspdf\";\nimport autoTable from \"jspdf-autotable\";\n\nconst ExportPDF = <T>({\n  columns,\n  data,\n  grouping,\n  pdfSetting,\n  date,\n  title,\n  footerSetting,\n  groupingSetting,\n}: GenaratorExport<T>): string | void => {\n  const doc: jsPDF = new jsPDF(pdfSetting?.orientation, pdfSetting?.unit, [\n    pdfSetting?.width || 297,\n    pdfSetting?.height || 210,\n  ]);\n  let tableRows: any[] = [];\n  let finalY = date ? 30 : 20;\n  columns = columns.filter((item) => !item.options?.disabledColumn);\n\n  doc.setFontSize(10);\n  const widthPortrait = doc.internal.pageSize.getWidth();\n\n  const headerLeft = doc.splitTextToSize(pdfSetting?.textHeaderLeft || \"\", 110);\n  doc.text(headerLeft, 15, 18);\n\n  //Text Kanan\n  doc.text(`${title || pdfSetting?.titlePdf}`, widthPortrait - 15, 18, {\n    align: \"right\",\n  });\n\n  if (date) {\n    doc.text(\n      `${date.caption ? date.caption : \"TANGGAL \"} : ${date?.start_date} ${\n        date?.end_date ? `s/d ${date?.end_date}` : \"\"\n      }`,\n      widthPortrait - 15,\n      22,\n      { align: \"right\" }\n    );\n  }\n\n  if (typeof pdfSetting?.customHeader === \"function\") {\n    pdfSetting.customHeader(doc, finalY, autoTable);\n  }\n  doc.setProperties({\n    title: title || pdfSetting?.titlePdf,\n  });\n\n  if (pdfSetting?.startY) {\n    // console.log(pdfSetting.finalY);\n    finalY = pdfSetting.startY;\n  }\n\n  // Header Tabel\n  const headerRow1: any[] = [];\n  const headerRow2: any[] = [];\n  const hasChild = columns.some((col) => col.child && col.child.length > 0);\n  columns.forEach((column) => {\n    const baseStyle = {\n      textColor: `#${convertArgbToRgb(pdfSetting?.txtColor || \"000\")}`,\n      fillColor: `#${convertArgbToRgb(pdfSetting?.bgColor || \"E8E5E5\")}`,\n      // maxWidth: column?.options?.width || 0,\n      ...(column?.options?.width && {\n        cellWidth: column?.options?.width,\n      }),\n      fontStyle: \"bold\",\n      ...(column?.options?.valign ? { valign: column.options.valign } : {}),\n      halign:\n        column?.options?.halign ??\n        ([\"RP\", \"GR\", \"NUMBER\"].includes(column?.options?.format || \"\")\n          ? \"right\"\n          : \"left\"),\n    };\n\n    if (hasChild) {\n      if (column.child && column.child.length > 0) {\n        // Parent di headerRow1\n        headerRow1.push({\n          content: column.label,\n          colSpan: column.child.length,\n          styles: baseStyle,\n        });\n\n        // Children di headerRow2\n        column.child.forEach((childCol) => {\n          headerRow2.push({\n            content: childCol.label,\n            key: childCol.key,\n            options: childCol.options,\n            styles: {\n              ...baseStyle,\n              halign:\n                childCol?.options?.halign ??\n                ([\"RP\", \"GR\", \"NUMBER\"].includes(\n                  childCol?.options?.format || \"\"\n                )\n                  ? \"right\"\n                  : \"left\"),\n            },\n          });\n        });\n      } else {\n        // Tidak ada child, tapi harus isi 2 baris header (rowSpan 2)\n        headerRow1.push({\n          content: column.label,\n          rowSpan: 2,\n          key: column.key,\n          options: column.options,\n          styles: baseStyle,\n        });\n      }\n    } else {\n      // Semua column tidak punya child, cukup 1 headerRow\n      headerRow1.push({\n        content: column.label,\n        key: column.key,\n        options: column.options,\n        styles: baseStyle,\n      });\n    }\n  });\n\n  // Push header ke tabel hanya jika header.column tidak aktif\n  if (!pdfSetting?.header?.column) {\n    tableRows.push(headerRow1);\n    if (hasChild && headerRow2.length > 0) {\n      tableRows.push(headerRow2);\n    }\n  }\n\n  // Body Tabel\n  const totals: { [key: string]: number } = {};\n\n  data.forEach((item) => {\n    if (item.detail?.length > 0) {\n      // Tambah row grup (header kelompok)\n\n      if (grouping.length > 0) {\n        const totalColumns = countColumns(columns);\n        const groupContent = grouping\n          .map((column) =>\n            item[column] !== undefined || item[column] !== null\n              ? `${formatingTitle(column)} : ${item[column]}`\n              : \"\"\n          )\n          .filter(Boolean)\n          .join(\"  |  \");\n\n        // Support groupingSetting sebagai function atau object\n        const groupingStyle =\n          typeof groupingSetting === \"function\"\n            ? groupingSetting(item)\n            : groupingSetting || {};\n\n        const groupRow = [\n          {\n            content: groupContent,\n            colSpan: totalColumns,\n            styles: {\n              fontStyle: \"bold\",\n              halign: groupingStyle?.halign || \"left\",\n              textColor: `#${convertArgbToRgb(\n                groupingStyle?.txtColor || \"000\"\n              )}`,\n              fillColor: `#${convertArgbToRgb(\n                groupingStyle?.bgColor || \"FFF\"\n              )}`,\n            },\n          },\n        ];\n\n        tableRows.push(groupRow);\n      }\n\n      const subtotal: { [key: string]: number } = {};\n\n      // FLATTEN COLUMNS untuk looping\n      const flatColumns = getFlattenColumns(columns);\n\n      item.detail.forEach((list2: any) => {\n        const rowData = flatColumns.map((column) => {\n          let value = list2[column.key as keyof DataItemGenerator];\n          const columnKey = column.key as keyof DataItemGenerator;\n\n          // Apply formatter if exists\n          if (column.formatter) {\n            value = column.formatter(value, list2);\n          }\n\n          // Hitung subtotal & total (gunakan nilai original, bukan formatted)\n          const originalValue = list2[column.key as keyof DataItemGenerator];\n          totals[columnKey] =\n            (totals[columnKey] || 0) + Number(originalValue || 0);\n          subtotal[columnKey] =\n            (subtotal[columnKey] || 0) + Number(originalValue || 0);\n          const isImage = column.options?.format === \"IMAGE\";\n\n          return {\n            content: (() => {\n              switch (column?.options?.format) {\n                case \"RP\":\n                  return value !== undefined\n                    ? Number(value || 0).toLocaleString(\"kr-ko\")\n                    : \"\";\n                case \"GR\":\n                  return value !== undefined\n                    ? Number(value || 0).toFixed(3)\n                    : \"\";\n                case \"NUMBER\":\n                  return value !== undefined ? Number(value || 0) : \"\";\n                case \"IMAGE\":\n                  return \"\";\n                case \"DATETIME\":\n                  return value !== undefined\n                    ? convertDateTime(value || new Date(), true)\n                    : \"\";\n                case \"DATE\":\n                  return value !== undefined\n                    ? convertDateTime(value || new Date())\n                    : \"\";\n                default:\n                  return value !== undefined ? value.toString() : \"\";\n              }\n            })(),\n            foto: isImage ? value : null,\n            styles: {\n              textColor: column?.options?.txtColor\n                ? `#${convertArgbToRgb(column?.options?.txtColor)}`\n                : \"#000\",\n              fillColor: column?.options?.bgColor\n                ? `#${convertArgbToRgb(column?.options?.bgColor)}`\n                : undefined,\n              halign: column?.options?.halign\n                ? column?.options?.halign\n                : column?.options?.format === \"RP\" ||\n                  column?.options?.format === \"GR\" ||\n                  column?.options?.format === \"NUMBER\"\n                ? \"right\"\n                : typeof value === \"number\"\n                ? \"right\"\n                : \"left\",\n            },\n          };\n        });\n\n        tableRows.push(rowData);\n      });\n\n      if (!footerSetting?.subTotal?.disableSubtotal) {\n        // Footer Subtotal\n        const footersubtotal: any = [];\n        flatColumns.forEach((column) => {\n          const total = subtotal[column.key as keyof DataItemGenerator];\n          if (\n            column?.options?.format === \"RP\" ||\n            column?.options?.format === \"GR\" ||\n            column?.options?.format === \"NUMBER\"\n          ) {\n            footersubtotal.push({\n              content: column?.options?.disabledFooter\n                ? \"\"\n                : (() => {\n                    switch (column?.options?.format) {\n                      case \"RP\":\n                        return total.toLocaleString(\"kr-ko\");\n                      case \"GR\":\n                        return total.toFixed(3);\n                      case \"NUMBER\":\n                        return total;\n                      default:\n                        return total.toString();\n                    }\n                  })(),\n              styles: {\n                halign: column?.options?.halign || \"right\",\n                textColor: `#${convertArgbToRgb(\n                  pdfSetting?.txtColor || \"000\"\n                )}`,\n                fillColor: `#${convertArgbToRgb(\n                  pdfSetting?.bgColor || \"E8E5E5\"\n                )}`,\n                fontStyle: \"bold\",\n              },\n            });\n          } else {\n            footersubtotal.push({\n              content: \"\",\n              styles: {\n                textColor: `#${convertArgbToRgb(\n                  pdfSetting?.txtColor || \"000\"\n                )}`,\n                fillColor: `#${convertArgbToRgb(\n                  pdfSetting?.bgColor || \"E8E5E5\"\n                )}`,\n                fontStyle: \"bold\",\n              },\n            });\n          }\n        });\n\n        const colSpan = pdfSetting?.grandTotalSetting?.colSpan\n          ? Number(pdfSetting?.grandTotalSetting?.colSpan || 0) + 1\n          : 0;\n\n        const subtotalCount = footerSetting?.subTotal?.enableCount\n          ? grouping.length > 0\n            ? \" : \" + item.detail.length\n            : \"\"\n          : \"\";\n\n        const captionSub = footerSetting?.subTotal?.captionItem\n          ? footerSetting?.subTotal?.captionItem\n          : \"\";\n\n        footersubtotal[0] = {\n          content: `${\n            footerSetting?.subTotal?.caption || \"SUB TOTAL\"\n          }${subtotalCount} ${captionSub}`,\n          colSpan,\n          styles: {\n            textColor: `#${convertArgbToRgb(pdfSetting?.txtColor || \"000\")}`,\n            fillColor: `#${convertArgbToRgb(pdfSetting?.bgColor || \"E8E5E5\")}`,\n            fontStyle: \"bold\",\n            halign: \"center\",\n          },\n        };\n\n        if (pdfSetting?.grandTotalSetting?.colSpan) {\n          footersubtotal.splice(1, pdfSetting?.grandTotalSetting?.colSpan);\n        }\n\n        tableRows.push(footersubtotal);\n      }\n    } else {\n      // Helper untuk mengambil data cell dari item dan column\n      const getCellData = (column: ColumnGenarator<any>, item: any) => {\n        let value = item[column.key as keyof DataItemGenerator];\n        const columnKey = column.key as keyof DataItemGenerator;\n\n        // Apply formatter if exists\n        if (column.formatter) {\n          value = column.formatter(value, item);\n        }\n\n        // Hitung total jika tidak disabled (gunakan nilai original, bukan formatted)\n        if (!column.options?.disabledFooter) {\n          const originalValue = item[column.key as keyof DataItemGenerator];\n          totals[columnKey] =\n            (totals[columnKey] || 0) + Number(originalValue || 0);\n        }\n\n        // Tentukan isi cell\n        const content = (() => {\n          switch (column?.options?.format) {\n            case \"RP\":\n              return value !== undefined\n                ? Number(value || 0).toLocaleString(\"kr-ko\")\n                : \"\";\n            case \"GR\":\n              return value !== undefined ? Number(value || 0).toFixed(3) : \"\";\n            case \"NUMBER\":\n              return value !== undefined ? Number(value || 0) : \"\";\n            case \"IMAGE\":\n              return \"\";\n            case \"DATETIME\":\n              return value !== undefined\n                ? convertDateTime(value || new Date(), true)\n                : \"\";\n            case \"DATE\":\n              return value !== undefined\n                ? convertDateTime(value || new Date())\n                : \"\";\n            default:\n              return value !== undefined ? value?.toString() : \"\";\n          }\n        })();\n\n        // Style cell\n        const halign = column?.options?.halign\n          ? column?.options?.halign\n          : column?.options?.format === \"RP\" ||\n            column?.options?.format === \"GR\" ||\n            column?.options?.format === \"NUMBER\"\n          ? \"right\"\n          : typeof value === \"number\"\n          ? \"right\"\n          : \"left\";\n\n        const isImage = column.options?.format === \"IMAGE\";\n\n        return {\n          options: column?.options,\n          content,\n          foto: isImage ? value : null,\n          styles: {\n            halign,\n            textColor: column?.options?.txtColor\n              ? `#${convertArgbToRgb(column?.options?.txtColor)}`\n              : \"#000\",\n            fillColor: column?.options?.bgColor\n              ? `#${convertArgbToRgb(column?.options?.bgColor)}`\n              : undefined,\n          },\n        };\n      };\n\n      // Helper rekursif untuk flatten column dengan child\n\n      // Dapatkan semua kolom flatten dari struktur kolom dengan child\n      const flatColumns = getFlattenColumns(columns);\n\n      // Lalu generate rowData\n      const rowData = flatColumns.map((column) => getCellData(column, item));\n\n      // Tambahkan ke baris tabel\n      tableRows.push(rowData);\n    }\n  });\n\n  const flatColumns = getFlattenColumns(columns);\n  if (!footerSetting?.grandTotal?.disableGrandTotal) {\n    const grandTotal: any[] = [];\n\n    flatColumns.forEach((column) => {\n      const total = totals[column.key as keyof DataItemGenerator];\n\n      const isNumericFormat = [\"RP\", \"GR\", \"NUMBER\"].includes(\n        column?.options?.format || \"\"\n      );\n\n      const content = column?.options?.disabledFooter\n        ? \"\"\n        : (() => {\n            if (!isNumericFormat) return \"\";\n            switch (column.options?.format) {\n              case \"RP\":\n                return Number(total || 0).toLocaleString(\"kr-KO\");\n              case \"GR\":\n                return Number(total || 0).toFixed(3);\n              case \"NUMBER\":\n                return Number(total || 0);\n              default:\n                return (total || 0).toString();\n            }\n          })();\n\n      grandTotal.push({\n        options: column?.options,\n        content,\n        styles: {\n          halign: column?.options?.halign\n            ? column.options.halign\n            : isNumericFormat\n            ? \"right\"\n            : \"left\",\n          textColor: `#${convertArgbToRgb(pdfSetting?.txtColor || \"000\")}`,\n          fillColor: `#${convertArgbToRgb(pdfSetting?.bgColor || \"E8E5E5\")}`,\n          fontStyle: \"bold\",\n        },\n      });\n    });\n    // Tangani caption dan colSpan untuk GRAND TOTAL\n    const rawColSpan = Number(pdfSetting?.grandTotalSetting?.colSpan || 0);\n    const colSpan = Math.min(rawColSpan + 1, flatColumns.length); // batasi agar tidak lebih dari kolom yang tersedia\n\n    const totalItemCount = footerSetting?.grandTotal?.enableCount\n      ? grouping.length > 0\n        ? data.reduce((sum, group) => sum + group.detail.length, 0)\n        : data.length\n      : 0;\n\n    const caption = footerSetting?.grandTotal?.captionItem || \"\";\n    const grandTotalLabel =\n      `${footerSetting?.grandTotal?.caption || \"GRAND TOTAL\"}` +\n      (totalItemCount ? ` : ${totalItemCount}` : \"\") +\n      (caption ? ` ${caption}` : \"\");\n\n    // Ubah cell pertama dengan content Grand Total + colSpan\n    grandTotal[0] = {\n      content: grandTotalLabel,\n      colSpan,\n      styles: {\n        textColor: `#${convertArgbToRgb(pdfSetting?.txtColor || \"000\")}`,\n        fillColor: `#${convertArgbToRgb(pdfSetting?.bgColor || \"E8E5E5\")}`,\n        fontStyle: \"bold\",\n        halign: \"center\",\n      },\n    };\n\n    // Hapus kolom setelah grandTotal[0] sebanyak colSpan - 1 agar panjang array tetap flatColumns.length\n    grandTotal.splice(1, colSpan - 1);\n\n    // Pastikan panjang array tetap sama dengan flatColumns.length\n    while (grandTotal.length < flatColumns.length) {\n      grandTotal.push({\n        content: \"\",\n        styles: {\n          textColor: `#${convertArgbToRgb(pdfSetting?.txtColor || \"000\")}`,\n          fillColor: `#${convertArgbToRgb(pdfSetting?.bgColor || \"E8E5E5\")}`,\n          fontStyle: \"bold\",\n        },\n      });\n    }\n\n    // Push baris GRAND TOTAL ke table\n    tableRows.push(grandTotal);\n  }\n\n  if (typeof pdfSetting?.addRow === \"function\") {\n    pdfSetting?.addRow(tableRows);\n  }\n\n  if (!pdfSetting?.disablePrintDate) {\n    const totalColumns = countColumns(columns);\n\n    tableRows.push([\n      {\n        content: `Print Date : ${convertDateTime(`${new Date()}`)}`,\n        colSpan: totalColumns,\n        styles: {\n          textColor: `#${convertArgbToRgb(pdfSetting?.txtColor || \"000\")}`,\n          fillColor: `#${convertArgbToRgb(pdfSetting?.bgColor || \"E8E5E5\")}`,\n          fontStyle: \"italic\",\n        },\n      },\n    ]);\n  }\n\n  // Prepare head array for autoTable\n  const tableHead: any[] = [];\n  if (pdfSetting?.header?.column) {\n    // Jika header.column aktif, masukkan header ke head (muncul di setiap halaman)\n    tableHead.push(headerRow1);\n    if (hasChild && headerRow2.length > 0) {\n      tableHead.push(headerRow2);\n    }\n  }\n\n  autoTable(doc, {\n    head: tableHead,\n    body: tableRows,\n    startY: finalY,\n    theme: pdfSetting?.theme || \"plain\",\n    rowPageBreak: \"avoid\",\n    margin: { top: pdfSetting?.header?.information ? 30 : 10 },\n    bodyStyles: { fontSize: pdfSetting?.fontSIze || 8 },\n    headStyles: {\n      fontSize: pdfSetting?.fontSIze || 8,\n      textColor: `#${convertArgbToRgb(pdfSetting?.txtColor || \"000\")}`,\n      fillColor: `#${convertArgbToRgb(pdfSetting?.bgColor || \"E8E5E5\")}`,\n    },\n    tableLineColor: [255, 255, 255],\n    didParseCell: function (data) {\n      const colIndex = data.column.index;\n      const col = flatColumns[colIndex];\n      const isImage = col?.options?.format === \"IMAGE\";\n\n      if (isImage && data.cell.raw && (data.cell.raw as any).foto) {\n        data.row.height = 20; // Ganti sesuai ukuran gambar\n        data.cell.styles.valign = \"middle\"; // Ubah ke \"middle\" agar foto di tengah\n        data.cell.styles.halign = \"center\"; // Tambahkan agar foto di tengah secara horizontal\n      }\n    },\n\n    // âœ… Render header di setiap halaman baru jika loopHeader aktif\n    didDrawPage: function (data) {\n      if (pdfSetting?.header?.information && data.pageNumber > 1) {\n        doc.setFontSize(10);\n        const pageWidth = doc.internal.pageSize.getWidth();\n\n        // Header kiri\n        const headerLeft = doc.splitTextToSize(\n          pdfSetting?.textHeaderLeft || \"\",\n          110\n        );\n        doc.text(headerLeft, 15, 18);\n\n        // Header kanan (title)\n        doc.text(`${title || pdfSetting?.titlePdf}`, pageWidth - 15, 18, {\n          align: \"right\",\n        });\n\n        // Tanggal (jika ada)\n        if (date) {\n          doc.text(\n            `${date.caption ? date.caption : \"TANGGAL \"} : ${\n              date?.start_date\n            } ${date?.end_date ? `s/d ${date?.end_date}` : \"\"}`,\n            pageWidth - 15,\n            22,\n            { align: \"right\" }\n          );\n        }\n      }\n    },\n\n    // âœ… Render gambar sesuai posisi dan ukuran\n    didDrawCell: function (data) {\n      const { cell } = data;\n      const raw = cell.raw || {};\n      const value = (raw as any).foto;\n      const colIndex = data.column.index;\n      const col = flatColumns[colIndex];\n\n      if (col?.options?.format === \"IMAGE\" && value) {\n        const imageSize = 15;\n        const x = cell.x + (cell.width - imageSize) / 2;\n        const y = cell.y + (cell.height - imageSize) / 2;\n\n        try {\n          doc.addImage(value, \"JPG\", x, y, imageSize, imageSize);\n        } catch (err) {\n          console.warn(\"âŒ Gagal render gambar:\", err);\n        }\n      }\n    },\n  });\n  tableRows = [];\n  finalY = (doc as any).lastAutoTable.finalY;\n  +3;\n\n  const pages = (doc as any).internal.getNumberOfPages();\n  const pageWidth = doc.internal.pageSize.width;\n  const pageHeight = doc.internal.pageSize.height;\n\n  doc.setFontSize(10);\n\n  for (let j = 1; j < pages + 1; j++) {\n    const horizontalPos = pageWidth / 2;\n    const verticalPos = pageHeight - 10;\n    doc.setPage(j);\n    doc.text(`${j} of ${pages}`, horizontalPos, verticalPos, {\n      align: \"center\",\n    });\n  }\n  if (typeof pdfSetting?.customFooter === \"function\") {\n    pdfSetting.customFooter(doc, finalY, autoTable);\n  }\n\n  if (pdfSetting?.returnDataUri) {\n    const dataUri = doc.output(\"datauristring\");\n    pdfSetting.returnDataUri(dataUri);\n  }\n\n  if (pdfSetting?.openNewTab) {\n    const blob = doc.output(\"bloburl\");\n    window.open(blob);\n  } else {\n    doc.save(`${pdfSetting?.titlePdf || title}.pdf`);\n  }\n};\n\nexport default ExportPDF;\n","interface Load {\n  [key: string]: string | string[] | undefined;\n}\n\ninterface Res {\n  data: Load[];\n  template: string;\n  copy?: boolean;\n}\n\nconst generateNotaSlip = (res: Res): string[] => {\n  const notaGenerated: string[] = [];\n  const jml = res.copy ? 2 : 1;\n  for (let index = 0; index < jml; index++) {\n    const nota: string[] = res.data.map((load: Load) => {\n      let replaceLoop = res.template;\n\n      while (/\\n!!LOOP\\((.+)\\)(\\{\\n(.*\\n)+\\})\\n/gm.exec(replaceLoop)) {\n        replaceLoop = replaceLoop.replace(\n          /\\n!!LOOP\\((.+)\\)(\\{\\n(.*\\n)+\\})\\n/,\n          (_match, p1, p2) => {\n            const loopContent = p2.replace(/^\\{/, \"\").replace(/\\}$/, \"\");\n            const loopArray: string[] | undefined = !Array.isArray(load[p1])\n              ? [load[p1] as string]\n              : (load[p1] as string[]);\n            const detail: string = loopArray.reduce((acc, val) => {\n              return (\n                acc +\n                loopContent.replace(/\\{([a-z0-9_]+)\\}/gm, (c: any) => {\n                  const key = c.replace(/(\\{|\\})/g, \"\");\n                  if (key.match(/nama_barang/)) {\n                    const keyCustomer = key.match(/nama_barang/);\n                    const sliceNamaBarang =\n                      key === \"nama_barang2\"\n                        ? [20, 40]\n                        : key === \"nama_barang3\"\n                        ? [40, 60]\n                        : [0, 20];\n                    return (\n                      (val[keyCustomer] as string)\n                        ?.slice(...sliceNamaBarang)\n                        .trim() || \"\"\n                    );\n                  }\n                  if (key.match(/deskripsi_jual/)) {\n                    const keyDeskripsi = key.match(/deskripsi_jual/);\n                    const sliceDeskripsi =\n                      key === \"deskripsi_jual2\"\n                        ? [20, 40]\n                        : key === \"deskripsi_jual3\"\n                        ? [40, 60]\n                        : [0, 20];\n                    return (\n                      (val[keyDeskripsi] as string)\n                        ?.slice(...sliceDeskripsi)\n                        .trim() || \"\"\n                    );\n                  }\n                  if (key.match(/deskripsi/)) {\n                    const keyCustomer = key.match(/deskripsi/);\n                    const sliceNama =\n                      key === \"deskripsi2\"\n                        ? [20, 40]\n                        : key === \"deskripsi3\"\n                        ? [40, 60]\n                        : [0, 20];\n                    return (\n                      (val[keyCustomer] as string)\n                        ?.slice(...sliceNama)\n                        .trim() || \"\"\n                    );\n                  }\n                  return (val[key] as string) || \"\";\n                })\n              );\n            }, \"\");\n            return detail.replace(/\\n(\\s)+\\n/gm, \"\\n\");\n          }\n        );\n      }\n\n      return replaceLoop\n        .replace(/\\{([a-z0-9_]+)\\}/gm, (c) => {\n          const key = c.replace(/(\\{|\\})/g, \"\");\n\n          if (key.match(/auto_cut/)) {\n            return \"\\n\u001dVA\";\n          }\n          return (load[key] as string) || \"\";\n        })\n        .replace(/\\n(\\s)+\\n/gm, \"\\n\")\n        .replace(/~new_line~/gm, \"\\n\")\n        .replace(/!!LOOP\\(detail\\)/g, \"\")\n        .replace(/[}{]/g, \"\");\n    });\n\n    for (const key in nota) {\n      nota[key] += \"\\n\\n\";\n    }\n\n    notaGenerated.push(...nota);\n  }\n\n  return notaGenerated;\n};\n\nconst ExportToTxt = async (res: any, nama_file: string): Promise<void> => {\n  const notaGenerated = generateNotaSlip(res);\n  const blob = new Blob([notaGenerated?.join(\"\\n\") || \"\"], {\n    type: \"text/plain\"\n  });\n  const downloadLink = document.createElement(\"a\");\n  downloadLink.href = URL.createObjectURL(blob);\n  downloadLink.download = nama_file;\n  document.body.appendChild(downloadLink);\n  downloadLink.click();\n  document.body.removeChild(downloadLink);\n};\n\nexport default ExportToTxt;\n","import ExportExcel from \"./exportExcel\";\nimport ExportPDF from \"./exportPdf\";\nimport ExportToTxt from \"./exportTextFile\";\nimport { validateFileTypes } from \"./helpers\";\nimport { GenaratorExport, ColumnGenarator } from \"./interface\";\n\n/**\n * Ekspor ke PDF atau Excel berdasarkan konfigurasi yang diberikan.\n *\n * @param title - Judul laporan.\n * @param columns - Konfigurasi kolom untuk laporan.\n * @param data - Data yang akan disertakan dalam laporan.\n * @param grouping - Gruping yang akan diterapkan dalam laporan ada head dan detail Example: [\"no_faktur_hutang\"].\n * @param pdfSetting - Opsi untuk config PDF.\n * @param excelSetting - Opsi untuk config Excel.\n * @param txtSetting - Opsi untuk config Txt file.\n * @param date - Rentang tanggal untuk laporan.\n * @param type - Jenis laporan yang akan diekspor (\"PDF\" \"TXT\" atau \"EXCEL\").\n * @param footerSetting - Setting Footer Subtotal atau GranTotal\n */\nexport const ExportData = <T>({\n  columns,\n  data,\n  grouping,\n  date,\n  type,\n  txtSetting,\n  pdfSetting,\n  excelSetting,\n  title,\n  footerSetting,\n  groupingSetting,\n}: GenaratorExport<T>): void => {\n  const databaru = {\n    data: [txtSetting?.dataTxt],\n    template: txtSetting?.templateTxt,\n    copy: txtSetting?.copy,\n  };\n\n  if (data.length === 0) {\n    throw new Error(\"Data is required\");\n  }\n  if (type.length === 0) {\n    throw new Error(\"Type is required\");\n  }\n\n  if (!validateFileTypes(type)) {\n    throw new Error(`Type Export must use [\"EXCEL\", \"PDF\", \"TXT\", \"ALL\"]`);\n  }\n\n  type.forEach((list) => {\n    if (list === \"PDF\") {\n      ExportPDF({\n        pdfSetting,\n        date,\n        data,\n        type,\n        columns,\n        grouping,\n        title,\n        footerSetting,\n        groupingSetting,\n      });\n    } else if (list === \"TXT\") {\n      ExportToTxt(databaru, txtSetting?.titleTxt || \"\");\n    } else if (list === \"EXCEL\") {\n      ExportExcel({\n        date,\n        data,\n        type,\n        columns,\n        grouping,\n        excelSetting,\n        title,\n        footerSetting,\n        groupingSetting,\n      });\n    } else {\n      ExportExcel({\n        date,\n        data,\n        type,\n        columns,\n        grouping,\n        excelSetting,\n        title,\n        groupingSetting,\n      });\n\n      ExportPDF({\n        pdfSetting,\n        date,\n        data,\n        type,\n        columns,\n        grouping,\n        title,\n        groupingSetting,\n      });\n\n      ExportToTxt(databaru, txtSetting?.titleTxt || \"\");\n    }\n  });\n};\n\nexport type { ColumnGenarator };\n"],"mappings":"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","names":["validFileTypes","convertDateTime","tgl","isDateTime","date","jakartaDate","year","month","day","hours","minutes","seconds","validateFileTypes","fileTypes","fileType","validFileTypes","countColumns","columns","count","col","getFlattenColumns","flat","formatingTitle","title","word","addImagesToRow","workbook","worksheet","row","rowData","index","cellData","buffer","extension","base64ToBufferAndExtension","imageId","error","base64","match","base64Data","binaryString","len","bytes","i","convertArgbToRgb","color","cleanColor","ExcelJS","ExportExcel","columns","data","grouping","date","excelSetting","title","footerSetting","groupingSetting","workbook","item","worksheet","lastUsedColumnIndex","countColumns","judul","lastColumnLetter","cell","tanggalRow","additionalText","startY","i","hasChild","col","headerColumn1","headerColumn2","startCol","childCount","childCol","index","halign","valign","colIndex","getFlattenColumns","columnIndex","column","defaultWidth","totals","totalColumns","groupContent","formatingTitle","groupingStyle","groupRow","subtotal","itemDetail","rowData","value","convertDateTime","alignment","columnKey","originalValue","row","cellData","allowedHorizontal","allowedVertical","horizontal","vertical","addImagesToRow","flatColumnsSubTott","subtotalRow","endRow","totalFormula","grandTotalCell","subtotalCount","captionSub","grandTotalRow","flatColumnsTott","GrandTotal","list","a","b","caption","footerGrandtotal","buffer","blob","link","exportExcel_default","jsPDF","autoTable","ExportPDF","columns","data","grouping","pdfSetting","date","title","footerSetting","groupingSetting","doc","tableRows","finalY","item","widthPortrait","headerLeft","headerRow1","headerRow2","hasChild","col","column","baseStyle","convertArgbToRgb","childCol","totals","totalColumns","countColumns","groupContent","formatingTitle","groupingStyle","groupRow","subtotal","flatColumns","getFlattenColumns","list2","rowData","value","columnKey","originalValue","isImage","convertDateTime","footersubtotal","total","colSpan","subtotalCount","captionSub","getCellData","content","halign","grandTotal","isNumericFormat","rawColSpan","totalItemCount","sum","group","caption","grandTotalLabel","tableHead","colIndex","pageWidth","cell","x","y","err","pages","pageHeight","j","horizontalPos","verticalPos","dataUri","blob","exportPdf_default","generateNotaSlip","res","notaGenerated","jml","index","nota","load","replaceLoop","_match","p1","p2","loopContent","acc","val","c","key","keyCustomer","sliceNamaBarang","keyDeskripsi","sliceDeskripsi","sliceNama","ExportToTxt","nama_file","blob","downloadLink","exportTextFile_default","ExportData","columns","data","grouping","date","type","txtSetting","pdfSetting","excelSetting","title","footerSetting","groupingSetting","databaru","validateFileTypes","list","exportPdf_default","exportTextFile_default","exportExcel_default"]}